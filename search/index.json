[{"content":"æˆ‘åœ¨å¤§ä¸€çš„æ—¶å€™å°±åœ¨åšå®¢å›­å’Œ CSDN å†™åšå®¢ï¼Œä¸»è¦å†…å®¹æ˜¯å¹³æ—¶ä¸Šè¯¾å­¦çš„ C è¯­è¨€ç®—æ³•å’Œä¸€äº›ç®€å•çš„å…¥é—¨æ•™ç¨‹ã€‚åæ¥æˆ‘åœæ­¢äº†ä¸€æ®µæ—¶é—´ï¼Œå› ä¸ºæˆ‘æ„è¯†åˆ°è‡ªå·±åœ¨ç”Ÿäº§æ¯«æ— ä»·å€¼çš„åƒåœ¾ã€‚\nå†™ä¸€ç¯‡åˆæ ¼çš„åšå®¢ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ï¼Œå€Ÿæœ¬æ–‡åˆ†äº«ä¸€ä¸‹è‡ªå·±å¤šå¹´å†™åšå®¢çš„ä¸€äº›ç»éªŒã€‚\nå‰æœŸçš„å‡†å¤‡ å‘æ˜æœ‰ä»·å€¼çš„è¯é¢˜ ä»€ä¹ˆæ˜¯æœ‰ä»·å€¼çš„è¯é¢˜ï¼Ÿ\nä¸€ä»¶äº‹çš„ä»·å€¼æœ¬èº«å°±å› äººè€Œå¼‚ï¼Œåœ¨æŠ€æœ¯é¢†åŸŸä»·å€¼çš„äº§ç”Ÿæ˜¯å› ä¸ºæœ‰éœ€æ±‚ï¼Œæ‰€ä»¥ä¸€èˆ¬è€Œè¨€ï¼Œéœ€æ±‚è¶Šå¤§ï¼Œè¶Šæœ‰ä»·å€¼ã€‚ä½†åœ¨æœ‰ä¸€å®šçš„éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œè¶Šæ˜¯å›°éš¾çš„å·¥ä½œè¶Šæœ‰ä»·å€¼ï¼Œå› ä¸ºå›°éš¾çš„å·¥ä½œæœ¬èº«ä¹Ÿæ„å‘³ç€æ›´å°‘çš„äººèƒ½åšï¼Œåœ¨ä¾›éœ€å…³ç³»çš„å½±å“ä¸‹ï¼Œä¼šæ¨é«˜å…¶ä»·å€¼ã€‚\nç®€è€Œè¨€ä¹‹ï¼Œéœ€æ±‚è¶Šå¤§ï¼Œéš¾åº¦è¶Šå¤§ï¼Œè¶Šæœ‰ä»·å€¼ã€‚\nåŒæ—¶ï¼Œæœ‰ä¸€äº›äººå¯èƒ½å¸Œæœ›åšå®¢æ‹¥æœ‰ä¸€å®šç›ˆåˆ©èƒ½åŠ›ï¼Œä¸ºè‡ªå·±è´¡çŒ®ä¸€éƒ¨åˆ†æ”¶å…¥ï¼Œæ¯•ç«Ÿè‡ªå·±èŠ±äº†éå¸¸å¤šçš„æ—¶é—´å»å­¦ä¹ å’Œåˆ†äº«è¿™äº›èµ„æ–™ã€‚\næœ‰æ„æ€çš„æ˜¯ï¼Œåœ¨æŠ€æœ¯é¢†åŸŸï¼Œéœ€æ±‚é‡æœ€å¤§çš„ä¸€èˆ¬æ˜¯å…¥é—¨æ°´å¹³çš„æŠ€æœ¯åšå®¢ã€‚å› ä¸ºæœ‰éå¸¸å¤šçš„äººå­¦ä¹ è®¡ç®—æœºï¼Œä»–ä»¬ä¸­çš„å¤§éƒ¨åˆ†ç”šè‡³å°†æ¥ä¸ä¼šä»äº‹ç›¸å…³çš„å·¥ä½œã€‚å¤§éƒ¨åˆ†æ—¶å€™ï¼Œåšå…¥é—¨æ°´å¹³çš„å†…å®¹ï¼Œä¸ä»…è½»æ¾è€Œä¸”è¿˜èµšé’±ï¼Œè¿™ç§ç°è±¡é€ å°±äº† CSDN è¿™æ ·ç¦»è°±çš„ç½‘ç«™ã€‚\næˆ‘çŸ¥é“å¾ˆå¤šäººéƒ½é„™è§†è¿™äº›å¤§é‡çŒæ°´çš„å…¥é—¨æ°´å¹³åšå®¢ï¼Œæˆ‘ä¹Ÿä¸å–œæ¬¢ï¼Œä½†æ˜¯è‡³å°‘äººå®¶æ˜¯çœŸçš„æ‡‚æµé‡ã€‚\nè¯è¯´å›æ¥ï¼Œæˆ‘ä»¬è®¤ä¸ºï¼Œä¼˜ç§€çš„åšå®¢å¿…ç„¶æ˜¯å…·æœ‰ä¸€å®šåŸåˆ›æ€§çš„ï¼Œæœ€å¥½è¿˜æ˜¯å…·æœ‰ä¸€å®šæ·±åº¦çš„ï¼Œä½†æ˜¯å‡å¦‚ä½ çš„æ°´å¹³çœŸçš„æœ‰é™ï¼Œé‚£ä¹ˆè¿™ä¸¤ç§ç±»å‹çš„åšå®¢ä¹Ÿæ˜¯å¯ä»¥è€ƒè™‘çš„ï¼š\næ€»ç»“å½’çº³åˆ«äººçš„èµ„æ–™ï¼ˆä½†æ˜¯è¦é™„ä¸Šæ‰€æœ‰çš„å‚è€ƒé“¾æ¥ï¼‰ ç¿»è¯‘è‹±è¯­ç¤¾åŒºçš„å†…å®¹ï¼ˆè¦æ³¨æ˜ä¸ºç¿»è¯‘ç±»æ–‡ç« ï¼Œä¸”é™„ä¸ŠåŸæ–‡é“¾æ¥ï¼‰ å»ºç«‹è‡ªå·±çš„çŸ¥è¯†åº“ åšå®¢éš¾äº§çš„ä¸€ä¸ªé‡è¦åŸå› å°±æ˜¯è‚šå­é‡Œæ²¡æœ‰å¢¨æ°´ï¼Œè¿™ä¸ªä¸ä¸€å®šæ˜¯æŒ‡ä½ ä¸æ‡‚è¿™ä¸ªæŠ€æœ¯ï¼Œä¹Ÿå¯èƒ½æ˜¯ä½ æ‡‚è¿™ä¸ªæŠ€æœ¯ï¼Œä½†æ˜¯ç¼ºä¹ç³»ç»Ÿæ€§é˜è¿°çš„èµ„æ–™ã€‚\næˆ‘ä»¬æ¯ä¸€ä¸ªäººæ¯å¤©éƒ½åœ¨ä¸åœæ¥æ”¶å„ç§éå¸¸ç¢ç‰‡åŒ–çš„ä¿¡æ¯ï¼Œå…¶ä¸­çš„ä¸€äº›å¯èƒ½æ˜¯é²œä¸ºäººçŸ¥çš„ä¿¡æ¯ï¼Œå®ƒä»¬å¯èƒ½æ˜¯å…·æœ‰ä¸€å®šä»·å€¼çš„ï¼Œä½†æ˜¯åˆä¸è¶³ä»¥å½¢æˆä¸€ç¯‡å®Œæ•´çš„æ–‡ç« ã€‚è¿™ä¸ªæ—¶å€™æœ€å¥½çš„ç­–ç•¥å°±æ˜¯å­˜å‚¨å®ƒä»¬ï¼Œå½“æœ‰ä¸€å¤©ï¼Œä½ éœ€è¦ä¸ºä½ çš„åšå®¢å‡†å¤‡ç´ æçš„æ—¶å€™ï¼Œä¹Ÿä¸éœ€è¦åˆ°å¤„å›å¿†å’Œå¯»æ‰¾äº†ï¼Œåªéœ€è¦ä»ä½ çš„ä¸ªäººçŸ¥è¯†åº“é‡Œé¢å¤åˆ¶ç²˜è´´å°±å¥½äº†ã€‚\nå¸¸è§çš„çŸ¥è¯†åº“æœ‰æ¯”å¦‚å›½å†…çš„è¯­é›€ï¼Œè¿˜æœ‰å›½å¤–çš„ Notionï¼Œç›¸å¯¹æ¥è¯´ï¼Œæˆ‘ä¸ªäººä½¿ç”¨ Notion æ›´å¤šä¸€äº›ã€‚\nå†™ä½œæŠ€å·§ æ‹¥æœ‰åˆç†çš„æ’ç‰ˆ è¿™å¯èƒ½æ˜¯æˆ‘æœ€æƒ³åæ§½çš„ä¸€ç‚¹ï¼Œå› ä¸ºå¾ˆå¤š CSDN çš„æ–‡ç« ï¼Œç”šè‡³å°±æ˜¯ç”Ÿçš„æ–‡æœ¬ï¼Œå®Œå…¨æ²¡æœ‰æ’ç‰ˆå¯è¨€ï¼Œæœ‰äº›å†…å®¹å…¶å®è¿˜å¯ä»¥çš„ï¼Œå®åœ¨æ˜¯å¯æƒœã€‚\nåœ¨æˆ‘çœ‹æ¥ï¼ŒMarkdownã€LaTex æ˜¯æ¯ä¸€ä¸ªç¨‹åºå‘˜çš„å¿…ä¿®è¯¾ï¼Œè¿™ä¸–ç•Œä¸Šæ²¡æœ‰ä¸å†™åšå®¢çš„ç¨‹åºå‘˜ï¼Œæ¯ä¸€ä¸ªæˆ‘æ›¾ç»çš„åŒå­¦ï¼Œä»–ä»¬éƒ½å†™è¿‡åšå®¢ã€‚\nåœ¨å¿…è¦çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Markdown å¼•æ“çš„ HTML åŠŸèƒ½æ¥ä¸°å¯Œæ–‡ç« çš„æ’ç‰ˆã€‚è¿˜æœ‰ï¼Œä¸è¦å¿˜è®° TOCï¼Œä¸»è¦æ˜¯é’ˆå¯¹è‡ªå»ºç½‘ç«™çš„åŒå­¦ï¼Œå¤§éƒ¨åˆ†åšå®¢ç®¡ç†ç½‘ç«™éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆã€‚\nå­¦ä¼šç¼–å†™æ€»ç»“ æ–°æ‰‹çš„åšå®¢å¾€å¾€éƒ½æ˜¯æ²¡æœ‰æ€»ç»“çš„ï¼Œæ€»ç»“æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ä¹ æƒ¯ï¼Œä¸ä»…ä»…æ˜¯åœ¨å†™åšå®¢çš„æ—¶å€™ï¼Œå¹³æ—¶ä½ åœ¨å’Œå…¶ä»–äººäº¤æµå·¥ä½œçš„æ—¶å€™ä¹Ÿå¯ä»¥å°è¯•ä½¿ç”¨æ€»ç»“ï¼Œå¯ä»¥æ›´å¥½åœ°ä¼ è¾¾ä½ éœ€è¦è¡¨è¾¾çš„æ„æ€ã€‚\næ€»ç»“å¾€å¾€æé†’åˆ«äººï¼Œæ¥ä¸‹æ¥çš„äº‹æƒ…æ˜¯é‡ç‚¹ã€‚è¿™æ ·åˆ«äººå°±ä¼šç”¨æ›´é«˜çš„æ³¨æ„åŠ›å»æ¥æ”¶ä¿¡æ¯ã€‚\næœ‰ä¸€ä¸ªè¯¯åŒºæ˜¯ï¼Œå¾ˆå¤šäººè®¤ä¸ºæ€»ç»“åªæ˜¯å¤åˆ¶ç²˜è´´æ–‡ç« ä¸­çš„å…³é”®ä¿¡æ¯ï¼Œä½†å®é™…ä¸Šï¼Œæ€»ç»“ä¹Ÿå¯ä»¥å¸®åŠ©ä½ åœ¨å®Œæˆæœ€ç»ˆçš„åšå®¢å‰å¯¹æ–‡ç« è„‰ç»œåšä¸€ä¸ªæ¢³ç†ï¼Œå¸®åŠ©ä½ æ€è€ƒæ–‡ç« çš„ç»“æ„æ˜¯å¦åˆç†ï¼Œæœ‰æ—¶å€™ï¼Œæ€»ç»“å¯èƒ½è¿˜ä¼šä¿ƒä½¿ä½ å›å»é‡æ–°è°ƒæ•´æ–‡ç« çš„ç»“æ„ï¼Œä»¥å¢å¼ºæ–‡ç« çš„å¯è¯»æ€§ã€‚\næ ‡æ³¨å‚è€ƒèµ„æ–™ æ–°æ‰‹çš„åšå®¢å¾€å¾€æ˜¯æ²¡æœ‰å‚è€ƒèµ„æ–™çš„ï¼Œä½†æ˜¯è¿™å¯èƒ½æ˜¯ä½ äººç”Ÿä¸­éå¸¸é‡è¦çš„ä¸€è¯¾ï¼š\nä½ å¾—è¦å­¦ä¼šå°Šé‡åˆ«äººçš„æˆæœï¼Œè¿™æ ·åˆ«äººæ‰ä¼šå°Šé‡ä½ çš„æˆæœã€‚\næœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯å¦éœ€è¦ä¸¥æ ¼æŒ‰ç…§è®ºæ–‡çš„å½¢å¼å†™åšå®¢ï¼Ÿ\nå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœä½ å¯¹è‡ªå·±çš„è¦æ±‚è¶³å¤Ÿé«˜ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä¸¥æ ¼ä½¿ç”¨è®ºæ–‡æ ¼å¼å»ç¼–å†™åšå®¢ï¼Œä½†æ˜¯å¾ˆå¤šåšå®¢å¹¶ä¸æ˜¯ä»€ä¹ˆéå¸¸æ­£å¼çš„å†…å®¹ï¼Œå°±åƒè¿™ç¯‡æ–‡ç« ï¼Œå¯èƒ½åªæ˜¯æˆ‘ä¸´æ—¶èµ·æ„ï¼Œå†™ä¸‹æ¥çš„ä¸€äº›æƒ³æ³•ã€‚æ‰€ä»¥æˆ‘çš„ä¸»å¼ æ˜¯ï¼Œä½ èƒ½çœŸå®åœ°æ ‡æ³¨å‡ºä½ æ‰€å¼•ç”¨çš„èµ„æ–™ï¼Œå°±å·²ç»èµ¢è¿‡å¤§éƒ¨åˆ†çš„äººäº†ã€‚\nåšå®¢éƒ¨ç½² ç½‘ç«™æ‰˜ç®¡ çŸ¥ä¹ã€æ˜é‡‘ã€CSDNã€åšå®¢å›­ã€ç®€ä¹¦\nGithub Pages å®Œå…¨å…è´¹çš„æ–¹æ¡ˆï¼Œæ²¡æœ‰ä»»ä½•å¼€é”€ã€‚æ­é… Hexo æˆ–è€… Hugo å®ç°é™æ€åšå®¢éƒ¨ç½²ã€‚\nå…³äºåšå®¢éƒ¨ç½²æ¶æ„ä¹Ÿæœ‰ä¸€äº›å»ºè®®ã€‚\nå­˜å‚¨ä»“åº“å’Œéƒ¨ç½²ä»“åº“åˆ†ç¦» ä¸»è¦ç›®çš„æ˜¯éšè—åšå®¢çš„å­˜å‚¨ä»“åº“ï¼Œå› ä¸ºé‡Œé¢å¯èƒ½ä¼šæ¶‰åŠåˆ°ä¸€äº›ç§å¯†çš„å†…å®¹ï¼Œæ¯”å¦‚ï¼Œä½ è¯„è®ºç³»ç»Ÿçš„å¯†é’¥ã€‚åˆ†ç¦»ä¹‹åæŠŠå­˜å‚¨ä»“åº“è®¾ç½®ä¸ºç§å¯†ï¼Œä½†æ˜¯éƒ¨ç½²ä»“åº“å¿…é¡»è®¾ç½®ä¸ºå…¬å¼€ï¼Œè¿™æ ·æ‰å¯ä»¥æŒ‚è½½åˆ° Github Pages ä¸Šã€‚\nè‡ªåŠ¨åŒ–éƒ¨ç½² ä¸»è¦ç›®çš„æ˜¯ç®€åŒ–éƒ¨ç½²æµç¨‹ï¼Œå½“ä½ å¾€å­˜å‚¨ä»“åº“æäº¤ Markdown æ–‡ä»¶çš„æ›´æ–°ä¹‹åï¼ŒGithub Actions ä¼šè‡ªåŠ¨è§¦å‘éƒ¨ç½²ï¼Œå¸®ä½ æäº¤ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬åˆ°éƒ¨ç½²ä»“åº“ä¸Šé¢ã€‚\nä»¥æˆ‘è‡ªå·±ä¸¾ä¾‹ï¼Œæˆ‘ä½¿ç”¨ Hugo Theme Stack Starter Template å»å¿«é€Ÿåˆ›å»º Hugo é¡¹ç›®ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªç°æˆçš„éƒ¨ç½²è„šæœ¬ã€‚ç„¶åæˆ‘å¯¹å…¶ä¸­çš„ deploy.yml åšäº†ä¸€äº›ä¿®æ”¹ï¼Œè¯¦ç»†è§„åˆ™è§ GitHub Pages Deploy Action çš„ä»‹ç»ï¼š\n1 2 3 4 5 6 7 8 9 10 ... - name: Deploy ğŸš€ uses: JamesIves/github-pages-deploy-action@v4 with: repository-name: nonlinearthink/nonlinearthink.github.io branch: master ssh-key: ${{ secrets.DEPLOY_KEY }} folder: public clean: true single-commit: true å…¶ä¸­çš„ ${{ secrets.DEPLOY_KEY }} å¯èƒ½ä¼šè®©ä½ æ„Ÿåˆ°å›°æƒ‘ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼ŒGithub Actions éœ€è¦æƒé™æ‰èƒ½æäº¤ä»£ç åˆ°éƒ¨ç½²ä»“åº“ï¼Œæ‰€ä»¥ä½ éœ€è¦è®¾ç½®ä¸€ä¸ªéƒ¨ç½²å¯†é’¥ã€‚\nGithub Deploy Keys \u0026amp; Secrets è¿™ä¸€ç‚¹å¯ä»¥å‚è€ƒ Github å®˜æ–¹æ–‡æ¡£ï¼šUsing secrets in GitHub Actions\nå…ˆåœ¨è‡ªå·±çš„éƒ¨ç½²ä»“åº“é‡Œé¢åˆ›å»ºä¸€ä¸ª DEPLOY_KEYï¼Œè®°å¾—å‹¾é€‰å†™å…¥æƒé™ã€‚\nç„¶ååœ¨è‡ªå·±çš„å­˜å‚¨ä»“åº“é‡Œé¢åˆ›å»ºä¸€ä¸ª secretsï¼Œå…¶å€¼å°±æ˜¯ä¸Šé¢çš„ DEPLOY_KEY çš„å€¼ï¼š\nECS å‡å¦‚è¦åœ¨è‡ªå·±è´­ä¹°çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²åšå®¢ï¼Œä½¿ç”¨ Hexo å’Œ Hugo ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯ä½ éƒ½æœ‰è‡ªå·±çš„æœåŠ¡å™¨äº†ï¼Œä¸å¦‚ä½¿ç”¨åŠ¨æ€åšå®¢æ¡†æ¶ç®—äº†ï¼Œæ¯”å¦‚ Haloã€‚åƒ Halo è¿™æ ·çš„åŠ¨æ€åšå®¢æ¡†æ¶ï¼Œç›¸å½“äºæœ‰è‡ªå·±çš„ Serverï¼Œæœ‰è‡ªå·±çš„æ•°æ®åº“ï¼Œè¿˜æœ‰ç®¡ç†å‘˜åå°ï¼Œå¯ä»¥ç®€åŒ–åšå®¢çš„ç®¡ç†ã€‚\nè‡ªå»ºæœåŠ¡å™¨å¯èƒ½æ¶‰åŠåˆ°å¤‡æ¡ˆï¼Œè¯·è°¨æ…é…ç½®è¯„è®ºç³»ç»Ÿï¼Œä¼šå¤§å¤§å¢åŠ å¤‡æ¡ˆçš„éš¾åº¦\næ€»ç»“ ç¼–å†™ä¸€ç¯‡æŠ€æœ¯åšå®¢çš„æ³¨æ„äº‹é¡¹ï¼š\nè¦æ‡‚å¾—å¯»æ‰¾æœ‰ä»·å€¼çš„è¯é¢˜ï¼Œå¹¶æ³¨é‡å»ºç«‹ä¸ªäººçš„çŸ¥è¯†åº“ä»¥ç§¯ç´¯ç´ æã€‚ ç¼–å†™æ–‡ç« è¦æœ‰æ¸…æ™°çš„é€»è¾‘å’Œæ’ç‰ˆï¼Œè®°å¾—å†™æ€»ç»“å’Œå‚è€ƒèµ„æ–™ã€‚ é€‰æ‹©åˆé€‚çš„åšå®¢éƒ¨ç½²æ–¹æ¡ˆã€‚ ","date":"2024-03-01T09:59:17+08:00","permalink":"https://nonlinearthink.github.io/p/%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E6%8A%80%E6%9C%AF%E5%8D%9A%E5%AE%A2/","title":"å¦‚ä½•ç¼–å†™æŠ€æœ¯åšå®¢"},{"content":"è½¯ä»¶ç”±éœ€æ±‚é©±åŠ¨ï¼Œè€Œéœ€æ±‚ä¼šä¸æ–­å˜åŒ–ï¼Œéšç€æ—¶é—´çš„å˜åŒ–ï¼Œç³»ç»Ÿçš„ç†µå¿…ç„¶ä¼šä¸æ–­å¢åŠ ï¼Œè½¯ä»¶å¼€å‘å°±æ˜¯æ§åˆ¶ç³»ç»Ÿç†µå‡çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•ç¼–å†™ä¸€ä¸ªå¯ç»´æŠ¤ã€å¯ç†è§£å’Œå¯æ‰©å±•çš„è½¯ä»¶ï¼Ÿ\næœ¬æ–‡æ—¨åœ¨ä»‹ç»ä¸€ä¸ªæœ‰ç€ 20 å¹´å†å²çš„é¢å‘å¯¹è±¡ SOLID è®¾è®¡åŸåˆ™ï¼Œå¯èƒ½ä¼šå¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚\nSOLID ç®€ä»‹ SOLID æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹é¢†åŸŸçš„äº”ä¸ªè®¾è®¡åŸåˆ™ï¼Œç”±å®ƒä»¬çš„é¦–å­—æ¯ç¼©å†™è€Œæ¥ï¼š\nSingle Responsibility Principleï¼ˆå•ä¸€åŠŸèƒ½åŸåˆ™ï¼‰ Open/Closed Principleï¼ˆå¼€é—­åŸåˆ™ï¼‰ Liskov Substitution Principleï¼ˆé‡Œæ°æ›¿æ¢åŸåˆ™ï¼‰ Interface Segregation Principleï¼ˆæ¥å£éš”ç¦»åŸåˆ™ï¼‰ Dependency Inversion Principleï¼ˆä¾èµ–åè½¬åŸåˆ™ï¼‰ ä½ å¤§æ¦‚ç‡å·²ç»å¬è¿‡è¿™äº›åè¯ï¼Œå‡å¦‚å®ƒä»¬å‡ºç°åœ¨ä¸€æœ¬ä»‹ç»ç¼–ç¨‹çš„ä¹¦é‡Œé¢ï¼Œä½ å¤§æ¦‚ç‡ä¼šå¿½ç•¥å®ƒä»¬ï¼Œå› ä¸ºå®ƒä»¬çœ‹èµ·æ¥å’Œä½ è¦åšçš„ç¼–ç¨‹å·¥ä½œæ²¡æœ‰å…³ç³»ã€‚\nå‡å¦‚ä½ æ˜¯ä¸€ä¸ªæœ‰äº†ä¸€å®šç»éªŒçš„ç¨‹åºå‘˜ï¼Œçœ‹åˆ°è¿™äº›åè¯ï¼Œå¹¶ç†è§£å®ƒä»¬ï¼Œä½ å¯èƒ½ä¼šéå¸¸å…´å¥‹ã€‚å› ä¸ºè¿™æ­£æ˜¯ä½ åœ¨å¯»æ‰¾çš„ä¸œè¥¿ã€‚\né€šè¿‡ä¾‹å­å­¦ä¹  SOLID Single Responsibility Principle å³å•ä¸€åŠŸèƒ½åŸåˆ™ï¼Œä»å­—é¢æ„æ€ä¸Šæ¥è®²ï¼Œå°±æ˜¯ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªåŠŸèƒ½ã€‚ä½†æ˜¯å‡å¦‚çœŸçš„è¿™ä¹ˆåšï¼Œæ— ç–‘æ˜¯è¿‡åº¦è®¾è®¡äº†ï¼Œæ‰€ä»¥æˆ‘æ›´æ„¿æ„è¿™æ ·å­ç†è§£ï¼šå‡å¦‚ä½ æœ‰ä¸€ä¸ªç±»ï¼Œç»å¸¸ä¿®æ”¹å®ƒå¹¶ä¸”æ€»æ˜¯å‡ºäºä¸åŒçš„åŸå› ï¼Œé‚£ä¹ˆä½ åº”è¯¥å°è¯•æŠŠå®ƒæ‹†åˆ†æˆä¸åŒçš„ç±»ã€‚\nè¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥è®¾è®¡å……åˆ†çš„å•å…ƒæµ‹è¯•ï¼Œé”™è¯¯ä¹Ÿæ›´å®¹æ˜“å®šä½ã€‚\nä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ª Text ç±»ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 class Text { public: void Append(const std::string \u0026amp;text) { text_.append(text); } void DeltetLastCharacter() { text_.pop_back(); } void DeleteSubString(const std::string \u0026amp;substring) { text_.erase(text_.find(substring), substring.length()); } void Print() { std::cout \u0026lt;\u0026lt; text_; } void PrintLastCharacter() { std::cout \u0026lt;\u0026lt; text_.back(); } void PrintLength() { std::cout \u0026lt;\u0026lt; text_.length(); } private: std::string text_; }; å®ƒæœ‰ Appendã€Deleteã€Print æ–¹æ³•ã€‚æ ¹æ® SRP åŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸º Appendã€Delete éƒ½å±äºæ“ä½œæ–‡æœ¬ï¼Œè€Œ Print åˆ™å±äºè¾“å‡ºæ–‡æœ¬åˆ°å¦å¤–ä¸€ä¸ªåœ°æ–¹ï¼Œå€Ÿæ­¤å¯ä»¥æŠŠ Print ç›¸å…³çš„å‡½æ•°æ”¾åˆ°ä¸€ä¸ªæ–°çš„ TextPrinter ç±»é‡Œé¢ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 class Text { public: void Append(const std::string \u0026amp;text) { text_.append(text); } void DeltetLastCharacter() { text_.pop_back(); } void DeleteSubString(const std::string \u0026amp;substring) { text_.erase(text_.find(substring), substring.length()); } std::string \u0026amp;GetText() { return text_; } private: std::string text_; }; class TextPrinter { public: void Print() { std::cout \u0026lt;\u0026lt; text_.GetText(); } void PrintLastCharacter() { std::cout \u0026lt;\u0026lt; text_.GetText().back(); } void PrintLength() { std::cout \u0026lt;\u0026lt; text_.GetText().length(); } private: Text text_; }; ä»»ä½•å¼€å‘è¿‡è½¯ä»¶çš„äººéƒ½æ˜ç™½ï¼Œè¿™ä¸æ˜¯ä¸€æ¡å®¹æ˜“éµå®ˆçš„è§„åˆ™ï¼Œå› ä¸ºæ¯”è¾ƒæç«¯çš„æƒ…å†µä¸‹ï¼Œä¼¼ä¹æˆ‘ä»¬å¾—è¦ä¸ºæ¯ä¸€ä¸ªåŠŸèƒ½éƒ½è®¾è®¡ä¸€ä¸ªç±»ï¼Œè¿™æ˜¯ä¸ç°å®çš„ã€‚\nçŸ¥é“å“ªäº›ç±»å¯ä»¥æ‹†åˆ†å¾ˆé‡è¦ï¼Œè¿™éœ€è¦ä½ åŠ¨ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDDDï¼‰çš„æ€æƒ³ï¼Œå……åˆ†äº†è§£å…·ä½“çš„ä¸šåŠ¡æ¨¡å‹ï¼Œä»¥æ­¤æ¥å†³å®šç±»çš„ç²’åº¦ã€‚å¦‚æœå®åœ¨æ˜¯è§‰å¾—çº ç»“ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€äº›æ•°å­¦æ–¹æ³•æ¥è¡¡é‡ç±»çš„å†…èšæ€§ï¼šCohesion metricsï¼Œä¸å†å±•å¼€ã€‚\nOpen/Closed Principle å³å¼€é—­åŸåˆ™ï¼Œå¼€é—­åŸåˆ™çš„å…¨ç§°æ˜¯ Open for Extension, Closed for Modificationã€‚å®ƒçš„ä¸»è¦æŒ‡å¯¼æ€æƒ³æ˜¯ä¸€ä¸ªç±»è¢«è®¾è®¡å®Œä¹‹åï¼Œå°±ä¸åº”è¯¥å†è¢«ä¿®æ”¹äº†ï¼Œè€Œæ˜¯åŸºäºæŠ½è±¡å»åšæ‰©å±•ã€‚è¿™å¬èµ·æ¥ç®€ç›´åŒªå¤·æ‰€æ€ï¼Œå¤©æ–¹å¤œè°­ï¼Œç™½æ—¥åšæ¢¦ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ª Calculator ç±»çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 enum class CalculatorOperation { ADD, SUB }; class Calculator { public: Calculator(float left, float right) : left_(left), right_(right) {} void Calculate(CalculatorOperation operation) { switch (operation) { case CalculatorOperation::ADD: result_ = left_ + result_; break; case CalculatorOperation::SUB: result_ = left_ - result_; break; default: break; } } private: float left_; float right_; float result_; }; è¿™çœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å‡å¦‚ä¹‹åæœ‰æ–°çš„æ“ä½œï¼Œæ¯”å¦‚ä¹˜æ³•ï¼Œé™¤æ³•ï¼Œæˆ–è€…å¹³æ–¹æ ¹ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ\nä½ å¯èƒ½ä¼šè¯´æ·»åŠ ä¸€ä¸ªæ–°çš„ caseï¼Œä½†æ˜¯è¿™å°±è¿èƒŒäº†å¼€é—­åŸåˆ™ï¼Œå®ƒä¿®æ”¹äº†å·²ç»å­˜åœ¨çš„ç±»ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸ªæ›´ç¬¦åˆå¼€é—­åŸåˆ™çš„å®ç°æ–¹å¼ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 class CalculatorOperation { public: virtual float Operation(float left, float right) = 0; }; class Addition : public CalculatorOperation { public: float Operation(float left, float right) override { return left + right; } }; class Subtraction : public CalculatorOperation { public: float Operation(float left, float right) override { return left - right; } }; class Calculator { public: Calculator(float left, float right) : left_(left), right_(right) {} void Calculate(CalculatorOperation operation) { result_ = operation.Operation(left_, right_); } private: float left_; float right_; float result_; }; æˆ‘ä»¬å·§å¦™åœ°æŠŠæ‰€æœ‰æ“ä½œæŠ½è±¡æˆä¸€ä¸ªæ¥å£ï¼Œç„¶åè®© Calculator ç±»ä¾èµ–è¿™ä¸ªæ¥å£ï¼Œè¿™æ ·å°±é¿å…äº†ä¿®æ”¹ Calculator ç±»ã€‚\nLiskov Substitution Principle å³é‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œå®ƒçš„è§„åˆ™å¾ˆç®€å•ï¼šå­ç±»å‹åº”è¯¥èƒ½æ›¿æ¢çˆ¶ç±»å‹å‡ºç°çš„ä½ç½®ä¸”æ— éœ€æ”¹åŠ¨ä»»ä½•ä»£ç ã€‚\nè™½ç„¶çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†æ˜¯å®é™…åšèµ·æ¥éå¸¸æœ‰è®²ç©¶ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒ Program Development in Java: Abstraction, Specification, and Object-Oriented Designï¼Œé‡Œé¢æå‡ºäº†ä¸€äº›å»ºè®¾æ€§çš„å»ºè®®ã€‚\nå­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œå‚æ•°ç±»å‹çš„èŒƒå›´å¯ä»¥æ‰©å¤§æˆ–ç›¸åŒã€‚ å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œè¿”å›ç±»å‹çš„èŒƒå›´åªèƒ½ç¼©å°æˆ–è€…ç›¸åŒã€‚ å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œä¸èƒ½æŠ›å‡ºçˆ¶ç±»æ²¡æœ‰æŠ›å‡ºçš„å¼‚å¸¸ã€‚ å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œæ–¹æ³•è¿è¡Œå‰çš„æ¡ä»¶è¦ä¸€è‡´ã€‚ å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œæ–¹æ³•è¿è¡Œåçš„æ¡ä»¶è¦ä¸€è‡´ã€‚ å­ç±»å±æ€§è¦æ»¡è¶³çˆ¶ç±»å±æ€§çš„çº¦æŸã€‚ å­ç±»ä¸èƒ½å…è®¸ä¿®æ”¹çˆ¶ç±»ä¸æ›¾ä¿®æ”¹çš„å±æ€§ã€‚ è¿™æ˜¯ä¸€ä¸ªéµå®ˆ LSP çš„ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 class Rectangle { public: Rectangle(int width, int height) : width_(width), height_(height) {} [[nodiscard]] int GetWidth() const { return width_; } [[nodiscard]] int GetHeight() const { return height_; } private: int width_, height_; }; class Square : public Rectangle { public: explicit Square(int size) : Rectangle(size, size) {} }; Square çš„å®½å’Œé«˜æ˜¯ä¸€æ ·çš„ï¼Œå®ƒæ¯” Rectangle å¤šä¸€ä¸ªçº¦æŸæ¡ä»¶ï¼Œæ‰€ä»¥ Square ç»§æ‰¿ Rectangle æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯åè¿‡æ¥å°±ä¸å¯¹ã€‚\nInterface Segregation Principle å³æ¥å£éš”ç¦»åŸåˆ™ï¼Œè¿™ä¸ªæ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œå³å°½å¯èƒ½æŠŠæ¥å£è®¾è®¡å¾—è¶³å¤Ÿå°ã€‚\nå‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ª Human ç±»ï¼š\n1 2 3 4 5 6 class Human { public: virtual void Eat() = 0; virtual void Run() = 0; virtual void Speak() = 0; }; æˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°ï¼ŒEatã€Run ä¸æ˜¯ Human ç‰¹æœ‰çš„è¡Œä¸ºï¼ŒSpeak çœ‹ä¸Šå»åƒæ˜¯ Human ç‰¹æœ‰çš„è¡Œä¸ºï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿè®¸ Alien ä¹Ÿæœ‰è¿™ä¸ªè¡Œä¸ºã€‚\næ‰€ä»¥æˆ‘ä»¬åº”è¯¥æ‹†åˆ†æˆæ›´ç»†ç²’åº¦çš„æ¥å£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 class Eatable { public: virtual void Eat() = 0; }; class Runable { public: virtual void Run() = 0; }; class Speakable { public: virtual void Speak() = 0; }; Dependency Inversion Principle å³ä¾èµ–åè½¬åŸåˆ™ï¼Œåœ¨æˆ‘ä»¬è®¾è®¡è½¯ä»¶çš„æ—¶å€™ï¼Œå¾ˆå®¹æ˜“åŸºäºæƒ³åˆ°ï¼Œä¸Šå±‚æ¨¡å—åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼Œä½†æ˜¯ä¾èµ–åè½¬åŸåˆ™æƒ³è¦å‘Šè¯‰ä½ ï¼Œä¸Šå±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºåº•å±‚æ¨¡å—ï¼Œè€Œæ˜¯ä¾èµ–äºæŠ½è±¡ã€‚è¿™ç§æƒ…å†µåœ¨åç«¯ç¼–ç¨‹çš„æ—¶å€™éå¸¸å¸¸è§ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 class ILoginService { public: virtual bool Login() = 0; }; class UserService : public ILoginService { public: bool Login() {} }; class AdminService : public ILoginService { public: bool Login() {} }; class FileController { public: void Upload() { bool access = loginService-\u0026gt;Login(); if (access) { // Do Upload } } private: ILoginService *loginService; }; åœ¨è¿™é‡Œï¼ŒFileController ç±»ä¾èµ–äº† ILoginService æ¥å£ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ UserService ç±»ï¼Œè¿™æ ·å°±é¿å…äº†åç»­æ·»åŠ  AdminService ç±»åï¼ŒFileController ç±»éœ€è¦å…¼å®¹ AdminService ç±»çš„é€»è¾‘ã€‚\næ€»ç»“ SOLID æ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡é¢†åŸŸçš„äº”ä¸ªåŸåˆ™çš„ç¼©å†™ï¼Œåˆ†åˆ«æ˜¯ï¼š\nå•ä¸€åŠŸèƒ½åŸåˆ™ï¼Œä¸€ä¸ªç±»åªåº”è¯¥è´Ÿè´£ä¸€ä¸ªå•ä¸€çš„åŠŸèƒ½ å¼€é—­åŸåˆ™ï¼Œéœ€æ±‚å˜åŠ¨çš„æ—¶å€™ï¼Œä¸åº”è¯¥ä¿®æ”¹ç±»ï¼Œè€Œæ˜¯æ‰©å±•ç±» é‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œæ´¾ç”Ÿç±»è¦èƒ½å®Œå…¨æ›¿æ¢åŸºç±»å‡ºç°çš„ä½ç½®ï¼Œä¸”ä»£ç è¡Œä¸ºè¦ä¿æŒä¸€è‡´ æ¥å£éš”ç¦»åŸåˆ™ï¼Œä¸åŒçš„é¢†åŸŸè¦åˆ†æˆä¸åŒçš„æ¥å£ï¼Œä¸èƒ½æ··åˆåœ¨ä¸€èµ· ä¾èµ–åè½¬åŸåˆ™ï¼Œé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºåº•å±‚æ¨¡å—ï¼Œè€Œæ˜¯ä¾èµ–äºæŠ½è±¡æ¥å£ å°è¯•åœ¨æ—¥å¸¸çš„ä»£ç ç¼–å†™ä¸­æ€è€ƒå’Œåº”ç”¨è¿™äº›åŸåˆ™ã€‚\nå‚è€ƒèµ„æ–™ A Solid Guide to SOLID Principles Single Responsibility Principle in Java Open/Closed Principle in Java Liskov Substitution Principle in Java ","date":"2024-02-27T21:56:50+08:00","permalink":"https://nonlinearthink.github.io/p/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-solid-%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/","title":"é¢å‘å¯¹è±¡ SOLID è®¾è®¡åŸåˆ™"},{"content":"è§£æ Supermap Rest æ ¹ç›®å½• ä» Supermap Rest æœåŠ¡çš„æ ¹ç›®å½•å‡ºå‘ï¼Œç¬¬ä¸€æ­¥æ˜¯è¯·æ±‚ CatalogListã€‚è¿”å›çš„ç»“æ„å¤§è‡´æ˜¯è¿™æ ·å­çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 [ { \u0026#34;resourceConfigID\u0026#34;: \u0026#34;maps\u0026#34;, \u0026#34;supportedMediaTypes\u0026#34;: [ \u0026#34;application/xml\u0026#34;, \u0026#34;text/xml\u0026#34;, \u0026#34;application/json\u0026#34;, \u0026#34;application/fastjson\u0026#34;, \u0026#34;application/rjson\u0026#34;, \u0026#34;text/html\u0026#34;, ... ], \u0026#34;path\u0026#34;: \u0026#34;http://192.168.31.4:8090/iserver/services/map-China/rest/maps\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;maps\u0026#34;, \u0026#34;resourceType\u0026#34;: \u0026#34;CatalogList\u0026#34; }, ... ] æˆ‘ä»¬éœ€è¦é‡Œé¢çš„ \u0026quot;path\u0026quot;ï¼Œå»è¯·æ±‚ä¸€ä¸ª CatalogListï¼Œå¯ä»¥å–å‡ºå¯¹åº”çš„ \u0026quot;name\u0026quot;ï¼Œè®©ç”¨æˆ·è‡ªå·±å»é€‰æ‹©è¯·æ±‚å“ªä¸ª CatalogListã€‚\nä¸€ä¸ªç®€å•çš„ SupermapRestClient å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 export class SupermapRestClient { private _url: string; constructor(url: string) { this._url = url; } async doRequest() { const resource = new Cesium.Resource(this._url + \u0026#34;.json\u0026#34;); const json = await resource.fetchJson(); const resourceList: { name: string; client: SupermapCatalogListClient }[] = []; for (const item of json) { if (item.resourceType === \u0026#34;CatalogList\u0026#34;) { resourceList.push({ name: item.name, client: new SupermapCatalogListClient(item.path) }); } } return resourceList; } } å…¶ä¸­çš„ SupermapCatalogListClient åœ¨ä¸‹ä¸€å°èŠ‚å®ç°ã€‚\nè·å– CatalogList ç°åœ¨å‡å¦‚ç”¨æˆ·å·²ç»é€‰æ‹©éœ€è¦è¯·æ±‚çš„ CatalogListï¼Œå†æ¥çœ‹ä»¥ä¸€ä¸‹ CatalogList çš„ç»“æ„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 [ { \u0026#34;resourceConfigID\u0026#34;: \u0026#34;map\u0026#34;, \u0026#34;supportedMediaTypes\u0026#34;: [ \u0026#34;application/xml\u0026#34;, \u0026#34;text/xml\u0026#34;, \u0026#34;application/json\u0026#34;, \u0026#34;application/fastjson\u0026#34;, \u0026#34;application/rjson\u0026#34;, \u0026#34;text/html\u0026#34;, ... ], \u0026#34;path\u0026#34;: \u0026#34;http://192.168.31.4:8090/iserver/services/map-China/rest/maps/China\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;China\u0026#34;, \u0026#34;resourceType\u0026#34;: \u0026#34;StaticResource\u0026#34; }, ... ] åŒç†ï¼Œå–å‡º \u0026quot;path\u0026quot; å’Œ \u0026quot;name\u0026quot;ï¼Œä¸€ä¸ªç®€å•çš„ SupermapCatalogListClient å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 export class SupermapCatalogListClient { private _url: string; constructor(url: string) { this._url = url; } async doRequest() { const resource = new Cesium.Resource(this._url + \u0026#34;.json\u0026#34;); const json = await resource.fetchJson(); const resourceList: { name: string; client: SupermapRestStaticResourceClient }[] = []; for (const item of json) { if (item.resourceType === \u0026#34;StaticResource\u0026#34;) { resourceList.push({ name: item.name, client: new SupermapRestStaticResourceClient(item.path) }); } } return resourceList; } } å…¶ä¸­çš„ SupermapRestStaticResourceClient åœ¨ä¸‹ä¸€å°èŠ‚å®ç°ã€‚\nè·å– StaticResource è·å– Capabilities åœ¨å¾ˆå¤šåœ°å›¾åè®®ä¸­ï¼Œåœ°å›¾çš„ metadata ä¸€èˆ¬ä¹Ÿå«åš Capabilitiesï¼Œ StaticResource è¯·æ±‚çš„å°±æ˜¯åœ°å›¾çš„ metadataï¼Œæ‰€ä»¥ä¸€ä¸ªç®€å•çš„ SupermapRestStaticResourceClient å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 export class SupermapRestStaticResourceClient { private _url: string; constructor(url: string) { this._url = url; } async getCapabilities() { const jsonResource = new Cesium.Resource(this._url + \u0026#34;.json\u0026#34;); return await jsonResource.fetchJson(); } } è¿™ä¸ªè¿”å›çš„ json é‡Œé¢æœ‰å¾ˆå¤šä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰æˆ‘ä»¬æœ€éœ€è¦çš„åœ°å›¾ç“¦ç‰‡åœ°å€ï¼Œå…ˆå¿½ç•¥å®ƒï¼Œä¹‹åå†æ¥çœ‹ã€‚\nè·å–åœ°å›¾ç“¦ç‰‡ æ‰“å¼€ iServer çš„ Rest æœåŠ¡åœ°å›¾åˆ—è¡¨ç•Œé¢ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€äº›å¯ä»¥é¢„è§ˆæ•ˆæœçš„é“¾æ¥ã€‚\né€šè¿‡æŸ¥çœ‹ç½‘ç»œè¯·æ±‚ï¼Œå¯ä»¥æ‰¾åˆ°åœ°å›¾ç“¦ç‰‡è¯·æ±‚ï¼Œæ˜¾ç¤ºæœ€åè¯·æ±‚çš„æ˜¯ä¸€ä¸ª tileImage.png çš„å›¾ç‰‡ï¼š\nä»¥æ­¤ï¼Œå¯ä»¥ä¸º SupermapRestStaticResourceClient æ·»åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•æ¥æ„é€ è¿™ä¸ªè¯·æ±‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 export class SupermapRestStaticResourceClient { ... getTileImageResource(tilingScheme: Cesium.TilingScheme) { let originX: number; let originY: number; if (tilingScheme instanceof Cesium.WebMercatorTilingScheme) { originX = -20037508.342787; originY = 20037508.342787; } else { originX = -180; originY = 90; } const tileImageResource = new Cesium.Resource(this._url + \u0026#34;/tileImage.png\u0026#34;); tileImageResource.appendQueryParameters({ transparent: true, cacheEnabled: true, width: 256, height: 256, redirect: false, overlapDisplayed: false, origin: `{x:${originX},y:${originY}}`, x: \u0026#34;{x}\u0026#34;, y: \u0026#34;{y}\u0026#34;, scale: \u0026#34;{scale}\u0026#34; }); return tileImageResource; } } å…¶ä¸­ï¼Œorigin éœ€è¦æ ¹æ®ä¸åŒçš„æŠ•å½±åæ ‡ç³»æˆ–è€…åœ°ç†åæ ‡ç³»è¿›è¡Œä¿®æ”¹ï¼Œx, y, scale è¿™ä¸‰ä¸ªå‚æ•°äº¤ç»™ Cesium å»å¡«å†™ã€‚\nx å’Œ y å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šçš„ç“¦ç‰‡åæ ‡ï¼Œä½†æ˜¯ scale æ˜¯ä»€ä¹ˆã€‚\nè®¡ç®— scale åœ¨ Supermap çš„æ–‡æ¡£ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°ç›¸å…³çš„æè¿°ï¼šscale\n$$ scale = \\frac{1}{Resolution \\frac{PPI}{0.0254}} $$\nResolution ä»£è¡¨æ¯ä¸€ä¸ªåƒç´ æœ‰å¤šå°‘å®é™…è·ç¦» PPI ä»£è¡¨äº†æ¯ä¸€è‹±å°ºæœ‰å¤šå°‘ä¸ªåƒç´ ï¼Œè¿™ä¸ªæ•°å€¼ä¸€èˆ¬ä¸º 96 0.0254 æ˜¯è‹±å°ºå’Œç±³çš„è½¬æ¢æ¯”ä¾‹ ä»¥ WebMercator ä¸ºä¾‹ï¼Œå®ƒçš„ç¬¬ 0 çº§ç“¦ç‰‡æ•´å¼ åœ°å›¾å®é™…å¤§å°ä¸º 40075016.68Ã—40075016.68 ç±³å·¦å³ï¼Œå‡å¦‚å‘ Supermap å‘èµ·ä¸€ä¸ª 256Ã—256 åƒç´ å¤§å°çš„å›¾ç‰‡è¯·æ±‚ï¼Œé‚£ä¹ˆï¼š\n$$ \\begin{aligned} \\cr Resolution \u0026amp;= \\frac{40075016.68}{256} = 156543.03\\cr scale \u0026amp;= \\frac{1}{156543.03 \\frac{96}{0.0254}} = 1.6901635718379278e-9 \\end{aligned} $$\nä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡º WGS84 å’Œ WebMercator å„ä¸ªçº§åˆ«ä¸‹çš„ scale å€¼ï¼Œå¹¶ç”¨ä¸€ä¸ªæ•°ç»„æ¥è¡¨ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 const WGS84Scales = [ 3.38032714321e-9, 6.76065428641e-9, 1.352130857282e-8, 2.704261714564e-8, 5.408523429128e-8, 1.0817046858257e-7, 2.1634093716514e-7, 4.3268187433028e-7, 8.6536374866056e-7, 1.73072749732112e-6, 3.46145499464224e-6, 6.92290998928448e-6, 1.3845819978568952e-5, 2.7691639957137904e-5, 5.538327991427581e-5, 1.1076655982855162e-4, 2.2153311965710323e-4, 4.4306623931420646e-4, 8.861324786284129e-4, 0.0017722649572568258, 0.0035445299145136517, 0.007089059829027303 ]; const WebmercatorScales = [ 1.6901635716e-9, 3.38032714321e-9, 6.76065428641e-9, 1.352130857282e-8, 2.704261714564e-8, 5.408523429128e-8, 1.0817046858257e-7, 2.1634093716514e-7, 4.3268187433028e-7, 8.6536374866056e-7, 1.73072749732112e-6, 3.46145499464224e-6, 6.92290998928448e-6, 1.3845819978568952e-5, 2.7691639957137904e-5, 5.538327991427581e-5, 1.1076655982855162e-4, 2.2153311965710323e-4, 4.4306623931420646e-4, 8.861324786284129e-4, 0.0017722649572568258, 0.0035445299145136517, 0.007089059829027303 ]; è·å– Rectangle å’Œ TilingScheme Rectangle å°±æ˜¯ Cesium é‡Œé¢çš„ç»çº¬åº¦èŒƒå›´ï¼ŒTilingScheme å°±æ˜¯ Cesium é‡Œé¢çš„æŠ•å½±åæ ‡ç³»å’Œåœ°ç†åæ ‡ç³»ã€‚\nè¿™äº›ä¿¡æ¯è¢«è®°å½•åœ¨ä¸€å¼€å§‹æˆ‘ä»¬è¯·æ±‚çš„ Capabilities é‡Œé¢ã€‚\nä¸º SupermapRestStaticResourceClient æ·»åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 export class SupermapRestStaticResourceClient { ... getTilingSchemeFromCapabilities(capabilities: any) { let tilingScheme: Cesium.TilingScheme; if (capabilities.prjCoordSys.epsgCode === 4326) { const rectangle = new Cesium.Rectangle( capabilities.bounds.left, capabilities.bounds.bottom, capabilities.bounds.right, capabilities.bounds.top ); tilingScheme = new Cesium.GeographicTilingScheme({ numberOfLevelZeroTilesX: 2, numberOfLevelZeroTilesY: 1, rectangle }); } else if (capabilities.prjCoordSys.epsgCode === 3857) { const southwest = new Cesium.Cartesian2(capabilities.bounds.left, capabilities.bounds.bottom); const northeast = new Cesium.Cartesian2(capabilities.bounds.right, capabilities.bounds.top); tilingScheme = new Cesium.WebMercatorTilingScheme({ numberOfLevelZeroTilesX: 1, numberOfLevelZeroTilesY: 1, rectangleSouthwestInMeters: southwest, rectangleNortheastInMeters: northeast }); } else { throw new Error(`espsgCode ${capabilities.prjCoordSys.epsgCode} is not supported.`); } return tilingScheme; } } æ„é€  SupermapRestImageryProvider æœ€åä½¿ç”¨ SupermapRestStaticResourceClient å»æ„é€ ä¸€ä¸ª SupermapRestImageryProviderï¼Œå®ƒç»§æ‰¿è‡ª Cesium.UrlTemplateImageryProviderï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 export class SupermapRestImageryProvider extends Cesium.UrlTemplateImageryProvider { private constructor(options: Cesium.UrlTemplateImageryProvider.ConstructorOptions) { super(options); } static async fromSupermapRestStaticResourceClient(client: SupermapRestStaticResourceClient) { const capabilities = await client.getCapabilities(); const tilingScheme = client.getTilingSchemeFromCapabilities(capabilities); const tileImageResource = client.getTileImageResource(tilingScheme); return new SupermapRestImageryProvider({ url: tileImageResource, tilingScheme, customTags: { scale: function (_imageryProvider: Cesium.UrlTemplateImageryProvider, _x: number, _y: number, level: number) { if (tilingScheme instanceof Cesium.WebMercatorTilingScheme) { return WebmercatorScales[level]; } else { return WGS84Scales[level]; } } } }); } } å…¶ä¸­ï¼Œä½¿ç”¨äº† customTags åŠŸèƒ½ï¼Œå› ä¸º scale ä¸æ˜¯ Cesium.UrlTemplateImageryProvider é»˜è®¤æœ‰çš„å‚æ•°ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°è¿”å›åœ¨ä¸åŒ level ä¸‹çš„ scale å€¼ã€‚\nä»£ç è°ƒç”¨æµç¨‹ æœ€åï¼Œæ¼”ç¤ºå¦‚ä½•å»ä½¿ç”¨ä¸Šé¢ç¼–å†™çš„æ–¹æ³•ã€‚\nè¯·æ±‚ CatalogList 1 2 3 4 5 6 7 const url = \u0026#34;ä½ çš„ Supermap Rest åœ°å€\u0026#34;; // åˆ›å»º SupermapRestClient const client = new SupermapRestClient(url); // è¯·æ±‚ CatalogListã€‚ const catalogList = await client.doRequest(); ç­‰å¾…ç”¨æˆ·é€‰æ‹©å“ªä¸€ä¸ª CatalogListã€‚\nè¯·æ±‚ StaticResource 1 2 3 4 5 6 7 8 // å‡è®¾ç”¨æˆ·é€‰æ‹©äº†ç¬¬ä¸€ä¸ª const selectId = 0; // è·å–ç”¨æˆ·é€‰æ‹©çš„ CatalogListClient const catalogListClient: SupermapCatalogListClient = catalogList[selectId].client; // è¯·æ±‚ StaticResource const staticResourceList = await catalogListClient.doRequest(); ç­‰å¾…ç”¨æˆ·é€‰æ‹©å“ªä¸€ä¸ª StaticResourceã€‚\næ·»åŠ  ImageryProvider 1 2 3 4 5 6 7 8 9 10 11 // å‡è®¾ç”¨æˆ·é€‰æ‹©äº†ç¬¬ä¸€ä¸ª const selectId = 0; // è·å–ç”¨æˆ·é€‰æ‹©çš„ StaticResourceClient const staticResourceClient: SupermapRestStaticResourceClient = staticResourceList[selectId].client; // åˆ›å»º ImageryProvider const provider = await SupermapRestImageryProvider.fromSupermapRestStaticResourceClient(staticResourceClient); // æ·»åŠ  ImageryProvider viewer.imageryLayers.addImageryProvider(provider); å®Œæ•´ä»£ç \u0026amp;æ•ˆæœå›¾ å®Œæ•´ä»£ç ï¼šcesium-supermap-rest-imagery-provider\nå‚è€ƒèµ„æ–™ SuperMap iClient3D for WebGL SuperMapImageryProviderè‡ªå®šä¹‰å®ç° ","date":"2024-01-09T19:08:00+08:00","image":"https://nonlinearthink.github.io/p/cesiumjs-%E5%8A%A0%E8%BD%BD-supermap-rest-%E6%9C%8D%E5%8A%A1/cesium_hu0485d4a175c61522316e77db0dafcef6_72500_120x120_fill_q75_box_smart1.jpg","permalink":"https://nonlinearthink.github.io/p/cesiumjs-%E5%8A%A0%E8%BD%BD-supermap-rest-%E6%9C%8D%E5%8A%A1/","title":"CesiumJS åŠ è½½ Supermap Rest æœåŠ¡"},{"content":"æ±‚è§£ç»˜åˆ¶ä¸‰è§’å½¢é—®é¢˜ ç»˜åˆ¶ä¸‰è§’å½¢å°±æ˜¯éå†æ¯ä¸€ä¸ªåƒç´ ï¼Œç„¶åï¼Œåˆ¤æ–­è¿™ä¸ªåƒç´ æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…éƒ¨ã€‚\nä½†æ˜¯ä¸‡ä¸€ï¼Œä¸‰è§’å½¢å¾ˆå°ï¼Œè€Œå±å¹•å¾ˆå¤§ï¼Œéå†æ¯ä¸€ä¸ªåƒç´ æ˜¾ç„¶æ˜¯éå¸¸ä½æ•ˆçš„ï¼Œåœ¨æ­£å¼éå†å‰å¯ä»¥æ±‚å‡º Bounding Rect æ¥ç¼©å°èŒƒå›´ï¼š\n1 2 3 4 5 6 7 // Bounding Rect Vector2i min(0, 0); Vector2i max(width - 1, height - 1); min.x = std::max(min.x, std::min(p0.x, std::min(p1.x, p2.x))); min.y = std::max(min.y, std::min(p0.y, std::min(p1.y, p2.y))); max.x = std::min(max.x, std::max(p0.x, std::max(p1.x, p2.x))); max.y = std::min(max.y, std::max(p0.y, std::max(p1.y, p2.y))); åˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…éƒ¨ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»é‡å¿ƒåæ ‡ï¼Œå› ä¸ºè¿™æ˜¯å›¾å½¢å­¦éå¸¸é‡è¦çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œè€Œä¸”ä¹Ÿèƒ½éå¸¸å¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\né‡å¿ƒåæ ‡ï¼ˆBarycentric Coordinateï¼‰çš„å®šä¹‰ å‡è®¾å¹³é¢ä¸Šå­˜åœ¨ä¸‰è§’å½¢çš„ä¸‰ä¸ªç‚¹ $a, b, c$ï¼Œåˆ™å¹³é¢ä¸Šä»»æ„çš„ç‚¹ $p$ éƒ½å¯ä½¿ç”¨ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹è¡¨ç¤ºï¼š\n$$ \\begin{aligned} p \u0026amp;= a+\\beta(b-a)+\\gamma(c-a)\\cr p \u0026amp;= (1-\\beta-\\gamma)a+\\beta b+\\gamma c \\end{aligned} $$\nä»¤ï¼š\n$$ \\begin{aligned} \\alpha \u0026amp;= 1-\\beta-\\gamma \\end{aligned} $$\nå½“ $\\alpha$ã€$\\beta$ã€$\\gamma$ å‡å¤§äº 0 å°äº 1 æ—¶ï¼Œ$p$ ä½äºä¸‰è§’å½¢å†…éƒ¨ å½“ $\\alpha$ã€$\\beta$ã€$\\gamma$ ä¸­æœ‰ä¸€ä¸ªåˆ†é‡ç­‰äº 0 æ—¶ï¼Œ$p$ åœ¨ä¸‰è§’å½¢è¾¹ä¸Š å½“ $\\alpha$ã€$\\beta$ã€$\\gamma$ ä¸­æœ‰ä¸¤ä¸ªå˜é‡ç­‰äº 0 æ—¶ï¼Œ$p$ åœ¨æŸä¸ªé¡¶ç‚¹ä¸Š ä»¥åæ ‡å½¢å¼è¡¨ç¤ºï¼š\n$$ p = (\\alpha, \\beta, \\gamma) $$\né‡å¿ƒåæ ‡çš„è®¡ç®— é¢ç§¯æ³• $$ \\begin{aligned} \\alpha = \\frac{A_a}{A_a+A_b+A_c} \\cr \\beta = \\frac{A_b}{A_a+A_b+A_c} \\cr \\gamma = \\frac{A_c}{A_a+A_b+A_c} \\end{aligned} $$\næ±‚é¢ç§¯å¯ä»¥ä½¿ç”¨å‰ä¹˜ï¼š\n$$ \\alpha = \\frac{A_a}{A} = \\frac{\\vert (c-b) \\times (c-p)\\vert}{\\vert (a-b) \\times (a-c)\\vert} $$\nä½†æ˜¯æ±‚å‡ºæ¥çš„ $\\alpha$ å¤±å»äº†æ–¹å‘æ€§ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç‚¹ä¹˜ä¸€ä¸ªæ³•çº¿æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š\n$$ \\alpha = \\frac{((c-b) \\times (p-b))\\cdot n}{((b-a) \\times (c-a))\\cdot n} $$\nè¿™ä¸ªç­‰å¼ä¹‹æ‰€ä»¥æˆç«‹çš„å…³é”®æ˜¯ä¸¤ä¸ªå‘é‡ $a$ã€$b$ çš„ç‚¹ä¹˜è¡¨è¾¾å¼ä¸ºï¼š $$a\\cdot b = \\vert a\\vert\\vert b\\vert\\cos\\theta$$ å½“å®ƒä»¬ç›¸äº’å‚ç›´çš„æ—¶å€™ï¼Œ$\\cos\\theta = 1$ï¼Œé‚£ä¹ˆä¸Šé¢çš„è¡¨ç¤ºå¼å®é™…ä¸Šå¯ä»¥è¢«è¡¨è¾¾ä¸ºï¼š $$ \\alpha = \\frac{\\vert(c-b) \\times (p-b)\\vert \\vert n\\vert}{\\vert(b-a) \\times (c-a)\\vert \\vert n\\vert} = \\frac{\\vert(c-b) \\times (p-b)\\vert}{\\vert(b-a) \\times (c-a)\\vert} $$ è¿™ä¸ªç»“æœå’Œä¹‹å‰çš„æ¨å¯¼ä¸€æ ·ã€‚\nåŒæ—¶æˆ‘ä»¬ä»å‰ä¹˜çš„å®šä¹‰ä¸­å¾—åˆ° $n = ab \\times ac$ã€‚\næœ€ç»ˆï¼Œæˆ‘ä»¬å¾—åˆ°äº†æœ€ç»ˆç»“æœï¼š\n$$ \\begin{aligned} \\alpha \u0026amp;= \\frac{n_a \\cdot n}{n\\cdot n}\\cr \\beta \u0026amp;= \\frac{n_b \\cdot n}{n\\cdot n}\\cr \\gamma \u0026amp;= \\frac{n_c \\cdot n}{n\\cdot n} \\end{aligned} $$\nå…¶ä¸­ï¼š\n$$ \\begin{aligned} n_a \u0026amp;= (c-b) \\times (p-b)\\cr n_b \u0026amp;= (a-c) \\times (p-c)\\cr n_c \u0026amp;= (b-a) \\times (p-a) \\end{aligned} $$\nä»£æ•°æ³• æŠŠä¸Šä¸€å°èŠ‚çš„å…¬å¼ï¼Œå†™æˆè¿™æ ·çš„å½¢å¼ï¼š\n$$ \\beta(b-a)+\\gamma(c-a)+(a-p)= 0 $$\nåˆ†åˆ«å¸¦å…¥ x å’Œ yï¼Œå¾—åˆ°ä¸¤ä¸ªæ–¹ç¨‹ï¼Œæ±‚ä¸¤ä¸ªæœªçŸ¥æ•°ï¼š\n$$ \\begin{aligned} (x_b - x_a)\\beta+(x_c - x_a)\\gamma+(x_a - x_p) \u0026amp;= 0\\cr (y_b - y_a)\\beta+(y_c - y_a)\\gamma+(y_a - y_p) \u0026amp;= 0 \\end{aligned} $$\næœ€ç»ˆçš„ç»“æœ:\n$$ \\begin{aligned} \\gamma \u0026amp;= \\frac{(y_a-y_b)x_p+(x_b-x_a)y_p+x_a y_b-x_b x_a}{(y_a-y_b)x_c+(x_a-x_b)y_c+x_a y_b-x_b x_a}\\cr \\beta \u0026amp;= \\frac{(y_a-y_c)x_p+(x_c-x_a)y_p+x_a y_c-x_c x_a}{(y_a-y_c)x_b+(x_c-x_a)y_b+x_a y_c-x_c x_a}\\cr \\alpha \u0026amp;= 1-\\gamma-\\beta \\end{aligned} $$\nä¸Šé¢æ˜¯æ ‡å‡†çš„æ±‚æ³•ï¼Œè¿˜æœ‰ä¸€ç§æ·å¾„ã€‚\næŠŠä¸Šé¢ä¸¤ä¸ªæ–¹ç¨‹å˜æˆçŸ©é˜µå½¢å¼ï¼š\n$$ \\begin{aligned} \\begin{bmatrix} x_b - x_a \u0026amp; x_c - x_a \u0026amp; x_a - x_p \\cr \\end{bmatrix} \\begin{bmatrix} \\beta \\cr \\gamma \\cr 1 \\end{bmatrix} \u0026amp;= 0\\cr \\begin{bmatrix} y_b - y_a \u0026amp; y_c - y_a \u0026amp; y_a - y_p\\cr \\end{bmatrix} \\begin{bmatrix} \\beta \\cr \\gamma \\cr 1 \\end{bmatrix} \u0026amp;= 0 \\end{aligned} $$\nè¯´æ˜å‘é‡ $\\begin{bmatrix}x_b - x_a \u0026amp; x_c - x_a \u0026amp; x_a - x_p \\end{bmatrix}$ å‚ç›´äºå‘é‡ $\\begin{bmatrix}\\beta \u0026amp;\\gamma \u0026amp; 1\\end{bmatrix}$ï¼Œå‘é‡ $\\begin{bmatrix}y_b - y_a \u0026amp; y_c - y_a \u0026amp; y_a - y_p \\end{bmatrix}$ å‚ç›´äºå‘é‡ $\\begin{bmatrix}\\beta \u0026amp;\\gamma \u0026amp; 1\\end{bmatrix}$ã€‚\nå¾—åˆ°ï¼š\n$$ \\begin{bmatrix} x_b - x_a \\cr x_c - x_a \\cr x_a - x_p \\end{bmatrix}\\times \\begin{bmatrix} y_b - y_a \\cr y_c - y_a \\cr y_a - y_p \\end{bmatrix}= \\begin{bmatrix} k\\beta \\cr k\\gamma \\cr k \\end{bmatrix} $$\nè¿™æ˜¯æœ€å¿«çš„é‡å¿ƒè®¡ç®—æ³•ï¼Œå®ƒåªä½¿ç”¨äº†ä¸€ä¸ªå‰ä¹˜å°±è§£å†³äº†é—®é¢˜ã€‚\né‡å¿ƒåæ ‡ä»£ç å®ç° æ ¹æ®ä¸Šé¢æ¨å¯¼çš„å…¬å¼ï¼Œæœ€ç»ˆï¼Œä»£ç å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 for (int y = min.y; y \u0026lt;= max.y; y++) { for (int x = min.x; x \u0026lt;= max.x; x++) { Vector3i vx(p1.x - p0.x, p2.x - p0.x, p0.x - x); Vector3i vy(p1.y - p0.y, p2.y - p0.y, p0.y - y); Vector3i u = vx.Cross(vy); if (std::abs(u.z) \u0026lt; 1) { continue; } Vector3f barycentric(1.f - (u.x + u.y) / (float)u.z, u.x / (float)u.z, u.y / (float)u.z); if (barycentric.x \u0026gt; 0 \u0026amp;\u0026amp; barycentric.x \u0026lt; 1 \u0026amp;\u0026amp; barycentric.y \u0026gt; 0 \u0026amp;\u0026amp; barycentric.y \u0026lt; 1 \u0026amp;\u0026amp; barycentric.z \u0026gt; 0 \u0026amp;\u0026amp; barycentric.z \u0026lt; 1) { PutPixel(Vector2i(x, y), color); } } } å‚è€ƒèµ„æ–™ Fundamentals of Computer Graphics ä¸‰è§’å½¢é‡å¿ƒåæ ‡ ","date":"2023-12-12T16:42:50+08:00","permalink":"https://nonlinearthink.github.io/p/%E7%BC%96%E5%86%99%E5%85%89%E6%A0%85%E5%8C%96%E6%B8%B2%E6%9F%93%E5%99%A8%E5%9B%9B%E7%BB%98%E5%88%B6%E4%B8%89%E8%A7%92%E5%BD%A2/","title":"ç¼–å†™å…‰æ …åŒ–æ¸²æŸ“å™¨ï¼ˆå››ï¼‰ç»˜åˆ¶ä¸‰è§’å½¢"},{"content":"DDA Line DDA(Digital Differential Analyzer) æ­£å¦‚å…¶åï¼Œå°±æ˜¯æœ€ç›´è§‚çš„ç›´çº¿ç”»æ³•ï¼ŒåŸå§‹çš„ç®—æ³•çš„æè¿°å¦‚ä¸‹ï¼š\nå‡è®¾å­˜åœ¨å±å¹•ç©ºé—´ä¸Šçš„ä¸¤ä¸ªç‚¹ $(x1, y1)$ å’Œ $(x2, y2)$\nè®¡ç®— $dx=x2-x1$ï¼Œ$dy=y2-y1$ã€‚ è®¡ç®—æ–œç‡ $k=\\frac{dy}{dx}$ã€‚ x ä» x1 å‡ºå‘ï¼Œæ¯æ¬¡å‘ x2 ç§»åŠ¨ä¸€ä¸ªå•ä½ï¼Œè®¡ç®— $y=y1+k(xâ€“x1)$ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 void DDA(int x0, int y0, int x1, int y1) { // è®¡ç®— dx \u0026amp; dy \u0026amp; k int dx = x1 - x0; int dy = y1 - y0; float k = dy / dx; // å¾ªç¯ç»˜åˆ¶æ¯ä¸€ä¸ªåƒç´  for (int x = x1; x \u0026lt;= x2; x++) { putpixel(x, round(y1 + k * (x - x1)), RED); } } åŸå§‹ç®—æ³•çœ‹èµ·æ¥å¾ˆå¯é ï¼Œä½†æ˜¯ä»ç„¶æœ‰ä¸€äº›å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œå› ä¸ºç›´çº¿æ˜¯çº¿æ€§ä¸”å‡åŒ€çš„ï¼Œæ‰€ä»¥å‡å¦‚æå‰è®¡ç®—å¥½äº†æ¯ä¸€æ¬¡å¾ªç¯çš„å¢é‡ï¼Œå°±å¯ä»¥é¿å… y1 + k * (x - x1) ä¸­çš„æµ®ç‚¹æ•°ä¹˜æ³•ã€‚\nä¼˜åŒ–è¿‡åçš„ DDA ç®—æ³•å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 void DDA(int x0, int y0, int x1, int y1) { // è®¡ç®— dx \u0026amp; dy int dx = x1 - x0; int dy = y1 - y0; // è®¡ç®—éœ€è¦è®¡ç®—å¤šå°‘æ­¥åƒç´  int steps = abs(dx) \u0026gt; abs(dy) ? abs(dx) : abs(dy); // è®¡ç®— x \u0026amp; y æ¯ä¸€æ­¥çš„å¢é‡ float xinc = dx / (float)steps; float yinc = dy / (float)steps; // å¾ªç¯ç»˜åˆ¶æ¯ä¸€ä¸ªåƒç´  float x = x0; float y = y0; for (int i = 0; i \u0026lt;= steps; i++) { putpixel(round(x), round(y), RED); x += xinc; y += yinc; } } Bresenham\u0026rsquo;s Line ä»ä¸Šé¢ DDA çš„ä¼˜åŒ–æ¡ˆä¾‹å¯ä»¥çœ‹å‡ºï¼Œé¿å…æµ®ç‚¹æ•°æ“ä½œå°±æ˜¯ä¼˜åŒ–ç”»çº¿ç®—æ³•çš„å…³é”®ã€‚\nBresenham's Line ç›¸æ¯” DDA ä¸ä»…æœ‰æ›´å°‘çš„æµ®ç‚¹æ•°è¿ç®—ï¼Œè€Œä¸”æ²¡æœ‰æµ®ç‚¹æ•°å’Œæ•´æ•°çš„ç±»å‹è½¬æ¢ã€‚\nç®—æ³•çš„æ ¸å¿ƒæ€æƒ³å¦‚ä¸‹ï¼š\nåœ¨ $(x_k, y_k)$ çš„ä½ç½®æ—¶å€™ï¼Œå¯èƒ½èµ°å‘ $(x_k+1, y_k)$ ä¹Ÿå¯èƒ½èµ°å‘ $(x_k+1, y_k+1)$ï¼Œæ˜¾ç„¶ï¼Œæ–œçº¿çš„äº¤ç‚¹æ›´åŠ é è¿‘è°ï¼Œå°±å¾€å“ªä¸ªæ–¹å‘èµ°ã€‚\næ–œç‡:\n$$ k = \\frac{\\Delta y}{\\Delta x} $$\nå¯¹äºæ¯ä¸€æ¬¡å¾ªç¯ï¼Œæ‰§è¡Œï¼š\n$$ x_{i+1} = x_i + 1\\ e_{i+1} = e_i + k\\ $$\nåŒæ—¶ï¼Œå§‹ç»ˆä¿è¯ $0 \u0026lt; e \u0026lt; 1$ï¼š\n$$ e_{i+1} = e_{i+1} - 1, e_{i+1} \u0026gt; 1 $$\næœ€åï¼Œå¾—å‡ºè¿™ä¸ªç‚¹çš„ yï¼š\n$$ y_{i+1} = \\begin{cases} y_i+1 \u0026amp;\\text{if } e_{i+1} \\gt 0.5\\cr y_i \u0026amp;\\text{if } e_{i+1} \\le 0.5\\cr \\end{cases} $$\nä¸Šé¢çš„ç®—æ³•æ˜¯ Bresenham's Line çš„åŸºæœ¬æ€æƒ³ï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå‡å°‘æµ®ç‚¹æ•°è¿ç®—ã€‚\nå¯èƒ½äº§ç”Ÿæµ®ç‚¹æ•°çš„åœ°æ–¹æ˜¯ $k = \\frac{\\Delta y}{\\Delta x}$ å’Œ $e_{i+1} \\gt 0.5$ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€åå†æŠŠä¸Šé¢æ‰€æœ‰çš„è¿‡ç¨‹ä¹˜ä»¥ $2\\Delta x$ã€‚\næœ€ç»ˆï¼Œæˆ‘ä»¬çš„ä»£ç å¦‚ä¸‹ï¼Œå…¶ä¸­ $\\Delta x = x_2 - x_1, \\Delta y = y_2 - y_1$ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 void bresenham(int x1, int y1, int x2, int y2) { int m = 2 * (y2 - y1); int slope_error = m - (x2 - x1); for (int x = x1, y = y1; x \u0026lt;= x2; x++) { putpixel(x, y, RED); slope_error += m; if (slope_error \u0026gt;= 0) { y++; slope_error -= 2 * (x2 - x1); } } } æœ€åçš„ä»£ç è™½ç„¶çœ‹èµ·æ¥ç®€æ´ï¼Œä½†æ˜¯å› ä¸ºä¼˜åŒ–è¿‡ï¼Œç¬¬ä¸€æ¬¡æ¥è§¦å®¹æ˜“æ‘¸ä¸ç€å¤´è„‘ã€‚\nå…¶ä»–ç®—æ³• è¿˜æœ‰ä¸€ç§å« Mid-Point Line ï¼Œå› ä¸ºå®ƒå³æ²¡æœ‰ DDA ç®€å•ç›´æ¥ï¼Œä¹Ÿæ²¡æœ‰ Bresenham æ•ˆç‡é«˜ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚\n","date":"2023-12-08T23:12:03+08:00","permalink":"https://nonlinearthink.github.io/p/%E7%BC%96%E5%86%99%E5%85%89%E6%A0%85%E5%8C%96%E6%B8%B2%E6%9F%93%E5%99%A8%E4%B8%89%E7%BB%98%E5%88%B6%E7%9B%B4%E7%BA%BF/","title":"ç¼–å†™å…‰æ …åŒ–æ¸²æŸ“å™¨ï¼ˆä¸‰ï¼‰ç»˜åˆ¶ç›´çº¿"},{"content":"æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç›®æ ‡å°±æ˜¯åˆ›å»ºä¸€ä¸ªçª—å£ï¼Œåˆ›å»ºçª—å£æœ‰å¾ˆå¤šåº“éƒ½èƒ½åšï¼Œå¦‚æœä½ ä¸æƒ³è¦ç”¨ä»»ä½•ç¬¬ä¸‰æ–¹åº“ä¹Ÿä¸éœ€è¦è·¨å¹³å°ï¼Œç”¨ Win32 API å°±å¯ä»¥åšï¼Œä¸è¿‡å¾®è½¯çš„åŒˆç‰™åˆ©å‘½åæ³•å®åœ¨æ˜¯æŠ½è±¡ï¼Œè¦æœ‰å¿ƒé‡Œå‡†å¤‡ã€‚\nSDL åº“ç®€ä»‹ SDL (Simple DirectMedia Layer) æ˜¯ä¸€ä¸ªå¼€æºã€è·¨å¹³å°ã€è½»é‡çº§çš„å¤šåª’ä½“å±‚ï¼Œä½œè€…ç›®å‰åœ¨ Valve ä»»èŒï¼Œä¹Ÿå°±æ˜¯å¤§å®¶æœ€å–œæ¬¢çš„ Steamï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šåªéœ€è¦ç”¨åˆ° SDL_Window å’Œ SDL_Surface å°±å¯ä»¥ã€‚\nè¿™é‡Œé»˜è®¤å¤§å®¶æ‹¥æœ‰ C++ å’Œ CMake åŸºç¡€ï¼Œä¸ä»‹ç»æ€ä¹ˆå®‰è£…è¿™ä¸ªåº“äº†ï¼Œç›´æ¥å¼€å§‹ã€‚\nåˆ›å»º Window 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 #define SDL_MAIN_HANDLED #include \u0026#34;SDL.h\u0026#34; int main(int argc, char* argv[]) { // å®šä¹‰çª—å£å¤§å° const int width = 640; const int height = 480; // SDL åˆå§‹åŒ– if (SDL_Init(SDL_INIT_EVENTS) \u0026lt; 0) { SDL_Log(\u0026#34;SDL init failed\u0026#34;); return 1; } // åˆ›å»º SDL çª—å£ SDL_Window* window = SDL_CreateWindow( \u0026#34;SoftRenderer\u0026#34;, SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, wWidth, wHeight, SDL_WINDOW_SHOWN); if (!window) { SDL_Log(\u0026#34;create window failed\u0026#34;); SDL_Quit(); return 1; } // ä¸€ç›´å¾ªç¯ï¼Œç›´åˆ°è§¦å‘äº† SDL_QUIT äº‹ä»¶ï¼ˆçª—å£è¢«å…³é—­ï¼‰ bool isQuit = false; SDL_Event event; while (!isQuit) { while (SDL_PollEvent(\u0026amp;event)) { if (event.type == SDL_QUIT) { isQuit = true; } } } // é‡Šæ”¾èµ„æº SDL_DestroyWindow(window); SDL_Quit(); return 0; } è¿™æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ SDL åˆ›å»ºçª—å£çš„ç¨‹åºã€‚\nSDL CPU æ¸²æŸ“ï¼šè·å–å’Œæ›´æ”¹ Surface ä» Window å¯ä»¥è·å–ä¸€ä¸ª Surfaceï¼Œå®ƒå’Œ Window çš„å¤§å°ç›¸åŒé«˜ï¼Œå¹¶ä¸”å®ƒé‡Œé¢æœ‰ä¸€ä¸ª pixels æŒ‡é’ˆï¼Œå¯ä»¥è®¿é—®æ¯ä¸€ä¸ªåƒç´ çš„æ•°æ®ã€‚\n1 2 3 4 5 6 7 8 9 10 while (!isQuit) { ... // è·å–çª—å£çš„ Surface SDL_Surface* surface = SDL_GetWindowSurface(window); // åƒç´ æ•°æ®åœ¨ surface-\u0026gt;pixels ä¸­ // æ›´æ”¹ Surface é¢œè‰² SDL_FillRect(surface, NULL, SDL_MapRGB(surface-\u0026gt;format, 0, 255, 0)); // æ›´æ–°çª—å£çš„ Surface SDL_UpdateWindowSurface(window); } ä» Window è·å–çš„ Surface çš„æ ¼å¼å¯èƒ½å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚\né»˜è®¤çš„ Window Surface æ¯ä¸€ä¸ªåƒç´ æ˜¯ 32 ä½ï¼Œä½†æ˜¯å®é™…ä¸Šç”¨çš„åªæœ‰ 24 ä½ï¼Œæˆ‘ä»¬å°±éœ€è¦ç»™æ¯ä¸ªåƒç´ å†™å…¥è¿™æ ·ï¼š\n1 0x00FF0000 // RGB çº¢è‰² å› ä¸ºè®¡ç®—æœºä¸­å­˜å‚¨é 2 çš„å¹‚æ¬¡å¤§å°çš„æ•°æ®ä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥ SDL è¿™é‡Œæ•°æ®æ˜¯ 32 ä½çš„ï¼Œå®é™…ä½¿ç”¨å´æ˜¯ 24 ä½ï¼Œå¤´ä¸¤ä½æ˜¯æ— æ„ä¹‰çš„ã€‚\næˆ‘ä»¬å¯èƒ½æ›´å¸Œæœ›ä½¿ç”¨ RGBA æ ¼å¼çš„æ•°æ®ï¼ŒRGBA åˆšå¥½å°±æ˜¯ 32 ä½ï¼š\n1 0xFF0000FF // RGBA çº¢è‰² è¿™ä¸ªæ—¶å€™æˆ‘å»ºè®®è‡ªå·±é¢å¤–å»ºä¸€ä¸ª Surfaceï¼Œæ¸²æŸ“å®Œä¹‹åå†æ›´æ–°ç»™ Window çš„ Surfaceã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 while (!isQuit) { ... // åˆ›å»º RGBA çš„ render surface SDL_Surface* render_surface = SDL_CreateRGBSurfaceWithFormat( 0, width, height, 32, SDL_PIXELFORMAT_RGBA8888); // æ¸²æŸ“ render surface SDL_FillRect(render_surface, NULL, SDL_MapRGBA(surface-\u0026gt;format, 0, 255, 0, 255)); // è·å– window surface SDL_Surface* window_surface = SDL_GetWindowSurface(window); // æ›´æ–° render surface åˆ° window surface SDL_BlitSurface(render_surface, NULL, window_surface, NULL); // æ›´æ–° window surface åˆ° screen SDL_UpdateWindowSurface(window); // é‡Šæ”¾ render surface SDL_FreeSurface(render_surface); } SDL GPU æ¸²æŸ“ï¼šRenderer å’Œ Texture è¿™ä¸€å°èŠ‚ä¸ºè¡¥å……å†…å®¹ï¼Œå¦‚æœç›®æ ‡æ˜¯åš CPU çš„è½¯æ¸²æŸ“å™¨ï¼Œä¸éœ€è¦äº†è§£ã€‚\nåœ¨ SDL ä¸­ï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å»åšæ¸²æŸ“å›¾å½¢ï¼Œä¸€ç§æ˜¯é€šè¿‡ SDL_Surfaceï¼Œå¦å¤–ä¸€ç§æ˜¯é€šè¿‡ SDL_Textureã€‚\nåŒºåˆ«åœ¨äº SDL_Surface æ˜¯åœ¨ CPU ä¸­ï¼Œè€Œ SDL_Texture åœ¨ GPU ä¸­ã€‚\nä½¿ç”¨ GPU æ¸²æŸ“å¿…é¡»è¦å…ˆåˆ›å»º Rendererï¼š\n1 2 3 4 5 6 SDL_Renderer* renderer = SDL_CreateRenderer(window, -1, 0); if (!renderer) { SDL_Log(\u0026#34;create renderer failed.\u0026#34;); SDL_Quit(); return 1; } è¿˜éœ€è¦åˆ›å»ºä¸€å¼  Textureï¼Œæˆ‘ä»¬ä¸ä¼šç›´æ¥ç»˜åˆ¶ Rendererï¼Œè€Œæ˜¯ç»˜åˆ¶åœ¨ Texture ä¸Šï¼Œåœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­ï¼Œè¿™ç§å›¾åƒç»˜åˆ¶åœ¨çº¹ç†ä¸Šè€Œä¸æ˜¯å±å¹•ä¸Šçš„æŠ€æœ¯å«åš Render Target Textureã€‚\n1 2 3 4 5 6 7 SDL_Texture* rtt = SDL_CreateTexture(app-\u0026gt;_renderer, SDL_PIXELFORMAT_RGBA8888, 0, width, height); if (!rtt) { SDL_Log(\u0026#34;create renderer target texture failed.\u0026#34;); SDL_Quit(); return 1; } æ¯å¸§è°ƒç”¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 while (!isQuit) { ... // è®¾ç½®é»˜è®¤èƒŒæ™¯é¢œè‰² SDL_SetRenderDrawColor(renderer, 0, 0, 0, 255); // æ¸…ç©ºå±å¹• SDL_RenderClear(renderer); // åˆ›å»ºä¸€ä¸ª Surface æ¥æ›´æ”¹åƒç´  SDL_Surface* surface = SDL_CreateRGBSurfaceWithFormat( 0, width, height, 32, SDL_PIXELFORMAT_RGBA8888); // æ¸²æŸ“ï¼Œæ›´æ”¹åƒç´  SDL_FillRect(surface, NULL, SDL_MapRGBA(surface-\u0026gt;format, 0, 255, 0, 255)); // æ›´æ–° Surface åˆ° Texture ä¸Š SDL_UpdateTexture(rtt, NULL, surface-\u0026gt;pixels, surface-\u0026gt;pitch); SDL_FreeSurface(surface); // è¦†ç›– Texture åˆ° Renderer é‡Œé¢ SDL_RenderCopy(renderer, rtt, NULL, NULL); // å‘é€æ•°æ®åˆ° GPU SDL_RenderPresent(renderer); } æ”¹å†™ C é£æ ¼çš„ä»£ç  SDL æ˜¯ä¸€ä¸ª C çš„åº“ï¼Œè€Œä¸æ˜¯ C++ï¼Œè¿™æ ·é£æ ¼çš„ä»£ç åœ¨ C++ ä¸­æ˜¯ä¸å®‰å…¨å’Œä¸ä¾¿åˆ©çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åšä¸€äº›æ”¹é€ ã€‚\nä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ SDL ä¸­æœ‰å¾ˆå¤šæˆå¯¹çš„æ¯”å¦‚ SDL_CreateWindow å’Œ SDL_DestroyWindow å‡½æ•°ã€‚å¦‚æœæˆ‘ä»¬èƒ½è‡ªåŠ¨é‡Šæ”¾å°±å¥½äº†ï¼Œå¯ä»¥ç”¨æ™ºèƒ½æŒ‡é’ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\nå°è¯•é‡å†™æ™ºèƒ½æŒ‡é’ˆçš„ Deleterï¼š\n1 2 3 4 struct SDL_Window_Deleter { void operator()(SDL_Window* window) const { SDL_DestroyWindow(window); } }; using Unique_SDL_Window_Ptr = std::unique_ptr\u0026lt;SDL_Window, SDL_Window_Deleter\u0026gt;; ä½¿ç”¨èµ·æ¥ä¹Ÿæ ¼å¤–æ–¹ä¾¿ï¼š\n1 2 3 Unique_SDL_Window_Ptr window = Unique_SDL_Window_Ptr(SDL_CreateWindow( \u0026#34;SoftRenderer\u0026#34;, SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, width, height, SDL_WINDOW_SHOWN | SDL_WINDOW_RESIZABLE)); å°è¯•è‡ªå·±å®ç° SDL_Surface çš„ Deleter\nä½¿ç”¨ Class å°è£… ä¹‹å‰çš„ SDL ä»£ç å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯åœ¨ while å¾ªç¯ä¹‹å‰çš„åˆå§‹åŒ–é˜¶æ®µï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯åœ¨ while å¾ªç¯å†…éƒ¨çš„æ¯å¸§æ‰§è¡Œé˜¶æ®µã€‚\n1 2 3 4 5 6 7 8 RenderApplication app(width, height); if (!app-\u0026gt;InitApplication()) { return 1; } while (app-\u0026gt;running) { app-\u0026gt;Tick(); } æœ€ç»ˆï¼ŒRenderApplication é•¿è¿™ä¸ªæ ·å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 class RenderApplication { public: int width, height; bool running; RenderApplication(int _width, int _height) : width(_width), height(_height), running(true) { renderer_ = std::make_unique\u0026lt;SoftRenderer::Renderer\u0026gt;( width, height, SoftRenderer::Color::Black()); } ~RenderApplication() { // è¿™é‡Œä¸éœ€è¦é‡Šæ”¾ï¼Œå› ä¸º window ä¼šé‡Šæ”¾å®ƒ window_surface_ = nullptr; SDL_Quit(); } bool InitApplication() { if (SDL_Init(SDL_INIT_EVENTS) \u0026lt; 0) { SDL_Log(\u0026#34;SDL init failed\u0026#34;); return false; } window_ = Unique_SDL_Window_Ptr(SDL_CreateWindow( \u0026#34;SoftRenderer\u0026#34;, SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, width, height, SDL_WINDOW_SHOWN | SDL_WINDOW_RESIZABLE)); if (!window_) { SDL_Log(\u0026#34;create window failed.\u0026#34;); SDL_Quit(); return false; } window_surface_ = SDL_GetWindowSurface(window_.get()); event_ = std::make_unique\u0026lt;SDL_Event\u0026gt;(); return true; } void Tick() { while (SDL_PollEvent(event_.get())) { if (event_-\u0026gt;type == SDL_QUIT) { running = false; return; } } // æ¸²æŸ“å‰çš„å‡†å¤‡ Unique_SDL_Surface_Ptr render_surface(SDL_CreateRGBSurfaceWithFormat( 0, width, height, 32, SDL_PIXELFORMAT_RGBA8888)); renderer_-\u0026gt;PrepareRender((Uint32*)render_surface-\u0026gt;pixels); // æ¸…ç©ºå±å¹• renderer_-\u0026gt;Clear(); // è‡ªå®šä¹‰æ¸²æŸ“å‡½æ•° render(); // æ›´æ–° renderer surface åˆ° window surface SDL_BlitSurface(render_surface.get(), NULL, window_surface_, NULL); // æ›´æ–° window surface åˆ° screen SDL_UpdateWindowSurface(window_.get()); // ä¿æŒç¨³å®šçš„å¸§æ•° SDL_Delay(1000 / 60); } virtual void render() {} protected: std::unique_ptr\u0026lt;SoftRenderer::Renderer\u0026gt; renderer_; Unique_SDL_Window_Ptr window_; SDL_Surface* window_surface_; std::unique_ptr\u0026lt;SDL_Event\u0026gt; event_; }; ","date":"2023-12-05T12:08:06+08:00","permalink":"https://nonlinearthink.github.io/p/%E7%BC%96%E5%86%99%E5%85%89%E6%A0%85%E5%8C%96%E6%B8%B2%E6%9F%93%E5%99%A8%E4%BA%8Csdl%E5%BA%93%E7%AE%80%E4%BB%8B/","title":"ç¼–å†™å…‰æ …åŒ–æ¸²æŸ“å™¨ï¼ˆäºŒï¼‰SDLåº“ç®€ä»‹"},{"content":"å…‰æ …åŒ– VS å…‰çº¿è¿½è¸ª å¯¹å›¾å½¢å­¦ç¨å¾®æœ‰äº†è§£çš„å°ä¼™ä¼´åº”è¯¥çŸ¥é“ï¼Œç°åœ¨çš„å®æ—¶æ¸²æŸ“é¢†åŸŸç”¨çš„ä¸»è¦éƒ½æ˜¯ Rasterization(å…‰æ …åŒ–)ï¼Œè€Œä¸æ˜¯ Ray Tracing(å…‰çº¿è¿½è¸ª)ï¼Œä¸»è¦åŸå› æ˜¯å®æ—¶æ¸²æŸ“éœ€è¦ä¿è¯å¸§æ•°ç¨³å®šåœ¨ 30 å¸§ä»¥ä¸Šï¼Œè€Œ Ray Tracing éœ€è¦éå¸¸åºå¤§çš„è®¡ç®—é‡ï¼Œå®Œå…¨ä¸æ˜¯å¤šå°‘ ms ä¹‹å†…èƒ½è®¡ç®—å®Œçš„ã€‚\nç­‰å®Œæˆ ç¼–å†™å…‰æ …åŒ–æ¸²æŸ“å™¨ è¿™ä¸ªç³»åˆ—ä¹‹åæœ‰ä¸€ä¸ªå…³äº Ray Tracing çš„æ–°ç³»åˆ—ã€‚\nå±å¹•ç”±ä¸€ä¸ªä¸€ä¸ªåƒç´ æ„æˆï¼Œæ¯ä¸€ä¸ªåƒç´ éƒ½å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå°ç½‘æ ¼ï¼ˆå®é™…ä¸Šä»ç‰©ç†ç»“æ„ä¸Šæ¥è®²å¹¶ä¸æ˜¯å®Œå…¨æ­£æ–¹å½¢çš„ï¼‰\né‚£ä¹ˆå¦‚æœè¦æ¸²æŸ“ä¸€ä¸ªåœºæ™¯ï¼Œåªéœ€è¦æŠŠæ¯ä¸€ä¸ªç½‘æ ¼å¡«ä¸Šé¢œè‰²å°±å¯ä»¥äº†ï¼Œå…‰æ …åŒ–å®é™…ä¸Šå°±æ˜¯åœ¨èŠæ€ä¹ˆå¡«é¢œè‰²è¿™ä»¶äº‹æƒ…ã€‚æ¯”å¦‚ä½ éœ€è¦å¯¹åœºæ™¯é‡Œçš„ç‰©ä½“è¿›è¡Œæ’åºï¼Œç¦»ç›¸æœºè¿‘çš„ç‰©ä½“è¡¨é¢é¢œè‰²å°±æ˜¯ä½ æƒ³è¦ç»˜åˆ¶çš„å›¾å½¢çš„é¢œè‰²ã€‚\nå…‰çº¿è¿½è¸ªæŠ€æœ¯åˆ™æ˜¯åŸºäºç‰©ç†ï¼Œä»ä¸€ä¸ªåƒç´ ç‚¹å‡ºå‘ï¼Œç»è¿‡å¤šæ¬¡åå°„ï¼Œå¾—åˆ°æœ€ç»ˆé¢œè‰²ï¼Œä½†æ˜¯ä¸€ä¸ªåƒç´ ä¸€æ¡å°„çº¿è¿œè¿œä¸å¤Ÿï¼Œå› ä¸ºè¿™æ ·è¯¯å·®ä¼šå¾ˆå¤§ï¼Œå¾€å¾€ä¸€ä¸ªåƒç´ éœ€è¦æ•°ç™¾æ¡å°„çº¿çš„ç»“æœæ±‚å¹³å‡ã€‚\nå…‰çº¿è¿½è¸ªçš„æœ¬è´¨å°±æ˜¯å¯¹åœºæ™¯ä¸æ–­è¿›è¡Œé‡‡æ ·ä»¥é™ä½å™ªç‚¹ï¼Œæœ€ç»ˆå¾—åˆ°æœ€æ¥è¿‘çœŸå®çš„å›¾åƒã€‚\nä»æ—¶é—´å¤æ‚åº¦æ¥è¯´ï¼Œå…‰æ …åŒ–æ— ç–‘æ¯”å…‰çº¿è¿½è¸ªæ¥å¾—æ›´åŠ å¥½ï¼Œä½†æ˜¯å› ä¸ºç¼ºå°‘ä¸¥è°¨çš„ç‰©ç†æ¨¡å‹ï¼Œå…‰æ …åŒ–çš„æ•ˆæœæ¯”å…‰çº¿è¿½è¸ªå·®å¾ˆå¤šï¼Œæ‰€ä»¥åœ¨å¯¹æ€§èƒ½è¦æ±‚ä¸é«˜ï¼Œä½†æ˜¯å¯¹æ•ˆæœè¦æ±‚é«˜çš„ç¦»çº¿æ¸²æŸ“ä¸­ï¼Œå…‰çº¿è¿½è¸ªè¢«æ™®éè¿ç”¨ã€‚\næˆªè‡³æ–‡ç« ç¼–å†™æ—¥æœŸï¼Œå·²ç»æœ‰æ¸¸æˆæ¯”å¦‚ èµ›åšæœ‹å…‹2077 2.0 è¿ç”¨äº† Path Tracing æŠ€æœ¯ï¼Œä¹Ÿå« Monte Calo Ray Tracingï¼Œæ¯”ä¼ ç»Ÿçš„ Whitted Style Ray Tracing æ€§èƒ½æ›´åŠ å¥½ï¼Œæ•ˆæœä¹Ÿæ›´æ£’ã€‚\nå…‰æ …åŒ–ç¨‹åºå¼€å‘æµç¨‹ åˆ›å»ºä¸€ä¸ªçª—å£ï¼Œå¹¶ç»˜åˆ¶ç›´çº¿ï¼Œä¸‰è§’å½¢ï¼Œå¸¦æœ‰é¡¶ç‚¹æ•°æ®çš„ç‰©ä½“ã€‚ æ–½å·¥ä¸­\u0026hellip;\nReference Fundamentals of Computer Graphics\n","date":"2023-12-02T14:15:23+08:00","permalink":"https://nonlinearthink.github.io/p/%E7%BC%96%E5%86%99%E5%85%89%E6%A0%85%E5%8C%96%E6%B8%B2%E6%9F%93%E5%99%A8%E4%B8%80%E6%A6%82%E8%BF%B0/","title":"ç¼–å†™å…‰æ …åŒ–æ¸²æŸ“å™¨ï¼ˆä¸€ï¼‰æ¦‚è¿°"},{"content":"æˆ‘æœ€è¿‘æƒ³è¦åšä¸€äº› C++ çš„é¡¹ç›®ï¼Œåœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œæˆ‘éœ€è¦å…ˆæ­å»ºç¯å¢ƒï¼Œä¹Ÿæ˜¯å¤§æ¦‚èŠ±äº†ä¸€ä¸ªæ™šä¸Šï¼Œç®€å•äº†è§£äº†ä¸€ä¸‹ç°åœ¨ C++ é¡¹ç›®éƒ½æ˜¯æ€ä¹ˆæ„å»ºçš„ã€‚\nç›®å‰æ¯”è¾ƒä¸»æµçš„ä¸¤ç§åŒ…ç®¡ç†å™¨ï¼šconan å’Œ vcpkgï¼Œæˆ‘éƒ½è¯•ç”¨äº†ä¸€ä¸‹ï¼Œä¸ªäººæ„Ÿè§‰ vcpkg çš„å…¼å®¹æ€§æ›´å¥½ä¸€äº›ï¼Œåº”è¯¥å¯ä»¥å¸®æˆ‘é¿ä¸å°‘å‘ï¼Œæ‰€ä»¥æœ€ç»ˆé€‰æ‹©äº†ä½¿ç”¨ Vcpkg+CMake+VSCode å»æ„å»ºæˆ‘çš„ç¼–ç¨‹ç¯å¢ƒã€‚\næˆ‘å‚è€ƒäº† VsCode+Vcpkg+MSVCâ€”â€”C++å¼€å‘ç¯å¢ƒé…ç½® è¿™ç¯‡æ–‡ç« ï¼Œä½†æ˜¯ä»–æœ‰äº›åœ°æ–¹çš„å‘æ²¡è®²æ˜ç™½ï¼Œæˆ‘é‡æ–°æ•´ç†å’Œå½’çº³ä¸€ä¸‹ã€‚\nå‡†å¤‡ C++ ç¼–è¯‘å™¨ Windows: Visual C++(ç›®å‰ä½¿ç”¨)ã€MinGW macOS: Clangã€GCC CMake Windows: Download | CMake macOS: brew install\u0026hellip; VSCode CMake Tools C/C++ vcpkg å®‰è£… å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ï¼švcpkg/README_zh_CN.md at master Â· microsoft/vcpkg Â· GitHub\né˜…è¯»å¿«é€Ÿå¼€å§‹çš„éƒ¨åˆ†ï¼ŒæŒ‰ç…§æŒ‡ä»¤ä¸€æ¡æ¡åšã€‚\nGit Clone ä¸ä¸‹æ¥ï¼Ÿ è¿ç”¨ç§‘æŠ€æ‰‹æ®µ å¯¼å…¥é¡¹ç›®åœ°å€åˆ° Gitee Github é•œåƒä¸‹è½½ç½‘ç«™ è¿è¡Œ bootstrap-vcpkg.bat æˆ–è€… bootstrap-vcpkg.sh å¡ä½å¹¶ä¸”æŠ¥é”™ï¼Ÿ è¿ç”¨ç§‘æŠ€æ‰‹æ®µ å»è¿™ä¸ªé¡µé¢ä¸‹è½½ vcpkg.exe: Releases Â· microsoft/vcpkg-tool (github.com)ï¼Œç„¶åæ‹·è´åˆ° Clone ä¸‹æ¥çš„ Git æ ¹ç›®å½• macOS åº”è¯¥æ˜¯ä¸‹è½½ vcpkg-macosï¼Œæˆ‘æ²¡è¯•è¿‡\né…ç½®ç¯å¢ƒå˜é‡ è¿™ä¸€æ­¥ç½‘ä¸Šå¾ˆå¤šäººæ²¡è®²ï¼Œç¯å¢ƒå˜é‡å¯ä»¥è®©åé¢è·¯å¾„çš„é…ç½®å’Œç»´æŠ¤æ–¹ä¾¿å¾ˆå¤šã€‚\né…ç½®ä¸€ä¸ªå« VCPKG_ROOT çš„å˜é‡ï¼Œå¾…ä¼šè¦ç”¨ï¼Œåœ°å€å°±æ˜¯åˆšæ‰ Clone çš„é‚£ä¸ª Git æ ¹ç›®å½•ã€‚\né…ç½®å®Œä¹‹åæ£€æŸ¥ä¸€ä¸‹ï¼š\n1 2 3 4 # powershell $env:VCPKG_ROOT # bash echo $VCPKG_ROOT å®‰è£…ä¾èµ– å®‰è£…ä¸€ä¸ªåº“ï¼š\n1 .\\vcpkg.exe install fmt:x86-windows å®‰è£…ä¾èµ–ä¸€èˆ¬å°±æ˜¯ [åº“å]:[ç¼–è¯‘ç›®æ ‡]ã€‚\nè¿™é‡Œè¡¥å……ä¸€ä¸ªé‡ç‚¹ï¼Œä¸€å®šè¦é€‰æ‹©å’Œè‡ªå·±çš„ç¼–è¯‘å™¨ä¸€æ ·çš„ç¼–è¯‘ç›®æ ‡ï¼Œæˆ‘ä¸€å¼€å§‹ç”¨äº† Visual C++ çš„ 64 ä½ç¼–è¯‘å™¨ï¼Œç»“æœåé¢ç¼–è¯‘çš„æ—¶å€™ä¸€ç›´å‡ºé—®é¢˜ï¼Œå› ä¸º x86-windows æ˜¯ 32 ä½çš„ã€‚\næ·»åŠ ä¾èµ–åˆ° CMake åˆ‡å›åˆ° CMake é¡¹ç›®ä¸­ã€‚\nåœ¨ CMakeLists.txt ä¸­åŠ å…¥ä¸¤æ¡æ–°çš„å‘½ä»¤ï¼Œfind_package å’Œ target_link_librariesï¼Œç¼–è¾‘å®Œä¹‹åå¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 project(TestVcpkg VERSION 0.1.0) ...... add_executable(TestVcpkg main.cpp) ...... find_package(fmt CONFIG REQUIRED) target_link_libraries(TestVcpkg PRIVATE fmt::fmt) target_link_libraries å¿…é¡»åœ¨ find_package å’Œ add_executable åé¢ã€‚\næµ‹è¯•ç¨‹åº å¼•å…¥å¹¶ä½¿ç”¨ä¸€ä¸‹ fmt åº“è¯•è¯•ã€‚\n1 2 3 4 5 6 #include \u0026#34;fmt/format.h\u0026#34; int main(int, char **) { fmt::print(\u0026#34;Hello, world!\\n\u0026#34;); } ç¼–è¯‘ åˆ›å»ºä¸€ä¸ª CMake é¡¹ç›®ï¼Œä¸çŸ¥é“æ€ä¹ˆåˆ›å»ºï¼Œå¯ä»¥å‚è€ƒåé¢çš„ VSCode éƒ¨åˆ†ã€‚\næ„å»ºé¡¹ç›®ï¼š\n1 2 3 4 # powershell cmake -B . -S build -DCMAKE_TOOLCHAIN_FILE=$env:VCPKG_ROOT/scripts/buildsystems/vcpkg.cmake # bash cmake -B . -S build -DCMAKE_TOOLCHAIN_FILE=$VCPKG_ROOT/scripts/buildsystems/vcpkg.cmake -B åé¢è·Ÿç€çš„æ˜¯ CMakeLists.txt çš„ä½ç½® -S åé¢è·Ÿç€çš„æ˜¯ç¼–è¯‘åˆ°é‚£ä¸ªä½ç½®ï¼Œä¸€èˆ¬éƒ½æ˜¯é¡¹ç›®ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª build ç›®å½• æœ€åè·Ÿç€çš„æ˜¯é…ç½® CMAKE_TOOLCHAIN_FILEï¼Œéœ€è¦ç”¨åˆ°ä¹‹å‰é…ç½®çš„ç¯å¢ƒå˜é‡ VCPKG_ROOTã€‚ ç¼–è¯‘é¡¹ç›®ï¼š\n1 cmake --build build è¿è¡Œ æ‰¾åˆ° build/Debug ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿è¡Œä¸€ä¸‹å°±è¡Œäº†ã€‚\næ¸…å•æ¨¡å¼ ä¸ä½¿ç”¨è¿™ä¸ªä¹Ÿèƒ½ç”¨ï¼Œä½†æ˜¯å¼ºçƒˆæ¨èä½¿ç”¨\nç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¾èµ–é…ç½®æ–‡ä»¶ï¼Œä¼šåœ¨ä½ è¿è¡Œ CMake çš„æ—¶å€™è‡ªåŠ¨å¸®ä½ å®‰è£…ä¾èµ–ã€‚\nåŠ¡å¿…è¦çœ‹ä¸€ä¸‹è¿™ä¸ªï¼š\nä½¿ç”¨æ¸…å•æ¨¡å¼å…¥é—¨ | Microsoft Learn\næ¸…å•æ¨¡å¼ | Microsoft Learn\nVSCode é…ç½® VSCode çš„ä¸»è¦ç›®çš„æ˜¯è‡ªåŠ¨åŒ–ä¸Šé¢çš„ä¸€äº›å‘½ä»¤ã€‚\nå»ºç«‹ Cmake é¡¹ç›® VSCode æ‰“å¼€ä¸€ä¸ªç©ºç›®å½•ï¼Œä½¿ç”¨ Ctrl+Shift+P|âŒ˜+â‡§+P æ‰“å¼€ Command Paletteï¼Œæ‰¾åˆ°å¹¶è¿è¡Œ CMake: Quick Startã€‚\nvcpkg åŠ å…¥ CMake è‡ªåŠ¨åŒ–ç¼–è¯‘æµç¨‹ VSCode ä¼šåœ¨ä½ æ›´æ–° CMakeLists.txt çš„æ—¶å€™å¸®ä½ è‡ªåŠ¨è¿è¡Œ CMake å‘½ä»¤ï¼Œä¸ºäº†åœ¨è¿è¡Œçš„æ—¶å€™åŠ å…¥ CMAKE_TOOLCHAIN_FILE çš„è®¾ç½®ï¼Œä½ éœ€è¦ç¼–è¾‘ settings.jsonï¼š\n1 2 3 4 5 6 { \u0026#34;cmake.configureSettings\u0026#34;: { \u0026#34;CMAKE_TOOLCHAIN_FILE\u0026#34;: \u0026#34;${env:VCPKG_ROOT}/scripts/buildsystems/vcpkg.cmake\u0026#34;, \u0026#34;VCPKG_TARGET_TRIPLET\u0026#34;: \u0026#34;x86-windows\u0026#34; }, } è¿™æ ·é…ç½®å®Œä¹‹åç›¸å½“äºåœ¨ cmake æ‰§è¡Œçš„æ—¶å€™åŠ å…¥äº†ï¼š\n1 -DCMAKE_TOOLCHAIN_FILE=$env:VCPKG_ROOT/scripts/buildsystems/vcpkg.cmake -DVCPKG_TARGET_TRIPLET=x86-windows è¿™é‡Œç”¨åˆ°çš„ ${env:VCPKG_ROOT} å°±æ˜¯ä¸Šé¢æåˆ°çš„ç¯å¢ƒå˜é‡ï¼Œè€Œç¼–è¯‘ç›®æ ‡ï¼Œå–å†³äºä½ ä½¿ç”¨çš„ç¼–è¯‘å™¨ã€‚\nå¯ä»¥åœ¨ .vscode æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª settings.jsonï¼Œè¿™æ ·å¯ä»¥ç»™æ¯ä¸ªé¡¹ç›®è‡ªå®šä¹‰ä½¿ç”¨ x64-windows è¿˜æ˜¯ x86-windows\nåˆ°è¿™ä¸€æ­¥ä¸ºæ­¢ï¼Œä¿å­˜åˆ·æ–°ä¸€ä¸‹ CMakeLists.txtï¼ŒVSCode åº”è¯¥æ²¡æœ‰æŠ¥é”™ï¼Œå¹¶ä¸”æˆåŠŸå¸®ä½ ç¼–è¯‘å¥½äº† CMakeï¼Œå¦‚æœæœ‰é—®é¢˜ï¼Œå»æ£€æŸ¥ä¸€ä¸‹ä¸Šé¢çš„æµç¨‹ï¼Œç‰¹åˆ«æ˜¯ vcpkg å®˜æ–¹æ–‡æ¡£çš„å†…å®¹æˆ‘æ²¡æ€ä¹ˆæï¼Œä»”ç»†æ£€æŸ¥ä¸€ä¸‹ã€‚\nè¯†åˆ«å’Œè·³è½¬ #include å¤´æ–‡ä»¶ é»˜è®¤æƒ…å†µä¸‹ï¼Œä»£ç ç¼–è¾‘å™¨ä¼šæœ‰ä¸€ä¸ªæŠ¥é”™ï¼Œ#include æ‰¾ä¸åˆ° vcpkg å®‰è£…çš„åº“ï¼Œä½†æ˜¯æ‰§è¡Œ Debug æˆ–è€… Run ä»»åŠ¡ï¼Œéƒ½æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚\nè¿™æ˜¯å› ä¸º VSCode æ²¡æœ‰åœ¨ vcpkg çš„ç›®å½•ä¸­æ‰¾å¤´æ–‡ä»¶ã€‚\nå†æ¬¡è¿è¡Œ Ctrl+Shift+P|âŒ˜+â‡§+P æ‰“å¼€ Command Paletteï¼Œæ‰¾åˆ°å¹¶ä½¿ç”¨ C/C++: Edit Configurations(JSON)ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ª .vscode æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰ä¸€ä¸ª c_cpp_properties.json æ–‡ä»¶ï¼Œç¼–è¾‘å…¶ä¸­çš„å†…å®¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 { \u0026#34;configurations\u0026#34;: [ { ...... \u0026#34;includePath\u0026#34;: [ \u0026#34;${workspaceFolder}/**\u0026#34;, \u0026#34;${env:VCPKG_ROOT}/installed/x64-windows/include\u0026#34;, \u0026#34;${env:VCPKG_ROOT}/installed/x86-windows/include\u0026#34; ], ...... } ], ...... } å¾ˆå¤šæ•™ç¨‹ä¼šåœ¨è¿™é‡Œå†™ä¸Šä¸€ä¸ª ${vcpkgRoot}/x64-windows/includeï¼Œå…¶å®è¿™ä¸ª ${vcpkgRoot} å°±æ˜¯æˆ‘ä»¬ä¸Šé¢é…ç½®çš„ ${env:VCPKG_ROOT} åŠ ä¸Š installedã€‚\n","date":"2023-04-15T02:48:00+08:00","permalink":"https://nonlinearthink.github.io/p/%E4%BD%BF%E7%94%A8-vcpkg-cmake-vscode-%E7%BC%96%E5%86%99%E4%BD%A0%E7%9A%84-c-%E9%A1%B9%E7%9B%AE/","title":"ä½¿ç”¨ vcpkg+CMake+VSCode ç¼–å†™ä½ çš„ C++ é¡¹ç›®"},{"content":"DDNS(Dynamic Domain Name Server)ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†ç”¨æˆ·çš„åŠ¨æ€IPç»‘å®šåˆ°ä¸€ä¸ªåŸŸåä¸Šå»ã€‚\nè¿™æ ·å°±ç®—ä½ çš„æœåŠ¡å™¨IPå‘ç”Ÿäº†å˜åŒ–ï¼Œç”¨æˆ·ä»ç„¶å¯ä»¥ä½¿ç”¨ä½ çš„åŸŸåæ‰¾åˆ°ä½ çš„æœåŠ¡å™¨ã€‚\né˜¿é‡Œäº‘æä¾›äº†ä¸€å¥—APIï¼Œå¯ä»¥è®©ä½ ç”¨ç¼–ç¨‹çš„æ–¹å¼å®ç° DDNSï¼Œä½†æ˜¯éœ€è¦ä½ çš„åŸŸåæ˜¯åœ¨é˜¿é‡Œäº‘ä¸Šç”³è¯·çš„ã€‚\næ„Ÿè°¢æˆ‘çš„å®¤å‹å€Ÿç”¨ç»™æˆ‘æµ‹è¯•ç”¨çš„åŸŸåã€‚\nä¸€äº›å¯èƒ½ç”¨åˆ°çš„åº“ 1 2 3 pip install aliyun-python-sdk-core pip install aliyun-python-sdk-alidns pip install pyyaml è·å–å’Œç¼“å­˜ IP åœ°å€ å…ˆå†™ä¸€ä¸ªç®€å•çš„å·¥å…·ç±»ï¼Œå¯ä»¥è·å–å½“å‰ç”µè„‘çš„ å…¬ç½‘IP åœ°å€ï¼Œæœ‰å¾ˆå¤šæä¾›è¿™ç±»æœåŠ¡çš„ç½‘ç«™ï¼Œæœ¬ä¾‹ç¨‹é‡‡ç”¨www.3322.org/dyndns/getipã€‚\nè·å– IP ä¹‹åæœ€å¥½å†æŠŠå®ƒç¼“å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚\nä¹‹æ‰€ä»¥éœ€è¦ç¼“å­˜æ˜¯å› ä¸ºé˜¿é‡Œäº‘æ›´æ–°ä¸¤æ¡ä¸€æ ·çš„IPæ—¶ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥æå‰ç¼“å­˜ï¼Œç„¶åä¸‹æ¬¡è°ƒç”¨æ›´æ–°æœåŠ¡ä¹‹å‰å€Ÿç”¨ç¼“å­˜çš„å†…å®¹ï¼Œåˆ¤æ–­å½“å‰çš„ IP æ˜¯å¦æ— å˜åŒ–ã€‚\nå®šä¹‰ IPManager ç±» å®šä¹‰ä¸€ä¸ª IPManager ç±»ï¼Œå¯ä»¥è·å–æœ¬æœºçš„ å…¬ç½‘IP åœ°å€ï¼Œå¹¶ä½¿ç”¨æ–‡ä»¶è¿›è¡Œç¼“å­˜ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 from urllib.request import urlopen import logging class IPManager: def __init__(self, file_cache=\u0026#34;.ipbuffer\u0026#34;): self.ip = \u0026#34;\u0026#34; self.file_cache = file_cache def get_current_ip(self): # è·å–å½“å‰çš„ IP with urlopen(\u0026#39;http://www.3322.org/dyndns/getip\u0026#39;) as response: self.ip = str(response.read(), encoding=\u0026#39;utf-8\u0026#39;).replace(\u0026#34;\\n\u0026#34;, \u0026#34;\u0026#34;) logging.info(\u0026#34;current ip: \u0026#34; + self.ip) return self.ip def sync_cache(self): # åŒæ­¥å½“å‰çš„ IP åˆ°ç¼“å­˜ with open(self.file_cache, \u0026#34;w\u0026#34;) as f: f.write(self.ip) logging.info(\u0026#34;sync cache ip: \u0026#34; + self.ip) def get_cache(self): # è·å–ç¼“å­˜çš„å†…å®¹ with open(self.file_cache, \u0026#34;r\u0026#34;) as f: old_ip = f.read() logging.info(\u0026#34;get cache ip: \u0026#34; + self.ip) return old_ip ç¨‹åºé»˜è®¤ä½¿ç”¨ .ipbuffer æ–‡ä»¶å­˜å‚¨ IPï¼Œæˆ‘è§‰å¾—æˆ‘ä»¬è¿˜éœ€è¦å…ˆåˆ›å»ºè¿™ä¸ªæ–‡ä»¶ï¼Œä¸ç„¶è¿è¡Œçš„æ—¶å€™å¯èƒ½ä¼šæŠ¥é”™ã€‚\nå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°æ£€æŸ¥å’Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ”¯æŒé€’å½’åˆ›å»º:\n1 2 3 4 5 6 7 8 9 10 11 12 import os def check_file(filename): # è·å–çˆ¶æ–‡ä»¶å¤¹ dirname = os.path.dirname(filename) if not os.path.exists(dirname) and dirname != \u0026#34;\u0026#34;: # é€’å½’åˆ›å»ºçˆ¶æ–‡ä»¶å¤¹ os.makedirs(dirname) # åˆ›å»ºæ–‡ä»¶ with open(filename, \u0026#34;w\u0026#34;) as f: f.write(\u0026#34;\u0026#34;) IPManager çš„ç®€å•ä½¿ç”¨ 1 2 3 4 5 6 7 8 9 10 def main(): # åˆ›å»ºä¸€ä¸ª IPManager ip_manager = IPManager() # è·å–å½“å‰çš„ IP current_ip = ip_manager.get_current_ip() # å¦‚æœ IP å·²ç»ç¼“å­˜å°±è¿”å› if ip_manager.get_cache() == current_ip: return # æ›´æ–° IP ç¼“å­˜ ip_manager.sync_cache() è¿™ä¸ªç¨‹åºå¯ä»¥ è·å–IP å¹¶ä¸”åœ¨ IPæ— ç¼“å­˜ æˆ–è€… IPæ›´æ–° çš„æ—¶å€™æ›´æ–°ç¼“å­˜ã€‚\nè·å– accessKeyId å’Œ accessKeySecret äº‘è´¦å·ç™»å½•RAMæ§åˆ¶å°ã€‚ åœ¨å·¦ä¾§å¯¼èˆªæ çš„äººå‘˜ç®¡ç†èœå•ä¸‹ï¼Œå•å‡»ç”¨æˆ·ã€‚ åœ¨ç”¨æˆ·ç™»å½•åç§°/æ˜¾ç¤ºåç§°åˆ—è¡¨ä¸‹ï¼Œå•å‡»ç›®æ ‡RAMç”¨æˆ·åç§°ã€‚ åœ¨ç”¨æˆ·AccessKeyåŒºåŸŸä¸‹ï¼Œå•å‡»åˆ›å»ºæ–°çš„AccessKeyã€‚ æ‘˜æŠ„è‡ª é˜¿é‡Œäº‘æ–‡æ¡£\nåˆ›å»ºè¿æ¥é˜¿é‡Œäº‘çš„å®¢æˆ·ç«¯ 1 2 3 4 5 6 7 8 from aliyunsdkcore.client import AcsClient profile = { \u0026#34;accessKeyId\u0026#34;: \u0026#34;xxx\u0026#34;, \u0026#34;accessKeySecret\u0026#34;: \u0026#34;xxx\u0026#34;, \u0026#34;regionId\u0026#34;: \u0026#34;cn-hangzhou\u0026#34; } client = AcsClient(profile[\u0026#34;accessKeyId\u0026#34;], profile[\u0026#34;accessKeySecret\u0026#34;], profile[\u0026#34;regionId\u0026#34;]) æŠŠä¸Šä¸€æ­¥çš„ accessKeyIdã€accessKeySecret å¡«è¿›å»ã€‚\nåœ¨ regionId å¡«å†™ä½ çš„åŒºåŸŸå·ï¼Œå…³äº regionId çš„è¯´æ˜ï¼Œå¯ä»¥è§ é˜¿é‡Œäº‘å®˜æ–¹æ–‡æ¡£ã€‚\næˆ‘ä»¬éœ€è¦å€ŸåŠ© client.do_action_with_exception è¿™ä¸ªå‡½æ•°æ¥å‘é€è¯·æ±‚åˆ°é˜¿é‡Œäº‘ã€‚\nåŸŸåè§£æè®°å½•æŸ¥è¯¢ ä¹‹æ‰€ä»¥éœ€è¦åŠ ä¸€æ­¥åŸŸåè§£æè®°å½•æŸ¥è¯¢æ˜¯ä¸ºäº†æ ¡éªŒæˆ‘ä»¬çš„åŸŸåæ˜¯å¦å·²ç»è¢«å…¶ä»–çš„ IP ç»‘å®šäº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 from aliyunsdkalidns.request.v20150109.DescribeDomainRecordsRequest import DescribeDomainRecordsRequest import json import logging def describe_domain_records(client, record_type, subdomain): logging.info(\u0026#34;åŸŸåè§£æè®°å½•æŸ¥è¯¢\u0026#34;) request = DescribeDomainRecordsRequest() request.set_accept_format(\u0026#39;json\u0026#39;) request.set_Type(record_type) request.set_DomainName(subdomain) response = client.do_action_with_exception(request) response = str(response, encoding=\u0026#39;utf-8\u0026#39;) result = json.loads(response) logging.debug(result) return result client æ˜¯ä¸Šä¸€æ­¥åˆ›å»ºçš„å®¢æˆ·ç«¯ã€‚\nrecord_type æ¯”è¾ƒå¤æ‚ï¼Œç®€å•æ¥è¯´æ˜¯ DNSåŸŸåè§£æ çš„è§£æç±»å‹ã€‚æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ Aè®°å½• å°±å¥½äº†ã€‚\n{% note info %}\nå¸¸è§çš„ DNSè§£æç±»å‹\nA: å°†ä¸»æœºå(æˆ–åŸŸå)æŒ‡å‘ä¸€ä¸ª IPv4 åœ°å€\nAAAA: å°†ä¸»æœºå(æˆ–åŸŸå)æŒ‡å‘ä¸€ä¸ª IPv6 åœ°å€\nCNAME: å°†åŸŸåæŒ‡å‘å¦ä¸€ä¸ªåŸŸå\n{% endnote %}\nsubdomain å¡«ä½ çš„åŸŸåå°±å¥½äº†ã€‚\n1 2 # è°ƒç”¨ä¸¾ä¾‹ describe_domain_records(client, \u0026#34;A\u0026#34;, \u0026#34;tuenity.xyz\u0026#34;) æ·»åŠ åŸŸåè§£æè®°å½• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 from aliyunsdkalidns.request.v20150109.AddDomainRecordRequest import AddDomainRecordRequest import logging import json def add_record(client, priority, ttl, record_type, value, rr, domain_name): logging.info(\u0026#34;æ·»åŠ åŸŸåè§£æè®°å½•\u0026#34;) request = AddDomainRecordRequest() request.set_accept_format(\u0026#39;json\u0026#39;) request.set_Priority(priority) request.set_TTL(ttl) request.set_Value(value) request.set_Type(record_type) request.set_RR(rr) request.set_DomainName(domain_name) response = client.do_action_with_exception(request) response = str(response, encoding=\u0026#39;utf-8\u0026#39;) result = json.loads(response) logging.debug(result) return result priority å‘Šè¯‰åŸŸåè§£ææœåŠ¡ï¼ŒæŒ‰ç…§ priority ä»å°åˆ°å¤§çš„é¡ºåºå¯¹è®°å½•æœç´¢ï¼Œæœç´¢åˆ°åŒ¹é…çš„è®°å½•åï¼Œå°±åœæ­¢æœç´¢ priority å€¼æ›´å¤§çš„è®°å½•ï¼Œå¯¹äºæ‹¥æœ‰ç›¸åŒ priority çš„è®°å½•å°†é€šè¿‡ weight å†æ¬¡é€‰æ‹© ã€‚\nè™½ç„¶é˜¿é‡Œäº‘å¹¶ä¸æä¾› weight çš„è®¾ç½®æ¥å£ï¼Œä½†æ˜¯ä½ è¦çŸ¥é“å®ƒæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ã€‚\nå¯¹äºæ‹¥æœ‰ç›¸åŒ priority çš„å¤šæ¡è®°å½•ï¼Œweight ç»™å‡ºäº†é€‰æ‹©æŸæ¡è®°å½•çš„å‡ ç‡ï¼Œå€¼è¶Šå¤§ï¼Œè¢«é€‰ä¸­çš„æ¦‚ç‡å°±è¶Šå¤§ï¼Œåˆç†çš„å–å€¼èŒƒå›´ä¸º 0-65535ã€‚\nttl( Time to live )ï¼Œå½“ç”¨æˆ·åœ¨è®¿é—®ä¸€ä¸ªåŸŸåçš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡éƒ½éœ€è¦å»è§£æä¸€éçš„ï¼ŒDNSæœåŠ¡å™¨ä¼šåœ¨ç”¨æˆ·å½“åœ°çš„é€’å½’DNSæœåŠ¡å™¨ä¸Šç¼“å­˜ä¸€æ¬¡ï¼Œåœ¨ ttl çš„æ—¶é—´é•¿åº¦å†…å¤±æ•ˆã€‚ä¸€èˆ¬è®¾ç½® \u0026ldquo;600\u0026rdquo;ã€‚\nrecord_type åŒä¸Šä¸€æ­¥ã€‚\nvalue å°±æ˜¯ä½ çš„ IPåœ°å€ã€‚\nrrï¼Œé˜¿é‡Œäº‘çš„ rr æ˜¯ä¸»æœºå¤´çš„æ„æ€ï¼Œä¸€èˆ¬è®¾ç½® \u0026ldquo;www\u0026rdquo;ã€‚\ndomain_name å°±æ˜¯ä½ çš„åŸŸåã€‚\næ›´æ–°åŸŸåè§£æè®°å½• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 from aliyunsdkalidns.request.v20150109.UpdateDomainRecordRequest import UpdateDomainRecordRequest import logging import json def update_record(client, priority, ttl, record_type, value, rr, record_id): logging.info(\u0026#34;æ›´æ–°åŸŸåè§£æè®°å½•\u0026#34;) request = UpdateDomainRecordRequest() request.set_accept_format(\u0026#39;json\u0026#39;) request.set_Priority(priority) request.set_TTL(ttl) request.set_Value(value) request.set_Type(record_type) request.set_RR(rr) request.set_RecordId(record_id) response = client.do_action_with_exception(request) response = str(response, encoding=\u0026#39;utf-8\u0026#39;) logging.debug(response) return response å’Œä¸Šä¸€æ­¥çš„å‡½æ•°æ¥å£å‡ ä¹ä¸€æ‘¸ä¸€æ ·ï¼Œä¸è¿‡å¤šè§£é‡Šäº†ã€‚\néœ€è¦æ³¨æ„ï¼Œä¸ä¸€æ ·çš„æ˜¯ record_idã€‚è¿™ä¸ªéœ€è¦ describe_domain_records å‡½æ•°çš„è¿”å›å€¼ã€‚\n1 des_result = describe_domain_records(client, \u0026#34;A\u0026#34;, \u0026#34;tuenity.xyz\u0026#34;) ä½¿ç”¨ des_result[\u0026quot;TotalCount\u0026quot;] å°±å¯ä»¥æŸ¥å¤„ç°åœ¨æœ‰å¤šå°‘æ¡è®°å½•ç»‘å®šåœ¨è¿™ä¸ªåŸŸåä¸Šäº†ã€‚\nå¦‚æœæ²¡æœ‰ï¼Œæˆ‘ä»¬å°±éœ€è¦è°ƒç”¨ add_record ï¼Œå¦åˆ™å°±è°ƒç”¨ update_recordã€‚\nrecord_id å¯ä»¥é€šè¿‡ des_result[\u0026quot;DomainRecords\u0026quot;][\u0026quot;Record\u0026quot;][0][\u0026quot;RecordId\u0026quot;] è·å–ã€‚\næ”¹é€ ã€å°è£…å»ºè®® ä½¿ç”¨ yaml æ¥ä½œä¸ºé…ç½®æ–‡ä»¶ ä½¿ç”¨ python è‡ªå¸¦çš„æ—¥å¿— logging æŠŠæŸ¥è¯¢ã€æ›´æ–°ã€æ·»åŠ åŸŸåè§£æè®°å½•å°è£…æˆä¸€ä¸ªç±» è·å–å®Œæ•´çš„ä»£ç  Github é¡¹ç›®åœ°å€\n","date":"2020-10-25T12:08:06+08:00","permalink":"https://nonlinearthink.github.io/p/python-%E5%AE%9E%E7%8E%B0%E9%98%BF%E9%87%8C%E4%BA%91-ddns-%E5%8A%A8%E6%80%81%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/","title":"Python å®ç°é˜¿é‡Œäº‘ DDNS åŠ¨æ€åŸŸåè§£æ"},{"content":"åƒç´ æ€ç»´ è¿™ä¸€å°èŠ‚ï¼Œæˆ‘ä»¬å°†ä»‹ç» px(Pixel)ã€‚\né€»è¾‘åƒç´ è€Œä¸æ˜¯ç‰©ç†åƒç´  px ä»å­—é¢ä¸Šæ¥çœ‹æ˜¯åƒç´ çš„æ„æ€ï¼Œå¾ˆå¤šæ–°æ‰‹ä¸€ä¸Šæ¥å¯èƒ½ä¼šè®¤ä¸ºå®ƒçš„ç‰©ç†åƒç´ ã€‚\nè¿™é‡Œå¿…é¡»è¦æ¾„æ¸…ï¼Œpxä¸€èˆ¬æ˜¯æŒ‡é€»è¾‘åƒç´ ï¼Œå®ƒä¼šæ ¹æ®æµè§ˆå™¨ã€æ“ä½œç³»ç»Ÿã€ç¡¬ä»¶è®¾å¤‡åšé€‚å½“çš„ç¼©æ”¾ã€‚\nä½†æ˜¯ï¼Œé€šå¸¸96pxå¯¹åº”äº†ä¸€ä¸ªç‰©ç†è‹±å¯¸ã€‚\nåƒç´ çº§çš„å®Œç¾ä¸å“åº”å¼å¸ƒå±€ æœ€å¼€å§‹ï¼Œpx è¢«è®¾è®¡å‡ºæ¥çš„æ—¶å€™æ‰€å¥‰è¡Œçš„å“²å­¦å°±æ˜¯æä¾›åƒç´ çº§åˆ«çš„å®Œç¾ã€‚\næ—©æœŸçš„ç½‘é¡µè®¾è®¡è€…ä¼šåœ¨ä¸€ä¸ªå›ºå®šå¤§å°çš„é¡µé¢ä¸­è®¾è®¡ç½‘é¡µï¼Œä¸€èˆ¬æ˜¯ 800pxï¼Œä½ çš„æµè§ˆå™¨å¦‚æœè¶…è¿‡æ¥è¿™ä¸ªå°ºå¯¸ï¼Œå¿…é¡»ç”¨æ°´å¹³æˆ–è€…ä¸Šä¸‹æ»šè½®æ¥æµè§ˆã€‚æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä»¥åƒç´ ä¸ºå•ä½ï¼Œè¢«ç²¾ç¡®å’Œå·§å¦™åœ°å®‰æ’åœ¨è¿™ä¸ªé¡µé¢ä¸­ã€‚\néšç€é«˜æ¸…æ˜¾ç¤ºå±çš„å‡ºç°ï¼Œäººä»¬å¼€å§‹è€ƒè™‘æŠŠç½‘é¡µè°ƒå¤§åˆ° 1024pxï¼Œç”šè‡³æ˜¯ 1280pxï¼Œ\nè®¾å¤‡çš„ç§ç±»è¶Šæ¥è¶Šå¤šï¼Œå°ºå¯¸ã€åƒç´ ç­‰ç­‰éƒ½éš¾ä»¥å…¼å®¹ã€‚\nå“åº”å¼å¸ƒå±€æ˜¯ä¸€ç§èƒ½æ ¹æ®å±å¹•çš„å¤§å°åŠ¨æ€è°ƒæ•´çš„å¸ƒå±€æ–¹å¼ï¼Œå¦‚ä»Šå¤§éƒ¨åˆ†ç½‘é¡µéƒ½æ˜¯å“åº”å¼çš„ï¼Œä½ å‡ ä¹çœ‹ä¸åˆ°éå“åº”å¼çš„ç½‘é¡µäº†ï¼Œè®°å¾—æˆ‘å°æ—¶å€™å†²æµªå°±ç»å¸¸é‡åˆ°é‚£ç§ç½‘é¡µå¤§å°ä¸å…¼å®¹çš„ã€‚\nç›¸å¯¹å­—å·çš„å¤§å°å•ä½ em æ˜¯ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„å±æ€§ã€‚å®ƒæ˜¯ä¸€ä¸ªç›¸å¯¹é•¿åº¦å•ä½ï¼Œç›¸å¯¹äºå½“å‰å…ƒç´ çš„å­—å·ï¼Œä¹Ÿå°±æ˜¯ç›¸å¯¹äº font-size çš„å¤§å°ã€‚\nè®¡ç®—æ–¹æ³• ä¾‹å¦‚ï¼Œå‡è®¾å·²å®šä¹‰å½“å‰çš„ font-size çš„å¤§å°ä¸º 16px ï¼Œpadding çš„å¤§å°ä¸º 1.2em ï¼Œåˆ™ padding çš„å®é™…å¤§å°æ˜¯å¤šå°‘ px?\n1 2 3 4 .default { font-size: 16px; padding: 1.2em; } è¿™æ˜¯ä¸€é“ç®€å•çš„è®¡ç®—é¢˜ï¼Œpadding çš„å®é™…å¤§å°åº”è¯¥æ˜¯ $16\\times1.2=19.2(px)$ã€‚\nå­—ä½“å¤§å°ç›¸å¯¹äºå­—ä½“çš„å¤§å° è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼Œæ—¢ç„¶ em æ˜¯ç›¸å¯¹äºå­—ä½“çš„å¤§å°å•ä½ï¼Œé‚£ä¹ˆå¦‚æœ å­—ä½“font-size çš„å¤§å°å•ä½ä¹Ÿæ˜¯ em ä¼šå‘ç”Ÿä»€ä¹ˆ?\nè¿™ç§æƒ…å†µä¸‹ï¼Œå‚ç…§å¯¹è±¡ä¸å†æ˜¯å…ƒç´ è‡ªèº«ï¼Œè€Œæ˜¯çˆ¶å…ƒç´ ã€‚\n1 2 3 \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;subcontainer\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; 1 2 3 4 5 6 7 .container { font-size: 16px; } .subcontainer { font-size: 2em; } å‡å¦‚çˆ¶å…ƒç´ çš„ font-size æ˜¯ 16pxï¼Œå­å…ƒç´ çš„ font-size ä¸º 2emï¼Œåˆ™å­å…ƒç´ çš„å®é™… font-size åº”è¯¥ä¸º 32pxã€‚\nå¦‚æœçˆ¶å…ƒç´ æ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œåˆ™ä¼šä¸€ç›´æ²¿ç€ DOMæ ‘ å‘ä¸Šï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå®šä¹‰çš„å­—ä½“å¤§å°ä¸ºæ­¢ï¼Œä½ å§‹ç»ˆå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå®šä¹‰çš„å­—ä½“å¤§å°ï¼Œå› ä¸ºæµè§ˆå™¨ä¼šç»™æ ¹å…ƒç´ è®¾ç½®ä¸€ä¸ªé»˜è®¤çš„å›ºå®šçš„å­—ä½“å¤§å°ã€‚\næµè§ˆå™¨é»˜è®¤å­—å· å¯¹æ¯ä¸€ä¸ªç½‘é¡µçš„æ ¹èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ ä¼ªç±»é€‰æ‹©å™¨:root æ¥è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ html æ¥è¡¨ç¤ºã€‚\nå¤§å¤šæ•°æµè§ˆå™¨éƒ½å®šä¹‰äº†è¿™ä¸ªæ ¹å…ƒç´ çš„é»˜è®¤ font-size ä¸º 16pxã€‚\n1 2 3 :root { font-size: 16px; } å­—ä½“ç¼©å°é—®é¢˜ å…³äº font-size ä½¿ç”¨ em ï¼Œä½ åº”å½“å°½é‡é¿å…ä½¿ç”¨ï¼Œè¿™ä¼šé€ æˆä¸€ä¸ªé—®é¢˜ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„ä¾‹å­ã€‚\nå…ˆåšä¸€ä¸ªæ— åºåˆ—è¡¨å‡ºæ¥:\n1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt; Top level \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt; Second level \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt; Third level \u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; è®¾ç½®æ— åºåˆ—è¡¨çš„å­—ä½“ä¸º 0.8emï¼Œæ ¹æ®è®¡ç®—ï¼Œæ— åºåˆ—è¡¨é‡Œé¢çš„å­—ä½“å¤§å°åº”è¯¥æ˜¯ 12.8pxã€‚\n1 2 3 ul { font-size: .8em; } æ•ˆæœ:\nä¸ºä»€ä¹ˆå­—ä½“è¶Šæ¥è¶Šå°äº†ï¼Ÿ\næˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œæ ¹å…ƒç´ çš„å­—ä½“å¤§å°æ˜¯ 16pxï¼Œæ‰€ä»¥ç¬¬ä¸€çº§æ— åºåˆ—è¡¨æ˜¯ 12.8px æ²¡é—®é¢˜ï¼Œä½†æ˜¯ç¬¬äºŒçº§æ— åºåˆ—è¡¨çš„çˆ¶å…ƒç´ æ˜¯ç¬¬ä¸€çº§æ— åºåˆ—è¡¨ï¼Œæ‰€ä»¥å®ƒçš„å­—ä½“å¤§å°å˜æˆäº† $12.8\\times0.8=10.24(px)$ ã€‚ç¬¬ä¸‰ææ— åºåˆ—è¡¨çš„å­—ä½“å¤§å°: $10.24\\times0.8=8.192(px)$ã€‚\nå­—ä½“éšç€å±‚çº§è¶Šæ¥è¶Šå¤šï¼Œå˜å¾—è¶Šæ¥è¶Šå¤±æ§ã€‚\næ­£å¼å› ä¸ºå¦‚æ­¤ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸æ¨èä½¿ç”¨ em æ¥å®šä¹‰å­—ä½“å¤§å°ï¼Œå¦‚æœä½ ä¸€ä¸å°å¿ƒï¼Œå°±å¯èƒ½é€ æˆè¿™ç§æ‚²å‰§ã€‚\nç›¸å¯¹æ ¹å…ƒç´ å­—å·çš„å¤§å°å•ä½ æ ¹å…ƒç´ ä¼ªç±»é€‰æ‹©å™¨ ä¼ªç±»é€‰æ‹©å™¨:rootï¼Œåœ¨ HTML ä¸­å¯¹åº”çš„æ˜¯ html æ ‡ç­¾ã€‚\nè®¾ç½®é»˜è®¤å­—å· ä»¥å‰ï¼Œç½‘é¡µè®¾è®¡è€…ä»¬ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œå¾ˆå–œæ¬¢åˆ©ç”¨è¿™ä¸ªä¼ªç±»é€‰æ‹©å™¨è¿™æ ·å†™:\n1 2 3 :root { font-size: .875em; } è¿™æ˜¯å› ä¸º $16\\times0.875=10(px)$ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æŠŠæ ¹å…ƒç´ å­—å·å®šä¹‰ä¸º 10px åï¼Œæ¥ä¸‹æ¥ï¼ŒåŸºäºæ ¹å…ƒç´ çš„å­—å·è®¡ç®—å¯ä»¥å˜å¾—ç®€å•ä¸€äº›ã€‚\nè‡ªå®šä¹‰å±æ€§ è¿™æ˜¯ CSS3 éå¸¸é‡è¦çš„ä¸€ä¸ªç‰¹æ€§ï¼Œä¸è¿‡å¤§å¤šæ•°äººéƒ½ä¼šå¿½ç•¥ï¼Œäº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¹ æƒ¯äº†ä½¿ç”¨ SASS/Scssã€Less ç­‰ç­‰CSSé¢„å¤„ç†å™¨ä¹‹åï¼Œè¿™ä¸ªç‰¹æ€§å·²ç»æ¯”è¾ƒé¸¡è‚‹äº†ã€‚\n1 2 3 4 5 6 7 8 9 :root { --main-font: Helvetica, Arial, sans-serif; --brand-color: #369; } p { font-family: var(--main-font); color: var(--brand-color) } å¦‚æœ var() å‡½æ•°è®¡ç®—å‡ºæ¥çš„æ˜¯ä¸€ä¸ªéæ³•å€¼ï¼Œä¼šè®¾ç½®æˆå¯¹åº”å±æ€§çš„åˆå§‹å€¼ã€‚\nrem-ä½å¤æ‚åº¦çš„em rem æ˜¯ root rm çš„ç¼©å†™ï¼Œå‰é¢å·²ç»ä»‹ç»è¿‡ ï¼Œrem æ˜¯ç›¸å¯¹äºæ ¹å…ƒç´ çš„å­—å·å¤§å°ï¼Œæ ¹å…ƒç´ ä¹Ÿå°±æ˜¯ :rootï¼Œæˆ–è€…è¯´æ˜¯ htmlã€‚\n1 2 3 4 5 6 7 :root { font-size: 16px; } ul { font-size: .8rem; } ul çš„ font-size å¤§å°ç»è¿‡è®¡ç®—æ˜¯ 12.8pxã€‚\nè¿™ä¸ª css ä»£ç å¯ä»¥è§£å†³ä¸Šé¢æˆ‘ä»¬çš„å­—ä½“ç¼©å°é—®é¢˜ã€‚\nå› ä¸º rem æ˜¯ç›¸å¯¹äºæ ¹å…ƒç´ å­—ä½“çš„å¤§å°ï¼Œå°±ä¸ä¼šå¼•èµ·å› ä¸ºçˆ¶å­å…ƒç´ åµŒå¥—è€Œé€ æˆçš„é€’æ¨ç¼©å°ç°è±¡ã€‚\næ•…æ­¤ï¼Œrem å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ç§ä½å¤æ‚åº¦çš„ em ã€‚\nç›¸å¯¹è§†å›¾çª—å£çš„å¤§å°å•ä½ è§†å›¾çª—å£æŒ‡çš„æ˜¯æµè§ˆå™¨è§†å›¾çš„å¤§å°ï¼Œåœ¨æ¡Œé¢ç«¯çš„æµè§ˆå™¨ä¸­ï¼Œä½ å¯ä»¥éšæ„æ‹–åŠ¨é¼ æ ‡æ¥è°ƒèŠ‚è¿™ä¸ªçª—å£çš„å¤§å°ã€‚\nä¸»è¦æ¶‰åŠçš„å…ƒç´ æ˜¯ vh å’Œ vwï¼Œå¾ˆæ˜¾ç„¶ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ visual hight å’Œ visual width çš„ç¼©å†™ã€‚\nå•ä½ ä½œç”¨ å¤‡æ³¨ vh è§†å›¾çª—å£é«˜åº¦çš„$\\frac{1}{100}$ vw è§†å›¾çª—å£å®½åº¦çš„$\\frac{1}{100}$ vmin è§†å›¾çª—å£é«˜åº¦ã€å®½åº¦ä¸­è¾ƒå°ä¸€æ–¹çš„$\\frac{1}{100}$ éƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒ vmax è§†å›¾çª—å£é«˜åº¦ã€å®½åº¦ä¸­è¾ƒå¤§ä¸€æ–¹çš„$\\frac{1}{100}$ éƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒ ä½ å¯ä»¥è®¤ä¸ºè¿™äº›æ˜¯ç™¾åˆ†æ¯”å•ä½ï¼Œä»–ä»¬çš„åŸå­å•ä½éƒ½æ˜¯ 1%ã€‚\nä½¿ç”¨ vh å’Œ vw å®šä¹‰å­—å· 1 2 3 :root { font-size: 2vw; } å‡è®¾è¿™æ˜¯åœ¨ä¸€ä¸ª 1200px çš„æ˜¾ç¤ºå±ä¸Šï¼Œå­—ä½“çš„å¤§å°ç»è¿‡è®¡ç®—æ˜¯ 24pxã€‚\nè€Œåœ¨ä¸€ä¸ª 768px çš„æ˜¾ç¤ºå±ä¸Šï¼Œè®¡ç®—å€¼æ˜¯ 15pxã€‚\nè¿™å®åœ¨æ˜¯å¤ªæ£’äº†ï¼Œè¿™æ˜¯åŠ¨æ€å¯è°ƒèŠ‚çš„å­—å·ã€‚\nä½†æ˜¯ï¼Œå¦‚æœä½ æŠŠæµè§ˆå™¨çš„å®½åº¦æ”¾åˆ°å¾ˆå°ï¼Œè¿™å¤ªç³Ÿç³•äº†ï¼Œæœ‰æ²¡æœ‰å¯èƒ½è®¾ç½®ä¸€ä¸ªæœ€å°å€¼å’Œæœ€å¤§å€¼æ¥é™åˆ¶è¿™ç§ç°è±¡ï¼Ÿ\nä½¿ç”¨ calc() å‡½æ•° 1 2 3 :root { font-size: calc(0.5em + 1vw); } è¿™ä¸ªè®¾è®¡çš„å·§å¦™ä¹‹å¤„åœ¨äºï¼Œå½“ä½ ç¼©å°åˆ°ä¸€å®šç¨‹åº¦ï¼Œ1vw çš„è®¡ç®—å€¼å‡ ä¹ä¸å¯è§çš„æ—¶å€™ï¼Œ0.5em ä¾ç„¶å¯ä»¥ä¿è¯å®ƒè‡³å°‘æœ‰ 8px çš„å¤§å°ï¼Œä¸è‡³äºå°åˆ°çœ‹ä¸è§ã€‚\nå“åº”å¼å¸ƒå±€å…¥é—¨ å“åº”å¼å¸ƒå±€çš„ç²¾é«“æ˜¯å¯¹ä¸åŒå±å¹•çš„é€‚é…ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åª’ä½“æŸ¥è¯¢æ¥å®šä¹‰ä¸åŒå±å¹•ä¸‹çš„å·®å¼‚ã€‚\nåª’ä½“æŸ¥è¯¢åº”å½“è§„å®šä¸€äº›å›ºå®šçš„å€¼ï¼Œä½œä¸ºåé¢æ‰€æœ‰å…ƒç´ çš„å‚ç…§ï¼Œåé¢æ‰€æœ‰çš„å…ƒç´ éƒ½åº”è¯¥ä½¿ç”¨ç›¸å¯¹å•ä½ï¼Œé™¤äº†ä¸€äº›çº¿æ¡å¯ä»¥ä½¿ç”¨ pxï¼Œå…¶ä»–ä¸€å¾‹ä¸å»ºè®®ä½¿ç”¨ã€‚\nè¿™é‡Œåªç®€å•è°ˆä¸€äº›åšä¸»çš„ç»éªŒï¼Œå…·ä½“è¿˜è¦é ä½ ä»¬å®è·µã€‚\nåª’ä½“æŸ¥è¯¢ åœ¨ CSS ä¸­ï¼Œä¹Ÿå« @meida è§„åˆ™ï¼Œå®ƒå¯ä»¥æŒ‡å®šæŸç§å±å¹•å°ºå¯¸æˆ–è€…åª’ä½“ç±»å‹ä¸‹çš„æ ·å¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 :root { font-size: 0.75em; } @media (min-width: 800px) { :root { font-size: 0.875em; } } @media (min-width: 1200px) { :root { font-size: 1em; } } åœ¨å®½åº¦å°äº 800px å±å¹•ä¸‹ï¼Œæ ¹å…ƒç´  font-size çš„è®¡ç®—å€¼æ˜¯ 12pxï¼›\nåœ¨å®½åº¦å¤§äº 800pxï¼Œä½†æ˜¯å°äº 1200px çš„å±å¹•ä¸‹ï¼Œæ ¹å…ƒç´  font-size çš„è®¡ç®—å€¼æ˜¯ 14pxï¼›\nåœ¨å®½åº¦å¤§äº 1200px å±å¹•ä¸‹ï¼Œæ ¹å…ƒç´  font-size çš„è®¡ç®—å€¼æ˜¯ 16pxï¼›\né€šè¿‡åª’ä½“æŸ¥è¯¢ï¼Œåšåˆ°äº†ä¸åŒå±å¹•çš„é€‚é…ã€‚\nä½¿ç”¨å¤§å°å•ä½çš„å»ºè®® ä¸ºäº†é˜²æ­¢å¸ƒå±€çš„ä¸å¯è°ƒæ•´ï¼Œæˆ‘ä»¬æœ‰ä¸€äº›ä¸€èˆ¬æ€§çš„ç»“è®ºï¼Œæ¥ä½¿ç”¨ CSS æä¾›çš„å„ç§å•ä½ã€‚\nä½¿ç”¨ px å®šä¹‰çº¿ 1 2 3 .default { border: 1px soild #999; } ä½¿ç”¨ em å®šä¹‰é—´è· 1 2 3 .default { padding: 1em; } ä½¿ç”¨ rem å®šä¹‰å­—å· 1 2 3 .default { font-size: 1rem; } ä½¿ç”¨ vh å’Œ vw å®šä¹‰å®¹å™¨ 1 2 3 4 .default { height: 50vh; weight: 50vw; } ","date":"2020-07-08T14:49:49+08:00","permalink":"https://nonlinearthink.github.io/p/css-%E5%83%8F%E7%B4%A0%E5%92%8C%E5%8D%95%E4%BD%8D%E8%AE%A1%E7%AE%97/","title":"CSS åƒç´ å’Œå•ä½è®¡ç®—"},{"content":"box-shadow æ¦‚è¿° å…ˆä»æ•´ä½“æ¥è¯´è¯´ box-shadow å±æ€§ ã€‚\nbox-shadow æ”¯æŒå®šä¹‰å¤šä¸ªé˜´å½±ï¼Œä»–ä»¬åº”è¯¥ä½¿ç”¨é€—å·åˆ†å‰²:\n1 box-shadow: 3px 3px red, -1em 0 0.4em olive; è¿™é‡Œå®šä¹‰äº†ä¸¤ä¸ªé˜´å½±ï¼Œåˆ†åˆ«æ˜¯ 3px 3px redã€-1em 0 0.4em oliveã€‚\nå…¶ä¸­ï¼Œæ¯ä¸ªé˜´å½±æ”¯æŒæœ€å¤š6ä¸ªå­—æ®µ:\ninset\nå¯é€‰çš„å­—æ®µï¼Œé»˜è®¤ä¸æŒ‡å®šã€‚\næŒ‡å®šinsetï¼Œé˜´å½±å‘å†…æ‰©æ•£ï¼Œå¦åˆ™é˜´å½±å‘å¤–æ‰©æ•£ã€‚\noffset-x å’Œ offset-y\nç”¨æ¥è®¾ç½®é˜´å½±åç§»é‡ï¼Œåˆ†ä¸º xæ–¹å‘ å’Œ yæ–¹å‘ã€‚å£°æ˜çš„æ—¶å€™ï¼Œxæ–¹å‘ åœ¨å‰ï¼Œyæ–¹å‘ åœ¨åã€‚\nè¿™ä¸ªå®šä¹‰çš„é¡ºåºæ˜¯æœ‰è®²ç©¶çš„ï¼ŒCSS çš„åç§»é‡‡ç”¨çš„æ˜¯æˆ‘ä»¬å¹³æ—¶å®šä¹‰åæ ‡è½´çš„ä¹ æƒ¯ï¼ŒæŒ‰ç…§ (x,y) çš„é¡ºåºï¼Œè¿™ä¸ªè§„åˆ™ä¸ä»…ä»…é€‚ç”¨äºæˆ‘ä»¬ä»Šå¤©çš„ä¸»è§’ box-shadow ï¼Œè€Œä¸”åŸºæœ¬ä¸Šå’Œ\u0026quot;ä½ç§»\u0026quot;ã€\u0026ldquo;åç§»\u0026quot;æœ‰å…³çš„å±æ€§éƒ½é€‚ç”¨ã€‚\nå¦‚æœä¸¤è€…éƒ½æ˜¯0ï¼Œé‚£ä¹ˆé˜´å½±ä¸åšåç§»ï¼Œä½äºå…ƒç´ æ­£åæ–¹ã€‚\nblur-radius\nä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé˜´å½±æ˜¯çº¯è‰²çš„ï¼Œæ²¡æœ‰æ¸å˜åŒºåŸŸã€‚\nä½†æ˜¯å¦‚æœè®¾ç½®äº†æ¨¡ç³ŠåŠå¾„ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ¸å˜åŒºåŸŸï¼Œå‘å‘¨å›´çš„é¢œè‰²è¿‡æ¸¡ã€‚\næ¸å˜åŠå¾„å¿…é¡»å¤§äº0ã€‚\nspread-radius\næ‰©æ•£åŠå¾„æ˜¯å¯¹åŸæ¥çš„çº¯è‰²é˜´å½±çš„ç¼©æ”¾ã€‚\né»˜è®¤å–å€¼ä¸º0ï¼Œä»£è¡¨é˜´å½±å’Œç‰©ä½“ä¸€æ ·å¤§ï¼Œä½†å› ä¸ºé˜´å½±åœ¨ç‰©ä½“åé¢ï¼Œæ‰€ä»¥ä½ çœ‹ä¸è§ã€‚å½“ç„¶åŠ ä¸Šä¸€å±‚æ¨¡ç³ŠåŠå¾„ä½ å°±èƒ½çœ‹åˆ°äº†ã€‚\nå°äº0çš„æ—¶å€™ï¼Œé˜´å½±ä¼šç¼©å°ã€‚è¿™ç§æƒ…å†µä¸‹å¾€å¾€ä½ ä¹Ÿçœ‹ä¸åˆ°ï¼Œéœ€è¦è®¾ç½®ä¸€å±‚å¾ˆåšçš„æ¨¡ç³ŠåŠå¾„ï¼Œç„¶åæ…¢æ…¢è°ƒä½æ‰©æ•£åŠå¾„ä½ æ‰èƒ½çœ‹å‡ºåŒºåˆ«ã€‚\nå¤§äº0çš„æ—¶å€™ï¼Œé˜´å½±ä¼šæ‰©å¤§ã€‚\ncolor\né˜´å½±çš„é¢œè‰²ï¼Œè¿™å°±ä¸ç”¨è§£é‡Šäº†ã€‚\nbox-shadow å¾ˆç®€å•ï¼Œä½†æ˜¯å¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œåœ¨é¢å¯¹æ¨¡ç³ŠåŠå¾„å’Œæ‰©æ•£åŠå¾„å¯èƒ½ä¼šæœ‰ç‚¹å›°æƒ‘ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç»“åˆä¾‹å­ï¼Œæ›´åŠ æ·±å…¥æ¢è®¨è¿™ä¸¤è€…çš„åŒºåˆ«ã€‚\nå‡†å¤‡: å®šä¹‰ä¸€ä¸ªçƒ å› ä¸ºæ–¹å½¢çš„ä¸å¤ªé€‚åˆæˆ‘ä»¬çš„è®²è§£ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªåœ†å½¢çš„çƒ:\n1 2 3 4 5 6 7 .ball { height: 100px; width: 100px; border-radius: 50% 50%; margin: 50px; display: inline-block; } å¤–åŠ ä¸€äº›é˜´å½±:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 .b1 { box-shadow: 0px 0px 20px #888; } .b2 { box-shadow: 0px 0px 20px 10px #888; } .b3 { box-shadow: 0px 0px 0px 10px #888; } .b4 { box-shadow: 0px 0px 20px -10px #888; } .b5 { box-shadow: inset 0px 0px 20px #888; } .b6 { box-shadow: inset 0px 0px 20px 10px #888; } .b7 { box-shadow: inset 0px 0px 0px 10px #888; } .b8 { box-shadow: inset 0px 0px 20px -10px #888; } åªæœ‰æ¨¡ç³ŠåŠå¾„ æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªæ²¡æœ‰æ‰©æ•£åŠå¾„çš„çƒ:\n1 2 \u0026lt;!-- box-shadow: 0px 0px 20px #888 --\u0026gt; \u0026lt;div class=\u0026#34;ball b1\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; å¯ä»¥çœ‹åˆ°ï¼Œçƒçš„å‘¨å›´æœ‰ä¸€åœˆé˜´å½±ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰è®¾ç½®æ‰©æ•£åŠå¾„ï¼Œæ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°çš„è¿™å±‚é˜´å½±åº”è¯¥æ˜¯å…¨éƒ¨çš„æ¨¡ç³ŠåŠå¾„ã€‚\næˆ‘ä»¬è¿˜å¯ä»¥å°è¯•ä½¿ç”¨ä¸€ä¸‹å†…é˜´å½±:\n1 2 \u0026lt;!-- box-shadow: inset 0px 0px 20px #888 --\u0026gt; \u0026lt;div class=\u0026#34;ball b5\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; æ¨¡ç³ŠåŠå¾„+æ‰©æ•£åŠå¾„(å–æ­£) æ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•ä½¿ç”¨åœ¨åŸæ¥çš„åŸºç¡€ä¸Šæ·»åŠ ä¸€ä¸ªæ‰©æ•£åŠå¾„:\n1 2 3 4 \u0026lt;!-- box-shadow: 0px 0px 20px 10px #888 --\u0026gt; \u0026lt;div class=\u0026#34;ball b2\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;!-- box-shadow: inset 0px 0px 20px 10px #888 --\u0026gt; \u0026lt;div class=\u0026#34;ball b6\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; ç¬¬ä¸€æ„Ÿè§‰åº”è¯¥æ˜¯é˜´å½±å¢åšäº†ï¼Œå†ä»”ç»†çœ‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå¢åšçš„éƒ¨åˆ†çš„é˜´å½±éƒ½å¾ˆæµ“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¢åšçš„éƒ¨åˆ†æ˜¯çº¯è‰²çš„é˜´å½±ï¼Œè€Œä¸æ˜¯ç»è¿‡äº†æ¨¡ç³Šçš„æ¸å˜é˜´å½±ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æ‰©æ•£åŠå¾„ã€‚\nåªæœ‰æ‰©æ•£åŠå¾„ æˆ‘ä»¬å¯ä»¥æŠŠæ¨¡ç³ŠåŠå¾„å»æ‰ï¼Œçœ‹çœ‹å·®åˆ«:\n1 2 3 4 \u0026lt;!-- box-shadow: 0px 0px 0px 10px #888 --\u0026gt; \u0026lt;div class=\u0026#34;ball b3\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;!-- box-shadow: inset 0px 0px 0px 10px #888 --\u0026gt; \u0026lt;div class=\u0026#34;ball b7\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; çœ‹åˆ°äº†å—ï¼Ÿé˜´å½±æ˜¯çº¯è‰²çš„ï¼Œæ²¡æœ‰æ¸å˜ã€‚\næ€»ç»“ä¸‹æ¥ï¼Œæ¨¡ç³ŠåŠå¾„å°±æ˜¯æ¸å˜é˜´å½±åŠå¾„ï¼Œè€Œæ‰©æ•£åŠå¾„å°±æ˜¯çº¯è‰²é˜´å½±åŠå¾„ã€‚å¹¶ä¸”ï¼Œæ¸å˜é˜´å½±åŒ…åœ¨æ‰©æ•£é˜´å½±å¤–é¢ã€‚\næ¨¡ç³ŠåŠå¾„+æ‰©æ•£åŠå¾„(å–è´Ÿ) æœ€åå†çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæ˜¯æ‰©æ•£åŠå¾„ä¸ºè´Ÿæ•°çš„æ—¶å€™:\n1 2 3 4 \u0026lt;!-- box-shadow: 0px 0px 20px -10px #888 --\u0026gt; \u0026lt;div class=\u0026#34;ball b4\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;!-- box-shadow: inset 0px 0px 20px -10px #888 --\u0026gt; \u0026lt;div class=\u0026#34;ball b8\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; æ‰©æ•£åŠå¾„ä¸ºè´Ÿæ•°ï¼Œå°±æ˜¯æŠŠé‡Œé¢çš„é‚£å±‚çº¯è‰²çš„åŠå¾„å‡å°‘äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç›®å‰çœ‹åˆ°çš„æ˜¯æ¨¡ç³ŠåŠå¾„çš„ä¸€å°éƒ¨åˆ†ã€‚\nå¤§éƒ¨åˆ†å¡ç‰‡UIçš„è®¾è®¡å°±æ˜¯è¿™ç§ï¼Œä½ ä»¬å¯èƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œä¹Ÿæ˜¯æˆ‘ä¸ªäººè§‰å¾—æœ€å¥½çœ‹çš„é˜´å½±ã€‚\n","date":"2020-06-28T00:32:28+08:00","permalink":"https://nonlinearthink.github.io/p/css-%E9%98%B4%E5%BD%B1-%E5%81%8F%E7%A7%BB%E6%A8%A1%E7%B3%8A%E5%8D%8A%E5%BE%84%E6%89%A9%E6%95%A3%E5%8D%8A%E5%BE%84/","title":"CSS é˜´å½±: åç§»ã€æ¨¡ç³ŠåŠå¾„ã€æ‰©æ•£åŠå¾„"},{"content":"JDBC (Java Database Connectivity) ï¼Œå±äº Java åº”ç”¨ç¼–ç¨‹ä¸­æ¯”è¾ƒåŸºç¡€çš„ä¸€å—ï¼Œè™½ç„¶ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ MyBatisï¼Œä½†æ˜¯äº†è§£ä¸€ä¸‹ JDBC å¯ä»¥å¸®ä½ æ›´å¥½åœ°ç†è§£ Java çš„æ•°æ®åº“ç¼–ç¨‹ã€‚\nè¿æ¥æ•°æ®åº“ é©±åŠ¨åˆå§‹åŒ– åŸºäº Class.forName çš„åˆå§‹åŒ– æƒ³è¦å¼€å§‹ JDBC ç¼–ç¨‹ï¼Œç¬¬ä¸€æ­¥æ˜¯éœ€è¦æŠŠ æ•°æ®åº“é©±åŠ¨ç¨‹åº çš„ä»£ç åŠ è½½è¿›æ¥ã€‚\nå¯ä»¥åˆ©ç”¨ Class.forName å‡½æ•°ï¼Œå®ƒåŸæœ¬çš„åŠŸèƒ½æ˜¯è¿”å›ä¸€ä¸ª ç±»æˆ–è€…æ¥å£çš„ Class å¯¹è±¡ ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºåˆå§‹åŒ–äº†ä¸€ä¸ªç±»ï¼Œä¸€èˆ¬ç”¨å®ƒæ‰§è¡Œè¿™ä¸ªç±»çš„é™æ€ä»£ç æ®µã€‚\n1 2 3 4 5 try { Class.forName(\u0026#34;com.mysql.cj.jdbc.Driver\u0026#34;); } catch (ClassNotFoundException e) { e.printStackTrace(); } è¿™æ ·ï¼Œcom.mysql.jdbc.Driver ç±»ä¸­çš„é™æ€ä»£ç æ®µå°±ä¼šè¢«æ‰§è¡Œï¼Œè¿›è¡Œåˆå§‹åŒ–ã€‚\nä¸è¿‡ï¼Œé©±åŠ¨åˆå§‹åŒ–è¿˜æœ‰å¦å¤–ä¸€ç§å†™æ³•ã€‚\nåŸºäº registerDriver çš„åˆå§‹åŒ– æˆ‘ä»¬çŸ¥é“ Class.forName æ˜¯æ‰§è¡Œç±»çš„é™æ€ä»£ç æ®µï¼Œé‚£æˆ‘ä»¬æŠŠ com.mysql.jdbc.Driver é‡Œé¢çš„é™æ€ä»£ç æ®µç…§ç€æ ·å­æŠ„ä¸€éä¸ä¹Ÿå¯ä»¥å®ç°åˆå§‹åŒ–å—?\nè¿™æ˜¯ com.mysql.jdbc.Driver é™æ€ä»£ç æ®µçš„æºä»£ç :\n1 2 3 4 5 6 7 static { try { java.sql.DriverManager.registerDriver(new Driver()); } catch (SQLException E) { throw new RuntimeException(\u0026#34;Can\u0026#39;t register driver!\u0026#34;); } } è¿™æ®µä»£ç å¯ä»¥å®Œå…¨ä»£æ›¿ä¸Šä¸€å°èŠ‚çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸º DriverManager.registerDriver(new Driver()) å’Œ Class.forName çš„å†™æ³•æ˜¯ç­‰æ•ˆçš„ã€‚\nä»€ä¹ˆæ˜¯ æ•°æ®åº“é©±åŠ¨ç¨‹åº ï¼Ÿ\nJDK æä¾›äº†ä¸€ä¸ª JDBC çš„æ¥å£(Interface)ã€‚ä½†æ˜¯ï¼Œå› ä¸ºæ˜¯æ¥å£ï¼Œæ‰€ä»¥è¿˜æ˜¯æ²¡æœ‰å®ç°çš„ï¼Œæ¯ä¸ªæ•°æ®åº“çš„å‚å•†éœ€è¦è‡ªå·±å®ç°è¿™ä¸ªæ¥å£ï¼Œè¿™æ ·ç”¨æˆ·æ‰èƒ½æ­£å¸¸è°ƒç”¨ã€‚\nä»¥ mysql ä¸ºä¾‹ï¼Œä¸‹è½½åœ°å€: dev.mysql.com/downloads/connector/j\næ¥å£å˜åŠ¨\nmysql5 å’Œ mysql6 çš„é©±åŠ¨ç¨‹åºæ¥å£æœ‰åŒºåˆ«ï¼Œä» com.mysql.jdbc.Driver æ¢æˆäº† com.mysql.cj.jdbc.Driverï¼Œå†å¾€ä¸Šçš„ç‰ˆæœ¬åŒ mysql6 ã€‚\nå»ºç«‹è¿æ¥ æ•°æ®åº“æ‰“å¼€åä¼šåœ¨æœ¬åœ°å¼€ä¸€ä¸ªç«¯å£ï¼Œè¿è¡Œè¿›ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªç«¯å£çš„ URL æ¥è®¿é—®æ•°æ®åº“ã€‚\nå½“ç„¶ï¼Œè¿˜éœ€è¦æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç ã€‚\n1 java.sql.DriverManager.getConnection(url, user, password); JDBC çš„ URL æ ¼å¼: jdbc:[æ•°æ®åº“è¿æ¥å]://localhost:[ç«¯å£å·]/[æ•°æ®åº“å]\næ•°æ®åº“è¿æ¥å mysqlã€sqlserver ç«¯å£å· 3306(mysql)ã€1433(sqlserver) æ•°æ®åº“å ä¸šåŠ¡ç›¸å…³çš„æ•°æ®åº“åï¼Œè‡ªå®šä¹‰ ä¸€ä¸ª JDBC è¿æ¥æ•°æ®åº“çš„ä¾‹å­:\n1 2 3 4 5 6 try { java.sql.Connection conn = java.sql.DriverManager.getConnection(\u0026#34;jdbc:mysql://localhost:3306/booklib\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;123456\u0026#34;); } catch (SQLException e) { e.printStackTrace(); } JDBC åŸºç¡€ Statement Statement å¯ä»¥æ ¹æ®ç»™å‡ºçš„ä¸€æ¡ SQL å­—ç¬¦ä¸²ï¼Œç„¶åè°ƒç”¨è¿è¡Œã€‚\nå€Ÿç”¨ä¸Šä¸€èŠ‚è¿æ¥å¾—åˆ°çš„ conn å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ª createStatement å‡½æ•°ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª Statementã€‚\n1 2 3 4 5 6 7 try { java.sql.Connection conn = java.sql.DriverManager.getConnection(\u0026#34;jdbc:mysql://localhost:3306/booklib\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;123456\u0026#34;); java.sql.Statement st = conn.createStatement(); } catch (SQLException e) { e.printStackTrace(); } executeã€executeQueryã€executeUpdate åˆ›å»ºå®Œ Statementï¼Œå°±è¦æŠŠ SQL è¯­å¥äº¤ç»™ Statement å¯¹è±¡å»æ‰§è¡Œäº†ã€‚\nexecuteQuery ä¸€èˆ¬å¦‚æœæ˜¯è¿è¡Œ æŸ¥è¯¢(select) è¯­å¥ï¼Œæ¨èä½¿ç”¨ ç¬¬ä¸€èŠ‚ä¸­è·å¾—çš„conn å¯¹è±¡çš„ executeQuery å‡½æ•°ï¼ŒexecuteQueryåªèƒ½è¿”å›å•ä¸ªç»“æœé›†ï¼Œä½†æ˜¯åº”å¯¹å¤§éƒ¨åˆ†çš„æŸ¥è¯¢å·²ç»è¶³å¤Ÿã€‚\næ·»åŠ ä¸‹é¢çš„ä»£ç åˆ°ä¸Šé¢çš„ try ä»£ç å—ä¸­ã€‚\n1 2 String sql = \u0026#34;select * from BeanBook\u0026#34;; st.executeQuery(sql); executeUpdate å¦‚æœä½ éœ€è¦è¿è¡Œ insertã€updateã€delete ç­‰ç­‰è¯­å¥ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ executeUpdate å‡½æ•°ï¼Œå®ƒä¸ä¼šè¿”å›ç»“æœé›†ï¼Œä½†æ˜¯ä¼šè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨å—åˆ°å½±å“çš„è¡Œæ•°ï¼Œå¦‚æœæ˜¯ 0ï¼Œä»£è¡¨äº†ä½ æ²¡æœ‰æ”¹å˜ä»»ä½•æ•°æ®åº“çš„å†…å®¹ï¼Œå³è°ƒç”¨å¤±è´¥äº†ã€‚\nä½¿ç”¨ executeUpdate :\n1 2 String sql = \u0026#34;delete from BeanBook where price\u0026gt;50\u0026#34;; st.executeUpdate(sql); execute execute æ˜¯æ›´åŠ é€šç”¨å’Œå¼ºå¤§çš„å‡½æ•°ï¼Œä½†æ˜¯å®ƒä¹Ÿæ¯”è¾ƒå¤æ‚ã€‚å®ƒçš„è¿”å›å€¼ç±»å‹æœ‰å¾ˆå¤šã€‚\nexecute ä¸ä»…å¯ä»¥åšåˆ° executeQuery èƒ½åšçš„äº‹ï¼Œä¹Ÿèƒ½åšåˆ° executeUpdate èƒ½åšåˆ°çš„äº‹æƒ…ã€‚è€Œä¸”ï¼Œå®ƒè¿˜èƒ½è¿”å›å¤šä¸ªç»“æœé›†ã€‚\næ­£å› ä¸ºå¦‚æ­¤ï¼Œå®ƒä¸€èˆ¬è¢«ç”¨åœ¨ä¸€äº›æ‰§è¡ŒæœªçŸ¥ SQL å­—ç¬¦ä¸²çš„æƒ…å†µä¸‹ï¼Œå¦‚æœ SQL è¯­å¥èƒ½å¤Ÿç¡®å®šï¼Œè¯·å°½å¯èƒ½ä¸ç”¨ executeã€‚\nå®ƒçš„è¿”å›å€¼æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ getResultSet å’Œ getUpdateCount è·å–ï¼Œè€Œä¸æ˜¯ç›´æ¥æŠŠ st.execute(sql); çš„ç»“æœæ‹¿æ¥ã€‚\nä»¥ä¸‹ä¸¤æ®µä»£ç å’Œä¸Šé¢ä¸¤å°èŠ‚çš„ demo çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚\n1 2 3 4 5 6 7 8 9 //ä»£ç æ®µ1 String sql = \u0026#34;select * from BeanBook\u0026#34;; st.execute(sql); st.getResultSet(); //ä»£ç æ®µ2 String sql = \u0026#34;delete from BeanBook where price\u0026gt;50\u0026#34;; st.execute(sql); st.getUpdateCount(); ResultSet å‰é¢ä¸€ç›´æ²¡æ ResultSetï¼ŒResultSet å°±æ˜¯ executeQuery çš„è¿”å›å€¼ã€‚\nä¸¾ä¸ªä¾‹å­ï¼Œä½¿ç”¨ ResultSet éå† SQL çš„ç»“æœ:\n1 2 3 4 5 String sql = \u0026#34;select * from BeanBook\u0026#34;; java.sql.ResultSet rs = st.executeQuery(sql); while (rs.next()) { System.out.println(rs.getString(1) + \u0026#34;\\t\u0026#34; + rs.getString(2) + \u0026#34;\\t\u0026#34; + rs.getDouble(4)); } ResultSet é€šè¿‡ next å‡½æ•°æ¥éå†ï¼Œnext ä»ä¸€æ¡è®°å½•è·³è½¬åˆ°ä¸‹ä¸€æ¡è®°å½•ã€‚\ngetStringã€getDouble ç­‰ç­‰å‡½æ•°æ¥å—ä¸€ä¸ªæ•°å­— n ä½œä¸ºå‚æ•°ï¼Œè·å¾—å½“å‰è®°å½•çš„ç¬¬ n ä¸ªå±æ€§çš„å€¼ï¼Œå¹¶å¯¹è¿™ä¸ªå€¼è¿›è¡Œè½¬æ¢ã€‚\næ¯”å¦‚ getString(1) è·å–ç¬¬ä¸€ä¸ªå±æ€§ï¼Œè½¬æ¢æˆ String ç±»å‹ï¼›getDouble(4) è·å–ç¬¬å››ä¸ªå±æ€§ï¼Œè½¬æ¢æˆ Double ç±»å‹ã€‚\nä¸‹é¢æ˜¯ä¸€äº› get å‡½æ•° (ä¸å…¨):\nåŸå§‹ç±»å‹ç›¸å…³ getStringã€getBooleanã€getByteã€getShortã€getIntã€getLongã€getFloatã€getDouble æ—¥æœŸç›¸å…³ getDateã€getTimeã€getTimestamp PreparedStatement é€šè¿‡ conn.prepareStatement å¯ä»¥æ¥åˆ›å»ºä¸€ä¸ª PrepareStatement å¯¹è±¡ (conn æ˜¯ä¸€ä¸ª java.sql.Connection)ã€‚\nä½†æ˜¯è¿™ä¸ªå‡½æ•°å¿…é¡»è¦ç»™å‡ºä¸€ä¸ª SQL è¯­å¥ä½œä¸ºå‚æ•°ã€‚\nè¿™é‡Œä¹Ÿå¯ä»¥çœ‹å‡º PrepareStatement ä¸ Statement çš„ä¸€ä¸ªæ¯”è¾ƒå¤§çš„åŒºåˆ«ã€‚Statement å¯ä»¥ä¸€ç›´è¢«å¤ç”¨ï¼Œä½†æ˜¯ PrepareStatement æ¯æ‰§è¡Œä¸€æ¬¡ SQLï¼Œéƒ½è¦åˆ›å»ºæ–°çš„ PrepareStatementã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 //Statement java.sql.Statement st = conn.createStatement(); Int limit = 50; String sql = \u0026#34;delete from BeanBook where price\u0026gt;50\u0026#34;; st.executeUpdate(sql); String sql2 = \u0026#34;select * from BeanBook\u0026#34;; st.executeQuery(sql2); //PrepareStatement String sql = \u0026#34;delete from BeanBook where price\u0026gt;50\u0026#34;; java.sql.PreparedStatement pst = conn.prepareStatement(sql); st.executeUpdate(); String sql2 = \u0026#34;select * from BeanBook\u0026#34;; java.sql.PreparedStatement pst2 = conn.prepareStatement(sql2); st.executeQuery(); PreparedStatement å’Œ Statement ä¸€æ ·æ˜¯ç”¨æ¥æ‰§è¡Œ SQL è¯­å¥çš„ï¼Œä½†æ˜¯ Statement æœ‰å¾ˆå¤šé—®é¢˜ã€‚\nå­—ç¬¦ä¸²æ‹¼æ¥é—®é¢˜ å‡å¦‚æˆ‘ä»¬å¸Œæœ›å¯ä»¥åŠ¨æ€åœ°è®¾ç½® SQL è¯­å¥ï¼Œæ¯”å¦‚ï¼ŒåŠ¨æ€æ”¹å˜ where ä»å¥çš„æ¡ä»¶ï¼Œåœ¨ Statement ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·å†™:\n1 2 3 4 java.sql.Statement st = conn.createStatement(); Int limit = 50; String sql = \u0026#34;delete from BeanBook where price\u0026gt;\u0026#34;+limit; st.executeUpdate(sql); PrepareStatement å…è®¸ä¸€ç§å¯è¯»æ€§éå¸¸å¥½çš„å‚æ•°è®¾ç½®è¯­æ³•:\n1 2 3 4 String sql = \u0026#34;delete from BeanBook where price\u0026gt;?\u0026#34;; java.sql.PreparedStatement pst = conn.prepareStatement(sql); pst.setInt(1, 50); st.executeUpdate(sql); è¿™ä¸ª ? è¯­æ³•å¯ä¸æ­¢å¯è¯»æ€§å¥½ï¼Œè¿˜æœ‰ä¸€ä¸ªæ›´é‡è¦çš„æ˜¯ï¼Œå®ƒæ”¯æŒäº† é¢„ç¼–è¯‘ï¼Œè¿™åœ¨æˆ‘ä»¬æ¥ä¸‹æ¥æåˆ°çš„æ€§èƒ½é—®é¢˜ä¸­ä¼šè¢«å…·ä½“è®¨è®ºã€‚\nè¿˜éœ€è¦æä¸€ä¸‹çš„æ˜¯ setInt ç­‰ç­‰çš„ set ç›¸å…³çš„å‡½æ•°ï¼Œå‰é¢å·²ç»æè¿‡ get å‡½æ•°äº†ï¼ŒåŸºæœ¬ä¸ŠæŠŠ get æ”¹æˆ set å°±è¡Œäº†ã€‚\næ€§èƒ½é—®é¢˜ Statement çš„æƒ³æ³•æ˜¯å¯¹è±¡åªéœ€è¦åˆ›å»ºä¸€æ¬¡ï¼Œåç»­åªè¦ä¼ å…¥ä¸åŒçš„ SQL å°±è¡Œäº†ã€‚ä½†æ˜¯åœ¨é¢å¯¹é‡å¤éƒ½æ¯”è¾ƒé«˜çš„å·¥ä½œçš„æ—¶å€™ï¼Œè¿™å¯èƒ½å¹¶ä¸æ˜¯å¾ˆå¥½ã€‚\næ¯”å¦‚ï¼Œæˆ‘æ‰§è¡Œäº†ä¸€æ¬¡ insert into Beanbook(barcode, bookname, pubid, price, state) values(1, 'Java', 3, 56, 'åœ¨åº“')ï¼Œ\nç°åœ¨æˆ‘ç¨å¾®å˜ä¸€ä¸‹ï¼Œè¦æ’å…¥ insert into Beanbook(barcode, bookname, pubid, price, state) values(2, 'C++', 2, 34, 'åœ¨åº“')ã€‚\nè¿™ä¸¤æ¡å‘½ä»¤å‡ ä¹ä¸€æ ·ï¼Œä½†æ˜¯æˆ‘å´è¦ç¼–è¯‘ä¸¤æ¬¡!!!\næˆ‘ä»¬æ¥çœ‹çœ‹ PrepareStaementï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨ ? è¯­æ³•ï¼Œåˆ›å»ºä¸€æ¬¡æ¨¡ç‰ˆï¼Œå› ä¸ºå­˜åœ¨é¢„ç¼–è¯‘æœºåˆ¶ï¼Œå½“æˆ‘ä»¬ç¬¬äºŒæ¬¡æ’å…¥çš„æ—¶å€™èŠ‚çœäº†ä¸€æ¬¡ç¼–è¯‘çš„å¼€é”€ã€‚\nä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å¯ä»¥ä½¿ç”¨ ? è¯­æ³•æ›¿æ¢çš„ä¸€ç³»åˆ— SQL æ“ä½œä¸­ï¼Œä½¿ç”¨ PrepareStatement å°†ä¼šèŠ‚çœä¸€å¤§ç¬”å¼€é”€ã€‚\nSQL æ³¨å…¥å¼æ”»å‡» SQL æ³¨å…¥å¼æ”»å‡»å…¶å®å¾ˆç®€å•ï¼Œè¿™æ˜¯å®Œå…¨å¯ä»¥é¿å…çš„ï¼Œä½†æ˜¯ä½¿ç”¨ Statement çš„æ—¶å€™ä½ è¦æ ¼å¤–å°å¿ƒã€‚\nå‡è®¾ä¸æ€€å¥½æ„çš„ç”¨æˆ·å¯¹ä½ çš„æ•°æ®åº“è¯·æ±‚åˆ é™¤ä¸€äº›åˆæ³•çš„ä¸œè¥¿ï¼Œæ¯”å¦‚åˆ é™¤ bookname ç­‰äº 'Java' çš„ä¹¦ï¼Œä½†æ˜¯ä»–ä¼ ç»™ä½ çš„å­—ç¬¦ä¸²åšäº†ä¸€äº›æ‰‹è„š:\n1 2 3 4 5 //ç”¨æˆ·çš„æ•°æ® String name=\u0026#34;\u0026#39;Java\u0026#39; OR price\u0026gt;0\u0026#34;; //ä½ çš„ä»£ç  String sql = \u0026#34;delete from BeanBook where bookname=\u0026#34;+name; å¥½äº†ï¼Œä½ å®Œäº†ï¼Œå› ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥çš„æ—¶å€™ï¼Œåé¢çš„ OR price\u0026gt;0 æ²¡æœ‰è¢«å½“ä½œæ˜¯ bookname çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯è¢«å½“æˆæ˜¯ SQL å‘½ä»¤çš„ä¸€éƒ¨åˆ†!!! åœ¨è¿™é‡Œï¼Œä½ çš„æ•°æ®åº“å·²ç»è¢«æ¸…ç©ºäº†ã€‚\nä½†æ˜¯ä½¿ç”¨ ? è¯­æ³•ä½ å®Œå…¨ä¸ç”¨æ‹…å¿ƒï¼Œå› ä¸º PrepareStatement æ˜¯é¢„ç¼–è¯‘çš„ï¼Œåé¢åªä¼šæ’å…¥æ•°æ®ï¼Œæ’å…¥çš„å†…å®¹ä¸ä¼šè¢«å½“ä½œæ˜¯ SQL å‘½ä»¤ã€‚\nclose åœ¨æ•°æ®åº“çš„æœ€åä¸èƒ½å¿˜è®°ï¼Œå…³é—­è¿æ¥ã€‚\nåœ¨åŸå…ˆä»£ç çš„åŸºç¡€ä¸Šï¼Œåœ¨æœ€åçš„ finally è¯­å¥å—ä¸­åŠ å…¥ close() å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public static void main(String[] args) throws SQLException { java.sql.Connection conn = java.sql.DriverManager.getConnection(\u0026#34;jdbc:mysql://localhost:3306/booklib\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;123456\u0026#34;); try { conn.setAutoCommit(false); String sql = \u0026#34;select * from BeanBook\u0026#34;; java.sql.PreparedStatement pst = conn.prepareStatement(sql); pst.executeQuery(); } catch (SQLException e) { e.printStackTrace(); } finally { if (conn != null) try { conn.close(); } catch (SQLException e) { e.printStackTrace(); } } } JDBCæ—¶é—´ç±»å‹çš„å¤„ç† ä»ä¹‹å‰çš„ get å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æ—¥æœŸç›¸å…³çš„ APIã€‚\nJDBC ä¸­ä¸€å…±æœ‰ä¸‰ç§æ—¶é—´ç±»å‹:\nDate Time Timestamp System.currentTimeMillis() è¿™ä¸ªå‡½æ•°å¯ä»¥è·å¾— ç³»ç»Ÿå½“å‰çš„ä¸€ä¸ªæ—¶é—´æˆ³ã€‚\næ—¶é—´æˆ³æ˜¯ 1970å¹´1æœˆ1æ—¥0ç‚¹0åˆ† åˆ°ç°åœ¨çš„æ¯«ç§’æ•°ã€‚\nè®¾ç½®Timestamp æ•°æ®åº“é‡Œé¢å­˜çš„éƒ½æ˜¯ Timestampï¼Œä¸€èˆ¬å»ºè®®å­˜å–éƒ½ç”¨ Timestampã€‚\nè®¾ç½®å½“å‰çš„æ—¶é—´ä¸º Timestamp:\n1 pst.setTimestamp(5, new java.sql.Timestamp(System.currentTimeMillis())); é€šè¿‡ Dateç±» æ¥åˆ›å»º Timestamp:\n1 2 java.utl.Date date = new java.util.Date(); pst.setTimestamp(5, new java.sql.Timestamp(date.getTime())); äº‹å®ä¸Šï¼Œä¸€èˆ¬è¿™é‡Œç›´æ¥ç”¨å­—ç¬¦ä¸²ä¹Ÿèƒ½è®¾ç½®ï¼Œä½†å¯¹äºæ•°æ®åº“å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œä¸€èˆ¬ä¸å»ºè®®è¿™æ ·åš:\n1 pst.setString(5, \u0026#34;2020-06-27 00:00:00\u0026#34;); å–å‡ºTimestamp å› ä¸ºä»æ•°æ®åº“ç›´æ¥å–å‡ºçš„æ˜¯ Timestampï¼Œéœ€è¦ä½¿ç”¨ SimpleDateFormat æ¥æ ¼å¼åŒ–ï¼Œæ‰èƒ½æ‰“å°å‡ºæˆ‘ä»¬å¯ä»¥è¯†åˆ«çš„æ—¶é—´å­—ç¬¦ä¸²ã€‚\n1 2 3 Timestamp timestamp = rs.getTimestamp(5); SimpleDateFormat sdf = new SimpleDateFormat(\u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;); System.out.println(sdf.format(timestamp)); äº‹åŠ¡æ§åˆ¶ ä¸ºä»€ä¹ˆéœ€è¦äº‹åŠ¡ ä¸€ä¸ªäº‹åŠ¡æ˜¯ä¸€ç³»åˆ—ç”¨æˆ·å®šä¹‰çš„æ•°æ®åº“æ“ä½œåºåˆ—(CRUD)ã€‚å®ƒçš„ç›®çš„æ˜¯æŠŠæ•°æ®åº“çš„å¤šä¸ªæ“ä½œåˆå¹¶æŠ½è±¡æˆä¸€ä¸ªæ“ä½œã€‚\näº‹åŠ¡çš„è®¾è®¡å“²å­¦: è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ã€‚è¿™å°±æ˜¯äº‹åŠ¡çš„åŸå­æ€§ã€‚\näº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„äº‹åŠ¡ä¹‹é—´ä¸äº’ç›¸å¹²æ‰°ã€‚\nå¦‚ä½•å®ç° äº‹åŠ¡çš„å®ç°é çš„æ˜¯å›æ»šæœºåˆ¶ã€‚\nå½“ä½ åšå®Œä¸€ä¸ªæ“ä½œçš„æ—¶å€™ï¼Œéƒ½æœ‰æ—¥å¿—æ–‡ä»¶è®°å½•ä¸‹ä½ ä¿®æ”¹çš„æ•°æ®ã€‚å¦‚æœä½ æ¥ä¸‹æ¥çš„æ“ä½œå‡ºç°äº†é—®é¢˜ï¼Œé‚£ä¹ˆæ•°æ®åº“å°±èƒ½æ ¹æ®æ—¥å¿—æ–‡ä»¶ï¼Œè¿è¡Œé€†æ“ä½œï¼Œå›åˆ°åŸæ¥çš„çŠ¶æ€ã€‚\nJDBCä¸­çš„äº‹åŠ¡ç¼–ç¨‹ å¯ä»¥åœ¨æœ€å¼€å§‹ä½¿ç”¨ setAutoCommit(false) æ¥å…³é—­è‡ªåŠ¨æäº¤ã€‚\næ‰€è°“çš„è‡ªåŠ¨æäº¤å°±æ˜¯ï¼Œmysql çš„ JDBCå®ç° é»˜è®¤æ˜¯ä¸€æ—¦è¿è¡Œäº† execute ç›¸å…³çš„é‚£ä¸‰ä¸ªå‡½æ•°ï¼Œå°±ä¼šè‡ªåŠ¨è¿è¡Œ commit() å‡½æ•°ï¼Œä»¥æ›´æ–°æ•°æ®åº“ã€‚\nç„¶ååœ¨ try è¯­å¥çš„æœ€åä½¿ç”¨ commit() æäº¤ã€‚\næœ€åä¸è¦å¿˜è®°ï¼Œå¼‚å¸¸å¤„ç†ï¼Œå¦‚æœå‘ç”Ÿäº†å¼‚å¸¸ï¼Œå°±è¦ä½¿ç”¨ rollback() å‡½æ•°å›æ»šï¼Œä½¿å‰é¢çš„æ“ä½œå…¨éƒ¨æ— æ•ˆã€‚\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç»“åˆæ¥å‰é¢æ‰€æœ‰çŸ¥è¯†çš„ä¾‹å­:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 import java.sql.SQLException; public class Test { static { try { Class.forName(\u0026#34;com.mysql.cj.jdbc.Driver\u0026#34;); } catch (ClassNotFoundException e) { e.printStackTrace(); } } public static void main(String[] args) throws SQLException { java.sql.Connection conn = java.sql.DriverManager.getConnection(\u0026#34;jdbc:mysql://localhost:3306/booklib\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;123456\u0026#34;); try { conn.setAutoCommit(false); String sql = \u0026#34;select * from BeanBook\u0026#34;; java.sql.PreparedStatement pst = conn.prepareStatement(sql); java.sql.ResultSet rs = pst.executeQuery(); while (rs.next()) { System.out.println(rs.getString(1) + \u0026#34;\\t\u0026#34; + rs.getString(2) + \u0026#34;\\t\u0026#34; + rs.getDouble(4)); } sql = \u0026#34;delete from BeanBook where price\u0026gt;50\u0026#34;; pst = conn.prepareStatement(sql); conn.commit(); } catch (SQLException e) { e.printStackTrace(); } finally { if (conn != null) try { conn.rollback(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } } } mysql ä¸­çš„å­˜å‚¨å¼•æ“æœ‰: InnoDBã€MyISAMç­‰ç­‰ï¼Œä½†æ˜¯äº‹åŠ¡æ§åˆ¶åªæœ‰ InnoDB æ”¯æŒã€‚\nè¿æ¥æ±  è¿æ¥æ± çš„æ¦‚å¿µ ä¹‹å‰æ¯æ¬¡æˆ‘ä»¬ä½¿ç”¨æ•°æ®åº“ CRUD çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½éœ€è¦æ–°å»ºä¸€ä¸ªè¿æ¥ Connectionã€‚\nåˆ›å»ºè¿æ¥å’Œå…³é—­è¿æ¥çš„è¿‡ç¨‹ä¹Ÿæ˜¯æ¯”è¾ƒæ¶ˆè€—æ—¶é—´çš„ï¼Œå½“çº¿ç¨‹æ•°é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œç³»ç»Ÿå°±ä¼šå˜å¾—å¡é¡¿ã€‚\nè¿æ¥æ± å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿æ¥æ± çš„è®¾è®¡å“²å­¦æ˜¯: æ€»æ˜¯å€Ÿï¼Œè€Œä¸åˆ›å»ºã€‚\næˆ‘ä»¬åœ¨ä¸€å¼€å§‹å…ˆåˆ›å»ºä¸€å®šæ•°é‡çš„è¿æ¥ Connectionï¼Œç„¶åæ¯æ¬¡æœ‰è¯·æ±‚è¿æ¥çš„æ—¶å€™ï¼Œå°±æ‰¾ç©ºé—²çš„è¿æ¥åˆ†é…è¿‡å»ã€‚å¦‚æœæ²¡æœ‰ç©ºé—²ï¼Œåˆ™éœ€è¦ç­‰å¾…ã€‚\nå®ç°è¿æ¥æ±  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 import java.sql.Connection; import java.sql.DriverManager; import java.sql.SQLException; import java.util.ArrayList; import java.util.List; public class ConnectionPool { int size; List\u0026lt;Connection\u0026gt; conns = new ArrayList\u0026lt;Connection\u0026gt;(); public ConnectionPool(int size) { //æ„é€ å™¨ this.size = size; init(); } public void init() { //åˆå§‹åŒ–è¿æ¥æ±  try { // Class.forName(\u0026#34;com.mysql.jdbc.Driver\u0026#34;); //mysql5 Class.forName(\u0026#34;com.mysql.cj.jdbc.Driver\u0026#34;); // mysql6+ for (int i = 0; i \u0026lt; size; i++) { Connection conn = DriverManager .getConnection(\u0026#34;jdbc:mysql://127.0.0.1:3306/booklib\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;123456\u0026#34;); conns.add(conn); } } catch (ClassNotFoundException e) { e.printStackTrace(); } catch (SQLException e) { e.printStackTrace(); } } public synchronized Connection getConnection() { //è·å¾—ä¸€ä¸ªè¿æ¥ while (conns.isEmpty()) { try { this.wait(); } catch (InterruptedException e) { e.printStackTrace(); } } Connection conn = conns.remove(0); return conn; } public synchronized void returnConnection(Connection conn) { //è¿”è¿˜ä¸€ä¸ªè¿æ¥ conns.add(conn); this.notifyAll(); } } ä½¿ç”¨å¼€æºè¿æ¥æ± (ä»¥ C3P0 ä¸ºä¾‹) ä¸€äº›è‘—åçš„å¼€æºè¿æ¥æ± \nDBCP C3P0 C3P0è¿æ¥æ±  çš„ä½¿ç”¨:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 import java.beans.PropertyVetoException; import java.sql.Connection; import java.sql.SQLException; import com.mchange.v2.c3p0.ComboPooledDataSource; public class ConnectionPoo { private static final String url=\u0026#34;jdbc:mysql://localhost:3306/booklib\u0026#34;; private static final String user=\u0026#34;root\u0026#34;; private static final String password=\u0026#34;123456\u0026#34;; private static ComboPooledDataSource dataSource; static{ try { dataSource = new ComboPooledDataSource(); dataSource.setUser(user); dataSource.setPassword(password); dataSource.setJdbcUrl(url); //dataSource.setDriverClass(\u0026#34;com.mysql.jdbc.Driver\u0026#34;); dataSource.setDriverClass(\u0026#34;com.mysql.cj.jdbc.Driver\u0026#34;); dataSource.setInitialPoolSize(5); dataSource.setMinPoolSize(1); dataSource.setMaxPoolSize(10); dataSource.setMaxStatements(50); dataSource.setMaxIdleTime(60); } catch (PropertyVetoException e) { throw new RuntimeException(e); } } public static Connection getConnection() throws SQLException{ return dataSource.getConnection(); } } c3p0 v0.9.2ç‰ˆæœ¬ ä¹‹åï¼Œä»ä¸­åˆ†ç¦»äº†ä¸€ä¸ª mchange-commons-java åŒ…ï¼Œä½œä¸ºä½¿ç”¨ c3p0 çš„è¾…åŠ©åŒ…ã€‚æˆ‘ä»¬è¿™é‡Œè°ƒç”¨çš„å°±æ˜¯è¾…åŠ©åŒ…ã€‚\nORæ˜ å°„ JavaBean ä¸€ä¸ª JavaBean å¯¹è±¡éœ€è¦æ»¡è¶³çš„æ¡ä»¶:\næä¾›ä¸€ä¸ªé»˜è®¤çš„æ— å‚æ„é€ å‡½æ•°ã€‚ éœ€è¦è¢«åºåˆ—åŒ–å¹¶ä¸”å®ç° Serializable æ¥å£ã€‚ ä¸€ç³»åˆ—å¯è¯»å†™å±æ€§ã€‚ ä¸€ç³»åˆ—çš„ getter æˆ– setter æ–¹æ³•ã€‚ æ‰€æœ‰å¯¹ JavaBean å±æ€§çš„è®¿é—®éƒ½åº”å½“ä½¿ç”¨ getter å’Œ setter æ–¹æ³•ã€‚\nJavaBean æ˜¯ä¸€ä¸ªå¯å¤ç”¨çš„ç»„ä»¶ï¼ŒæŠŠåº”ç”¨çš„ä¸šåŠ¡é€»è¾‘å’Œæ˜¾ç¤ºé€»è¾‘åˆ†ç¦»å¼€ï¼Œé™ä½äº†å¼€å‘çš„å¤æ‚ç¨‹åº¦å’Œç»´æŠ¤æˆæœ¬ã€‚\nPOJO (Plain Ordinary Java Object) POJO æ˜¯çº¯ç²¹çš„ JavaBeanã€‚\nJavaBeané™¤äº†æ»¡è¶³ä¸Šé¢çš„æ¡ä»¶ï¼Œæ²¡æœ‰è§„å®šä½ ä¸èƒ½å®šä¹‰å…¶ä»–ä¸œè¥¿ï¼Œå°±ç®—ä½ æŠŠä¸€äº›ä¸šåŠ¡çš„ä»£ç åŠ å…¥è¿›æ¥ä¹Ÿæ²¡å…³ç³»ã€‚\nPOJO ä¸å…è®¸æœ‰ä¸šåŠ¡æ–¹æ³•ï¼Œä¹Ÿä¸èƒ½æºå¸¦ Connection ä¹‹ç±»çš„æ–¹æ³•ã€‚\nä¸€ä¸ªç®€å•çš„ POJO å¯¹è±¡:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 public class BeanPublisher { private String pubid; private String publisherName; private String address; public String getPubid() { return pubid; } public void setPubid(String pubid) { this.pubid = pubid; } public String getPublisherName() { return publisherName; } public void setPublisherName(String publisherName) { this.publisherName = publisherName; } public String getAddress() { return address; } public void setAddress(String address) { this.address = address; } } EntityBean ä¸ ORæ˜ å°„ ORæ˜ å°„ æ˜¯æŠŠæ•°æ®åº“å¯¹è±¡å’Œç¼–ç¨‹è¯­è¨€ä¸­çš„å¯¹è±¡æ˜ å°„åœ¨ä¸€èµ·ï¼Œä»–ä»¬æ‹¥æœ‰ä¸€æ ·çš„å±æ€§ã€‚\nEntityBean ä¸€èˆ¬ç”¨äºORMå¯¹è±¡å…³ç³»æ˜ å°„ï¼Œä¸€ä¸ªå®ä½“æ˜ å°„æˆä¸€å¼ è¡¨ã€‚\nå®ƒèƒ½æ‰§è¡Œå¾ˆå¤šè‡ªåŠ¨åŒ–æ“ä½œ:\nåˆ›å»ºä¸€ä¸ª EntityBean å¯¹è±¡ç›¸å½“äºåˆ›å»ºä¸€æ¡è®°å½• åˆ é™¤ä¸€ä¸ª EntityBean å¯¹è±¡ä¼šåŒæ—¶ä»æ•°æ®åº“ä¸­åˆ é™¤å¯¹åº”è®°å½• ä¿®æ”¹ä¸€ä¸ª EntityBean æ—¶ï¼Œå®¹å™¨ä¼šè‡ªåŠ¨å°† EntityBean çš„çŠ¶æ€å’Œæ•°æ®åº“åŒæ­¥ ä¸€äº›æµè¡Œçš„ ORM æ¡†æ¶:\nHibernate MyBatis ","date":"2020-06-28T00:32:28+08:00","permalink":"https://nonlinearthink.github.io/p/jdbc-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/","title":"JDBC æ•°æ®åº“ç¼–ç¨‹"},{"content":"å› ä¸ºå‡ ä¸ªæœˆå‰ä¹°äº†ä¸€å° iPadï¼Œè€Œæˆ‘å‘ç° iPad æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ— æ³•ç¼–ç¨‹ï¼Œæ‰€ä»¥æ‰“ç®—è‡ªå·±æ­å»ºä¸€ä¸ª jupyter notebook çš„è¿œç¨‹æœåŠ¡å™¨ï¼Œäº‘æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘ã€‚\næˆ‘ä½¿ç”¨çš„æ˜¯ Ubuntu 18.04 çš„é•œåƒï¼Œå¯¹äºå…¶ä»– linux æœåŠ¡å™¨ï¼Œå¯èƒ½ä¹Ÿå°±æ˜¯åŒ…ç®¡ç†å™¨ä¸ä¸€æ ·è€Œå·²ã€‚\nè¿œç¨‹è¿æ¥ root è´¦æˆ·ã€‚\næ— è®ºæ˜¯æœ¬åœ°ä½¿ç”¨ SSH è¿˜æ˜¯å»é˜¿é‡Œäº‘çš„ç½‘ç«™éƒ½å¯ï¼Œæ— æ‰€è°“ã€‚\nå®‰è£… pip3ã€‚\n1 apt install python3-pip ç»æµ‹è¯•ï¼Œé˜¿é‡Œäº‘çš„ Ubuntu 18.04 è‡ªå¸¦ python3ï¼Œä½†ä¸å¸¦ pip3ã€‚\nå®‰è£… jupyter å’Œä¸€äº›å…¶ä»–æƒ³è¦ä½¿ç”¨çš„åº“ã€‚\n1 2 3 pip3 install jupyter pip3 install matplotlib pip3 install sklearn åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸“é—¨æ¥æ”¾ç½® jupyter çš„å·¥ä½œç›®å½•ã€‚\n1 2 3 4 5 6 cd /var/local mkdir jupyter cd jupyter mkdir home cd /var/log touch jupyter.log ç”Ÿæˆ jupyter é…ç½®å’Œç”Ÿæˆå¯†ç çš„ SHA å€¼ã€‚\n1 2 3 4 jupyter notebook --generate-config ipython \u0026gt; from notebook.auth import passwd \u0026gt; passwd() æ³¨æ„å¤åˆ¶ä¸‹æ¥ï¼Œå¾…ä¼šè¦ç”¨ã€‚\nä½¿ç”¨ vim ä¿®æ”¹ jupyter_notebook_config.pyã€‚\n1 vim ~/.jupyter/jupyter_notebook_config.py åœ¨æœ€åæ’å…¥ä»¥ä¸‹ä¿¡æ¯ã€‚\n1 2 3 4 5 6 c.NotebookApp.ip = \u0026#39;*\u0026#39; c.NotebookApp.allow_root = True c.NotebookApp.open_browser = False c.NotebookApp.port = 8888 c.NotebookApp.password = u\u0026#39;ä¸Šé¢ç”Ÿæˆçš„shaå€¼\u0026#39; c.ContentsManager.root_dir = \u0026#39;/var/local/jupyter/home\u0026#39; å®‰è£… nbextensions\nåŸç”Ÿ jupyter çš„å¾ˆå¤šä½“éªŒä¸æ˜¯å¾ˆå¥½ï¼Œæ¨èä½¿ç”¨ä¸€ä¸ª jupyter æ’ä»¶æ¥å¼¥è¡¥ã€‚\n1 2 3 pip3 install jupyter_contrib_nbextensions jupyter contrib nbextension install --user --skip-running-check jupyter nbextensions_configurator enable --user å…ˆè¿›å…¥ jupyter é…ç½®ä¸€ä¸‹ï¼Œå‹¾é€‰ Hinterlandï¼Œè¿™ä¸ªæ˜¯è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚è™½ç„¶æ¯”è¾ƒç®€é™‹ï¼Œä½†æ˜¯ä¹Ÿå¾ˆä¸é”™äº†ã€‚\nä½ å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ’ä»¶è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„åŠŸèƒ½ï¼Œå¯ä»¥è‡ªå·±æ¢ç´¢ä¸€ä¸‹ã€‚\nåå°å®ˆæŠ¤è¿›ç¨‹å¼€å¯æœåŠ¡å™¨ã€‚\n1 nohup jupyter notebook \u0026gt; /var/local/jupyter/runtime.log 2\u0026gt;\u0026amp;1 \u0026amp; å¯èƒ½éœ€è¦æƒé™ï¼š\n1 nohup jupyter notebook --allow-root \u0026gt; /var/local/jupyter/runtime.log 2\u0026gt;\u0026amp;1 \u0026amp; ç”±äºé˜¿é‡Œäº‘çš„é™åˆ¶ï¼Œè¿˜éœ€è¦é…ç½®ä¸€ä¸‹å®‰å…¨ç­–ç•¥ã€‚\næ‰“å¼€äº‘æœåŠ¡å™¨çš„å®ä¾‹ç•Œé¢ï¼Œé€‰æ‹© æœ¬å®ä¾‹å®‰å…¨ç»„-é…ç½®è§„åˆ™ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„è¿™ä¸ªç•Œé¢ï¼Œæ·»åŠ ä¸€æ¡è§„åˆ™å°±è¡Œäº†ã€‚\nåœ¨ Safari ä¸­ï¼Œæ‰“å¼€æœåŠ¡å™¨çš„ IP+ç«¯å£å· 8888ã€‚\n","date":"2020-05-10T12:01:48+08:00","permalink":"https://nonlinearthink.github.io/p/%E6%90%AD%E5%BB%BA-jupyter-notebook-%E4%BA%91%E7%AB%AF%E5%B7%A5%E4%BD%9C%E7%AB%99/","title":"æ­å»º Jupyter Notebook äº‘ç«¯å·¥ä½œç«™"},{"content":"ç¯å¢ƒå˜é‡ æ‰“å°ç¯å¢ƒå˜é‡ ç¯å¢ƒå˜é‡å°±æ˜¯ç¨‹åºè¿è¡Œæ—¶çš„ä¸€ç³»åˆ—é™æ€å‚æ•°ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶æ— æ³•ä¿®æ”¹ã€‚\næƒ³è¦æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼š\n1 env æ‰“å°å•ä¸ªç¯å¢ƒå˜é‡ å‡ ä¸ªæ¯”è¾ƒå¸¸è§çš„ç¯å¢ƒå˜é‡ã€‚\nå˜é‡å è¯´æ˜ PATH shellå°†ä¼šå»è¿™é‡Œæœå¯»å‘½ä»¤å’Œç¨‹åº SHELL å½“å‰ä½¿ç”¨çš„shellç±»å‹ HOME å½“å‰ç”¨æˆ·çš„æ ¹ç›®å½• LOGNAME å½“å‰ç”¨æˆ·çš„ç™»å½•å 1 2 3 4 echo $PATH echo $SHELL echo $HOME echo $LOGNAME å®šä¹‰ç¯å¢ƒå˜é‡ è¿™æ˜¯ Go è¯­è¨€çš„ä¸€ä¸ªç¯å¢ƒå˜é‡é…ç½®ã€‚~/.bashrc ä¸­æ·»åŠ ä¸‹é¢å‡ è¡Œã€‚\n1 export GOROOT=/usr/local/Cellar/go/1.13.5/bin ä¿å­˜é€€å‡ºåï¼Œå°±å¯ä»¥ä½¿ç”¨ echo $GOROOT æ‰“å°å‡ºæ¥äº†ã€‚\nåœ¨ä¸€ä¸ªç›®å½•ä¸‹åˆ›å»º .env æ–‡ä»¶ï¼Œå¹¶å†™å…¥ï¼š\n1 GOROOT /usr/local/Cellar/go/1.13.5/bin å¯ä»¥è®©è¿™ä¸ªç¯å¢ƒå˜é‡ä»…å¯¹åœ¨å½“å‰ç›®å½•ä¸‹è¿è¡Œçš„åº”ç”¨ç¨‹åºç”Ÿæ•ˆã€‚\næ›´æ”¹ç¯å¢ƒå˜é‡çš„å€¼ æœ‰ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ç¯å¢ƒå˜é‡ $PATHï¼Œå®ƒæ˜¯ç¯å¢ƒå˜é‡çš„ä¸€ä¸ªè·¯å¾„é›†åˆï¼Œæ—¢ç„¶æ˜¯é›†åˆå°±å¯ä»¥è¢«ä¸æ–­æ·»åŠ ã€‚\n$PATH ä»¥ : åˆ†å‰²ï¼Œä»¥ path/to/first:path/to/second è¿™æ ·çš„å½¢å¼å­˜åœ¨ã€‚\n1 export PATH=$PATH:$GOROOT/bin ä¸Šé¢çš„å‘½ä»¤ç›¸å½“äºæ‰§è¡Œäº†ä¸€ä¸ª += æ“ä½œã€‚ä¹Ÿå°±æ˜¯åœ¨åŸå…ˆçš„ $PATH çš„åŸºç¡€ä¸ŠåŠ ä¸Šäº† $GOROOT/binã€‚\nShell é…ç½®æ–‡ä»¶ å¤šç”¨æˆ·é…ç½® åœ¨ unix-like ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿé…ç½®æ–‡ä»¶éƒ½è¢«æ”¾åœ¨ä¸€ä¸ªå« /etc çš„ç›®å½•ä¸‹ã€‚å…¶ä¸­ä¹ŸåŒ…å«äº† shell é…ç½®æ–‡ä»¶ã€‚\nshell é…ç½®æ–‡ä»¶å¯ä»¥åˆ†ä¸ºä¸¤ç±»: *profile å’Œ *shrcã€‚\n*profile ä¸­çš„å†…å®¹ä¼šåœ¨ç”¨æˆ·ç™»å½•æ—¶è¢«è¿è¡Œã€‚\n*shrc ä¼šåœ¨ shell å¯åŠ¨æ—¶è¢«è¿è¡Œã€‚\nä»ç”Ÿå‘½å‘¨æœŸçš„è§’åº¦è®²ï¼Œå†™åœ¨ *profile ä¸­çš„ç¯å¢ƒå˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ•´ä¸ªç³»ç»Ÿè¿è¡ŒæœŸé—´ï¼Œè€Œ *shrc ä»…ä»…åœ¨ shell è¢«å¯åŠ¨çš„æ—¶å€™æ‰æœ‰æ•ˆã€‚\nç”Ÿå‘½å‘¨æœŸé•¿ä¸ä¸€å®šå¥½ï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›æ“ä½œç³»ç»Ÿåšå¤ªå¤šçš„åˆå§‹åŒ–è€Œå¯¼è‡´å¼€æœºå˜æ…¢ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æˆ‘ä»¬ç”¨æˆ·è‡ªå®šä¹‰çš„ç¯å¢ƒå˜é‡éƒ½æ˜¯åœ¨ *shrc ä¸­ã€‚\nä½†æ˜¯æœ‰äº›è½¯ä»¶ï¼Œéœ€è¦ä»–ä»¬ä¸€å¼€æœºå°±è¿è¡Œï¼Œæ¯”å¦‚è¾“å…¥æ³•ï¼Œå°±éœ€è¦å†™åœ¨ *profile ä¸­ã€‚\n1 2 3 4 5 6 7 cd /etc ls *profile # output: # profile zprofile ls *shrc # output: # bashrc csh.cshrc zshrc å› ä¸ºæˆ‘å®‰è£…äº† zshï¼Œæ‰€ä»¥å¤šäº† zprofile å’Œ zshrcï¼Œæ²¡å®‰è£…è¿‡å…¶ä»–çš„ shellï¼Œåªæœ‰é»˜è®¤çš„ bash çš„è¯ï¼Œåº”è¯¥åªæœ‰ profile å’Œ bashrcã€‚\né™¤æ­¤ä¹‹å¤–ï¼Œå¿˜è®°è¯´äº†ä¸€ç‚¹ï¼Œ/etc æ–‡ä»¶å¤¹ä¸‹çš„é…ç½®æ˜¯é’ˆå¯¹å…¨éƒ¨æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·çš„ï¼Œæ‰€ä»¥è¯·è°¨æ…ä¿®æ”¹ã€‚\nå•ç”¨æˆ·é…ç½® ä¸Šé¢è¯´äº†å¤šç”¨æˆ·çš„ç¯å¢ƒå˜é‡é…ç½®ï¼Œå•ç”¨æˆ·çš„é…ç½®åº”è¯¥ä½¿ç”¨.bashrc å’Œ .bash_profileï¼Œå®ƒä»¬åœ¨ç”¨æˆ·çš„æ ¹ç›®å½•(~)ä¸‹ï¼Œé»˜è®¤æ˜¯ä¸åˆ›å»ºçš„ï¼Œå¦‚æœéœ€è¦åˆ™è‡ªå·±åˆ›å»ºã€‚\n1 2 3 4 5 6 7 cd ~ ls .*profile # output: # .bash_profile ls .*shrc # output: # .zshrc æˆ‘è¿™é‡Œç»™ bash åˆ›å»ºäº† profileï¼Œè€Œç»™ zsh åˆ›å»ºäº† shrcï¼Œå…¶ä»–æ²¡åˆ›å»ºã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ.bash_profile åœ¨é»˜è®¤çŠ¶æ€ä¸‹ï¼Œè¿˜ä¼šæ‰§è¡Œ .bashrcã€‚\nç¯å¢ƒå˜é‡çš„ä¼˜å…ˆçº§ å¦‚æœåœ¨ etc/profile ä¸­å’Œ ~/.bash_profile éƒ½å®šä¹‰äº†ç›¸åŒçš„åå­—çš„ç¯å¢ƒå˜é‡ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\nè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä»é…ç½®æ–‡ä»¶è¢«åŠ è½½çš„é¡ºåºæ¥è€ƒè™‘ã€‚\nä»¥ bash ä¸ºä¾‹ã€‚\næ“ä½œç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™ï¼Œ/etc/profile è¢«è°ƒç”¨ï¼Œç„¶å /etc/profile è°ƒç”¨ /etc/bashrcã€‚ ç”¨æˆ·å¯åŠ¨ shell çš„æ—¶å€™ï¼Œ~/.bash_profile è¢«è°ƒç”¨ï¼Œç„¶å ~/.bash_profile è°ƒç”¨ ~/.bashrcã€‚ æœ€åè¢«è°ƒç”¨çš„ä¼šè¦†ç›–å‰é¢è¢«è°ƒç”¨çš„ã€‚\nè¡¥å…… export å‘½ä»¤ export å‘½ä»¤å°±æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡ã€‚åˆ†ä¸¤ä¸ªåœºæ™¯æ¥çœ‹ï¼š\nåœ¨å‘½ä»¤è¡Œä¸‹\nåœ¨å‘½ä»¤è¡Œä¸‹çš„ export çš„ä½œç”¨åŸŸåªæœ‰åœ¨è¿™æ¬¡ç™»å½•æœŸé—´ã€‚\nä¹Ÿå°±æ˜¯è¯´ shell ä¸€æ—¦é€€å‡ºï¼Œè®¾ç½®çš„ç¯å¢ƒå˜é‡å°±æ¶ˆå¤±äº†ã€‚\nå¦‚æœæƒ³è¦å®ƒä¸€ç›´å­˜åœ¨ï¼Œå°±è¦å†™åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚\nåœ¨é…ç½®æ–‡ä»¶ä¸­\nå¦‚æœä»”ç»†çœ‹è¿‡ä¸Šé¢çš„åˆ†æï¼Œå°±ä¼šçŸ¥é“é…ç½®æ–‡ä»¶æ˜¯åœ¨ shell ç™»å½•æ—¶å€™è‡ªåŠ¨åŠ è½½çš„ã€‚\nè‡ªç„¶å°±ä¸ä¼šæ¶ˆå¤±äº†ã€‚\nsource å‘½ä»¤ é…ç½®æ–‡ä»¶å†™å…¥ä¹‹åï¼Œç¯å¢ƒå˜é‡ä¸ä¼šé©¬ä¸Šæ›´æ–°ã€‚\nsource å‘½ä»¤å¯ä»¥åŠ è½½ä¸€æ¬¡é…ç½®æ–‡ä»¶çš„å†…å®¹ã€‚\næ¯”å¦‚ï¼Œé…ç½®å®Œä¸Šé¢çš„å†…å®¹ï¼Œä½¿ç”¨ sourceï¼š\n1 source .zshrc alias å‘½ä»¤ alias å°±æ˜¯åˆ«åï¼Œä¹Ÿå°±æ˜¯ä¸ºå‘½ä»¤åˆ›å»ºä¸€ä¸ªåˆ«åã€‚\næ¯”å¦‚ï¼Œåœ¨ linux ä¸­ï¼Œpython å¾€å¾€é»˜è®¤æ˜¯ python2ã€‚\nä½¿ç”¨ alias å¯ä»¥è®¾ç½®æˆ python3ã€‚\n1 alias python=python3 alias ä¹Ÿå¯ä»¥å½“æˆ export ç”¨ã€‚\nåŒºåˆ«åœ¨äºï¼Œexport å¯ä»¥ç›´æ¥å¯¼å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢çš„å…¨éƒ¨å¯æ‰§è¡Œæ–‡ä»¶ã€‚\nè€Œ alias åªèƒ½é’ˆå¯¹ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œéœ€è¦ä½ ä¸€ä¸ªä¸€ä¸ªå†™ã€‚\n1 alias mysql=/usr/local/mysql/bin/mysql è¿™æ ·ä¹‹åï¼Œæˆ‘ä»¬æ¯æ¬¡ç”¨ mysql çš„å‘½ä»¤ï¼Œå°±ä¼šè¢«æ›¿æ¢æˆ /usr/local/mysql/bin/mysqlã€‚\nalias ç•¥å¾®ç®€æ´æ˜äº†ä¸€ç‚¹ï¼Œä½†å…¶å®ä¼˜åŠ¿å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œä¸€èˆ¬éƒ½æ¨èç”¨ exportã€‚\n","date":"2019-06-24T02:14:27+08:00","permalink":"https://nonlinearthink.github.io/p/linux-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/","title":"Linux ç¯å¢ƒå˜é‡çš„é‚£äº›äº‹"},{"content":"ä¹‹å‰ä¸€ç›´ç© ubuntuï¼Œä»Šå¤©ä½“éªŒäº†ä¸€æŠŠ manjaro KDEï¼Œç•Œé¢ç›¸å½“èˆ’é€‚ã€‚\nä½†æ˜¯ï¼Œä¸åƒ ubuntu gnome é‚£æ ·è‡ªå¸¦ä¸­æ–‡è¾“å…¥æ³•ï¼Œéœ€è¦è‡ªå·±å®‰è£…è¾“å…¥æ³•ã€‚\nä»¥ ibusè¾“å…¥æ³• ä¸ºä¾‹ï¼Œåˆ†äº«ä¸€ä¸‹å¦‚ä½•å®‰è£…ä¸­æ–‡è¾“å…¥æ³•ã€‚\nå®‰è£…ibus å®‰è£…ibusè½¯ä»¶åŒ… 1 $ sudo pacman -S ibus æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„è¾“å…¥æ³• 1 $ sudo pacman -Ss ^ibus-* é€‰æ‹©ä¸€ä¸ªå¯ç”¨çš„è¾“å…¥æ³•å¼•æ“å¹¶å®‰è£… 1 $ sudo pacman -S ibus-pinyin è¿è¡Œibus 1 $ ibus-setup å‘ç°å‡ºç°æç¤ºï¼š\nåœ¨ $HOME/.bashrc ä¸­åŠ å…¥ä¸‹é¢è¿™æ®µå°±å¥½äº†\n1 2 3 export GTK_IM_MODULE=ibus export XMODIFIERS=@im=ibus export QT_IM_MODULE=ibus æ·»åŠ ä¸­æ–‡è¾“å…¥æ³• ä¸Šä¸€æ­¥æ‰§è¡Œå®Œæˆä¹‹åï¼Œå°±ä¼šå‡ºç°è¿™ä¸ªç•Œé¢ï¼Œåˆ°è¿™é‡Œæ·»åŠ ä¸­æ–‡è¾“å…¥æ³•ã€‚\nå®‰è£…è¿‡ç¨‹ä¸­çš„å…¶ä»–é—®é¢˜ è¿™ä¸ªæ—¶å€™ï¼Œçªç„¶å‘ç°æ¯æ¬¡å¼€æœºéƒ½è¦åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ ibus-setup æ‰èƒ½å¯åŠ¨ibusã€‚\nè¿™æ ·å¾ˆéº»çƒ¦ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒåŸæ¥æˆ‘ä»¬æŠŠ $HOME/.bashrc çš„å†…å®¹ï¼š\n1 2 3 export GTK_IM_MODULE=ibus export XMODIFIERS=@im=ibus export QT_IM_MODULE=ibus è½¬ç§»åˆ° $HOME/.xprofile ä¸­ï¼Œå¹¶ä¸”åœ¨æœ€åä¸€è¡Œæ·»åŠ ä¸€æ¡æ–°çš„å†…å®¹ï¼š\n1 2 3 4 export GTK_IM_MODULE=ibus export XMODIFIERS=@im=ibus export QT_IM_MODULE=ibus ibus-daemon -x -d å†é‡å¯å‘ç°è¾“å…¥æ³•èƒ½å¼€æœºè‡ªåŠ¨å¯åŠ¨äº†ã€‚\n","date":"2019-01-15T14:49:48+08:00","permalink":"https://nonlinearthink.github.io/p/manjaro-kde-%E5%AE%89%E8%A3%85-ibus-%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%B3%95/","title":"Manjaro KDE å®‰è£… ibus ä¸­æ–‡è¾“å…¥æ³•"}]